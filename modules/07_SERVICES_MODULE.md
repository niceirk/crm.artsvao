# –ú–æ–¥—É–ª—å 7: –ù–æ–º–µ–Ω–∫–ª–∞—Ç—É—Ä–∞ —É—Å–ª—É–≥ (Services)

**–°—Ç–∞—Ç—É—Å:** –î–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω, –≥–æ—Ç–æ–≤ –∫ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏
**–í–µ—Ä—Å–∏—è:** 1.0
**–î–∞—Ç–∞:** 2025-01-16

---

## –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ

1. [–û–±–∑–æ—Ä –º–æ–¥—É–ª—è](#–æ–±–∑–æ—Ä-–º–æ–¥—É–ª—è)
2. [–ú–æ–¥–µ–ª—å –¥–∞–Ω–Ω—ã—Ö](#–º–æ–¥–µ–ª—å-–¥–∞–Ω–Ω—ã—Ö)
3. [–ö–∞—Ç–µ–≥–æ—Ä–∏–∏ –∏ —Ç–∏–ø—ã —É—Å–ª—É–≥](#–∫–∞—Ç–µ–≥–æ—Ä–∏–∏-–∏-—Ç–∏–ø—ã-—É—Å–ª—É–≥)
4. [–ù–î–° (–ù–∞–ª–æ–≥ –Ω–∞ –¥–æ–±–∞–≤–ª–µ–Ω–Ω—É—é —Å—Ç–æ–∏–º–æ—Å—Ç—å)](#–Ω–¥—Å-–Ω–∞–ª–æ–≥-–Ω–∞-–¥–æ–±–∞–≤–ª–µ–Ω–Ω—É—é-—Å—Ç–æ–∏–º–æ—Å—Ç—å)
5. [–ú–æ–¥–µ–ª–∏ —Å–ø–∏—Å–∞–Ω–∏—è —É—Å–ª—É–≥](#–º–æ–¥–µ–ª–∏-—Å–ø–∏—Å–∞–Ω–∏—è-—É—Å–ª—É–≥)
6. [–õ—å–≥–æ—Ç—ã –∏ —Å–∫–∏–¥–∫–∏](#–ª—å–≥–æ—Ç—ã-–∏-—Å–∫–∏–¥–∫–∏)
7. [–ö–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–∞ —Ü–µ–Ω](#–∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–∞-—Ü–µ–Ω)
8. [–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –¥—Ä—É–≥–∏–º–∏ –º–æ–¥—É–ª—è–º–∏](#–∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è-—Å-–¥—Ä—É–≥–∏–º–∏-–º–æ–¥—É–ª—è–º–∏)
9. [API —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è](#api-—Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è)
10. [–ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è](#–ø—Ä–∏–º–µ—Ä—ã-–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è)

---

## –û–±–∑–æ—Ä –º–æ–¥—É–ª—è

### –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ

–ú–æ–¥—É–ª—å **–ù–æ–º–µ–Ω–∫–ª–∞—Ç—É—Ä–∞ —É—Å–ª—É–≥** (Services) –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–π —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫ –≤—Å–µ—Ö —É—Å–ª—É–≥, –∫–æ—Ç–æ—Ä—ã–µ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –∫—É–ª—å—Ç—É—Ä–Ω—ã–π —Ü–µ–Ω—Ç—Ä "–ê—Ä—Ç–°–í–ê–û". –ú–æ–¥—É–ª—å –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –µ–¥–∏–Ω–æ–æ–±—Ä–∞–∑–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —É—Å–ª—É–≥–∞–º–∏ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Ç–∏–ø–æ–≤: –æ—Ç –∞–±–æ–Ω–µ–º–µ–Ω—Ç–æ–≤ –Ω–∞ –≥—Ä—É–ø–ø–æ–≤—ã–µ –∑–∞–Ω—è—Ç–∏—è –¥–æ –∞—Ä–µ–Ω–¥—ã –ø–æ–º–µ—â–µ–Ω–∏–π –∏ –∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã—Ö –∑–∞–Ω—è—Ç–∏–π.

### –û—Å–Ω–æ–≤–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏

- **–ï–¥–∏–Ω—ã–π —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫ —É—Å–ª—É–≥** - —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–µ —Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ–±–æ –≤—Å–µ—Ö —É—Å–ª—É–≥–∞—Ö
- **–ì–∏–±–∫–æ–µ —Ü–µ–Ω–æ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ** - –ø–æ–¥–¥–µ—Ä–∂–∫–∞ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Å—Ç–∞–≤–æ–∫ –ù–î–°, –±–∞–∑–æ–≤—ã—Ö —Ü–µ–Ω –∏ —Å–∫–∏–¥–æ–∫
- **–ö–∞—Ç–µ–≥–æ—Ä–∏–∑–∞—Ü–∏—è** - –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ —É—Å–ª—É–≥ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º –¥–ª—è —É–¥–æ–±—Å—Ç–≤–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è
- **–ú–æ–¥–µ–ª–∏ —Å–ø–∏—Å–∞–Ω–∏—è** - –ø–æ–¥–¥–µ—Ä–∂–∫–∞ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –º–æ–¥–µ–ª–µ–π —É—á–µ—Ç–∞ –ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏—è —É—Å–ª—É–≥
- **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å —Ñ–∏–Ω–∞–Ω—Å–∞–º–∏** - –ø—Ä—è–º–∞—è —Å–≤—è–∑—å —Å –º–æ–¥—É–ª–µ–º —Å—á–µ—Ç–æ–≤ –∏ –ø–ª–∞—Ç–µ–∂–µ–π

### –ú–µ—Å—Ç–æ –≤ —Å–∏—Å—Ç–µ–º–µ

–ú–æ–¥—É–ª—å –Ω–æ–º–µ–Ω–∫–ª–∞—Ç—É—Ä—ã —è–≤–ª—è–µ—Ç—Å—è **—Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–º —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–æ–º** –¥–ª—è —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π:

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ   Client    ‚îÇ (–ö–ª–∏–µ–Ω—Ç —Å –ª—å–≥–æ—Ç–Ω–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–µ–π)
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
       ‚îÇ
       ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ   Invoice   ‚îÇ (–°—á–µ—Ç –Ω–∞ –æ–ø–ª–∞—Ç—É)
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
       ‚îÇ
       ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê         ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ InvoiceItem ‚îÇ ‚óÑ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ ‚îÇ   Service    ‚îÇ (–ù–æ–º–µ–Ω–∫–ª–∞—Ç—É—Ä–∞)
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò         ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
       ‚îÇ                       ‚îÇ
       ‚ñº                       ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê         ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  Payment    ‚îÇ         ‚îÇServiceCategory‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò         ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
       ‚îÇ
       ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇSubscription ‚îÇ (–î–ª—è –∞–±–æ–Ω–µ–º–µ–Ω—Ç–æ–≤)
‚îÇ  / Rental   ‚îÇ (–î–ª—è –∞—Ä–µ–Ω–¥—ã)
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

---

## –ú–æ–¥–µ–ª—å –¥–∞–Ω–Ω—ã—Ö

### 1. Service (–£—Å–ª—É–≥–∞)

–¶–µ–Ω—Ç—Ä–∞–ª—å–Ω–∞—è –º–æ–¥–µ–ª—å –º–æ–¥—É–ª—è, –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—é—â–∞—è –µ–¥–∏–Ω–∏—Ü—É –Ω–æ–º–µ–Ω–∫–ª–∞—Ç—É—Ä—ã.

#### Prisma Schema

```prisma
model Service {
  id                String           @id @default(uuid())

  // –û—Å–Ω–æ–≤–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è
  name              String           @db.VarChar(255)
  description       String?          @db.Text
  shortDescription  String?          @db.VarChar(500)

  // –ö–∞—Ç–µ–≥–æ—Ä–∏–∑–∞—Ü–∏—è
  categoryId        String?          @map("category_id")
  serviceType       ServiceType      @map("service_type")

  // –¶–µ–Ω–æ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ
  basePrice         Decimal          @db.Decimal(10, 2)  // –¶–µ–Ω–∞ –±–µ–∑ –ù–î–°
  vatRate           Decimal          @default(20)        // –°—Ç–∞–≤–∫–∞ –ù–î–° (%)
                                     @db.Decimal(5, 2)
  priceWithVat      Decimal          @db.Decimal(10, 2)  // –¶–µ–Ω–∞ —Å –ù–î–°

  // –ï–¥–∏–Ω–∏—Ü–∞ –∏–∑–º–µ—Ä–µ–Ω–∏—è
  unitOfMeasure     String           @default("—à—Ç")      // "–º–µ—Å—è—Ü", "—á–∞—Å", "–∑–∞–Ω—è—Ç–∏–µ", "–¥–µ–Ω—å", "—à—Ç"

  // –ú–æ–¥–µ–ª—å —Å–ø–∏—Å–∞–Ω–∏—è
  writeOffTiming    WriteOffTiming   @default(ON_SALE)   // –ö–æ–≥–¥–∞ —Å–ø–∏—Å—ã–≤–∞—Ç—å —É—Å–ª—É–≥—É
                                     @map("write_off_timing")

  // –î–ª—è —É—Å–ª—É–≥ —Å –ø–æ—à—Ç—É—á–Ω—ã–º —Å–ø–∏—Å–∞–Ω–∏–µ–º (ON_USE)
  defaultQuantity   Int?             @default(1)         // –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é

  // –°–≤—è–∑–∏ —Å –¥—Ä—É–≥–∏–º–∏ —Å—É—â–Ω–æ—Å—Ç—è–º–∏
  groupId           String?          @map("group_id")    // –î–ª—è –∞–±–æ–Ω–µ–º–µ–Ω—Ç–æ–≤ –≥—Ä—É–ø–ø
  roomId            String?          @map("room_id")     // –î–ª—è –∞—Ä–µ–Ω–¥—ã –ø–æ–º–µ—â–µ–Ω–∏–π

  // –°—Ç–∞—Ç—É—Å –∏ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ
  isActive          Boolean          @default(true)      @map("is_active")
  isArchived        Boolean          @default(false)     @map("is_archived")
  sortOrder         Int              @default(0)         @map("sort_order")

  createdAt         DateTime         @default(now())     @map("created_at")
  updatedAt         DateTime         @updatedAt          @map("updated_at")

  // –°–≤—è–∑–∏
  category          ServiceCategory? @relation(fields: [categoryId], references: [id])
  group             Group?           @relation(fields: [groupId], references: [id])
  room              Room?            @relation(fields: [roomId], references: [id])
  invoiceItems      InvoiceItem[]    @relation("ServiceToInvoiceItem")

  @@map("services")
  @@index([categoryId])
  @@index([serviceType])
  @@index([isActive])
  @@index([groupId])
}
```

#### –û–ø–∏—Å–∞–Ω–∏–µ –ø–æ–ª–µ–π

| –ü–æ–ª–µ | –¢–∏–ø | –û–ø–∏—Å–∞–Ω–∏–µ |
|------|-----|----------|
| `id` | UUID | –£–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä —É—Å–ª—É–≥–∏ |
| `name` | String | –ù–∞–∑–≤–∞–Ω–∏–µ —É—Å–ª—É–≥–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, "–ê–±–æ–Ω–µ–º–µ–Ω—Ç —Ç–∞–Ω—Ü—ã (–º–µ—Å—è—Ü)") |
| `description` | String? | –ü–æ–¥—Ä–æ–±–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ —É—Å–ª—É–≥–∏ |
| `shortDescription` | String? | –ö—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –≤ —Å–ø–∏—Å–∫–∞—Ö |
| `categoryId` | UUID? | –°—Å—ã–ª–∫–∞ –Ω–∞ –∫–∞—Ç–µ–≥–æ—Ä–∏—é —É—Å–ª—É–≥–∏ |
| `serviceType` | Enum | –¢–∏–ø —É—Å–ª—É–≥–∏ (SUBSCRIPTION, RENTAL, –∏ —Ç.–¥.) |
| `basePrice` | Decimal | –ë–∞–∑–æ–≤–∞—è —Ü–µ–Ω–∞ –±–µ–∑ –ù–î–° |
| `vatRate` | Decimal | –°—Ç–∞–≤–∫–∞ –ù–î–° –≤ –ø—Ä–æ—Ü–µ–Ω—Ç–∞—Ö (0, 10, 20) |
| `priceWithVat` | Decimal | –ò—Ç–æ–≥–æ–≤–∞—è —Ü–µ–Ω–∞ —Å —É—á–µ—Ç–æ–º –ù–î–° |
| `unitOfMeasure` | String | –ï–¥–∏–Ω–∏—Ü–∞ –∏–∑–º–µ—Ä–µ–Ω–∏—è ("–º–µ—Å—è—Ü", "—á–∞—Å", "–∑–∞–Ω—è—Ç–∏–µ", "–¥–µ–Ω—å") |
| `writeOffTiming` | Enum | –ú–æ–¥–µ–ª—å —Å–ø–∏—Å–∞–Ω–∏—è (ON_SALE –∏–ª–∏ ON_USE) |
| `defaultQuantity` | Int? | –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –µ–¥–∏–Ω–∏—Ü –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é (–¥–ª—è ON_USE) |
| `groupId` | UUID? | –ü—Ä–∏–≤—è–∑–∫–∞ –∫ –≥—Ä—É–ø–ø–µ (–¥–ª—è –∞–±–æ–Ω–µ–º–µ–Ω—Ç–æ–≤) |
| `roomId` | UUID? | –ü—Ä–∏–≤—è–∑–∫–∞ –∫ –ø–æ–º–µ—â–µ–Ω–∏—é (–¥–ª—è –∞—Ä–µ–Ω–¥—ã) |
| `isActive` | Boolean | –ê–∫—Ç–∏–≤–Ω–∞ –ª–∏ —É—Å–ª—É–≥–∞ (–¥–æ—Å—Ç—É–ø–Ω–∞ –¥–ª—è –ø—Ä–æ–¥–∞–∂–∏) |
| `isArchived` | Boolean | –ê—Ä—Ö–∏–≤–Ω–∞—è —É—Å–ª—É–≥–∞ (–Ω–µ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –≤ —Å–ø–∏—Å–∫–∞—Ö) |
| `sortOrder` | Int | –ü–æ—Ä—è–¥–æ–∫ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏ –≤ —Å–ø–∏—Å–∫–∞—Ö |

### 2. ServiceCategory (–ö–∞—Ç–µ–≥–æ—Ä–∏—è —É—Å–ª—É–≥)

–ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ —É—Å–ª—É–≥ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º –¥–ª—è —É–¥–æ–±—Å—Ç–≤–∞ –Ω–∞–≤–∏–≥–∞—Ü–∏–∏ –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è.

#### Prisma Schema

```prisma
model ServiceCategory {
  id          String    @id @default(uuid())

  name        String    @unique @db.VarChar(100)
  description String?   @db.Text
  icon        String?   @db.VarChar(50)        // –ò–∫–æ–Ω–∫–∞ –¥–ª—è UI
  color       String?   @db.VarChar(7)         // HEX —Ü–≤–µ—Ç (#FF5733)

  sortOrder   Int       @default(0) @map("sort_order")
  isActive    Boolean   @default(true) @map("is_active")

  createdAt   DateTime  @default(now()) @map("created_at")
  updatedAt   DateTime  @updatedAt @map("updated_at")

  services    Service[]

  @@map("service_categories")
}
```

#### –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏

| –ù–∞–∑–≤–∞–Ω–∏–µ | –û–ø–∏—Å–∞–Ω–∏–µ | –ò–∫–æ–Ω–∫–∞ |
|----------|----------|--------|
| –ê–±–æ–Ω–µ–º–µ–Ω—Ç—ã | –ê–±–æ–Ω–µ–º–µ–Ω—Ç—ã –Ω–∞ –≥—Ä—É–ø–ø–æ–≤—ã–µ –∑–∞–Ω—è—Ç–∏—è (—Ç–∞–Ω—Ü—ã, —Ç–≤–æ—Ä—á–µ—Å—Ç–≤–æ, —Å–ø–æ—Ä—Ç) | üé´ |
| –ê—Ä–µ–Ω–¥–∞ –ø–æ–º–µ—â–µ–Ω–∏–π | –ü–æ—á–∞—Å–æ–≤–∞—è –∞—Ä–µ–Ω–¥–∞ –∑–∞–ª–æ–≤ –∏ –ø–æ–º–µ—â–µ–Ω–∏–π | üè¢ |
| –†–∞–∑–æ–≤—ã–µ –∑–∞–Ω—è—Ç–∏—è | –†–∞–∑–æ–≤—ã–µ –ø–æ—Å–µ—â–µ–Ω–∏—è –≥—Ä—É–ø–ø–æ–≤—ã—Ö –∑–∞–Ω—è—Ç–∏–π –±–µ–∑ –∞–±–æ–Ω–µ–º–µ–Ω—Ç–∞ | üéØ |
| –ò–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã–µ –∑–∞–Ω—è—Ç–∏—è | –ó–∞–Ω—è—Ç–∏—è —Å –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–º –ø—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª–µ–º | üë§ |
| –ü—Ä–æ—á–∏–µ —É—Å–ª—É–≥–∏ | –î—Ä—É–≥–∏–µ —É—Å–ª—É–≥–∏ —Ü–µ–Ω—Ç—Ä–∞ | üì¶ |

### 3. Enum: ServiceType

–¢–∏–ø—ã —É—Å–ª—É–≥ –≤ —Å–∏—Å—Ç–µ–º–µ.

```prisma
enum ServiceType {
  SUBSCRIPTION       // –ê–±–æ–Ω–µ–º–µ–Ω—Ç –Ω–∞ –≥—Ä—É–ø–ø–æ–≤—ã–µ –∑–∞–Ω—è—Ç–∏—è
  RENTAL             // –ê—Ä–µ–Ω–¥–∞ –ø–æ–º–µ—â–µ–Ω–∏–π
  SINGLE_SESSION     // –†–∞–∑–æ–≤–æ–µ –∑–∞–Ω—è—Ç–∏–µ
  INDIVIDUAL_LESSON  // –ò–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω–æ–µ –∑–∞–Ω—è—Ç–∏–µ
  COWORKING          // –ö–æ–≤–æ—Ä–∫–∏–Ω–≥ (–µ—Å–ª–∏ –ø–ª–∞–Ω–∏—Ä—É–µ—Ç—Å—è)
  OTHER              // –ü—Ä–æ—á–∏–µ —É—Å–ª—É–≥–∏
}
```

### 4. Enum: WriteOffTiming

–ú–æ–¥–µ–ª—å —Å–ø–∏—Å–∞–Ω–∏—è —É—Å–ª—É–≥–∏.

```prisma
enum WriteOffTiming {
  ON_SALE  // –°–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–∏ –ø—Ä–æ–¥–∞–∂–µ (–æ–ø–ª–∞—Ç–µ —Å—á–µ—Ç–∞)
  ON_USE   // –°–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ (–ø–æ—à—Ç—É—á–Ω–æ)
}
```

---

## –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ –∏ —Ç–∏–ø—ã —É—Å–ª—É–≥

### 1. –ê–±–æ–Ω–µ–º–µ–Ω—Ç—ã (SUBSCRIPTION)

**–û–ø–∏—Å–∞–Ω–∏–µ:** –ê–±–æ–Ω–µ–º–µ–Ω—Ç—ã –Ω–∞ –≥—Ä—É–ø–ø–æ–≤—ã–µ –∑–∞–Ω—è—Ç–∏—è, –ø—Ä–∏–≤—è–∑–∞–Ω–Ω—ã–µ –∫ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–º –≥—Ä—É–ø–ø–∞–º –∏ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—é.

**–•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏:**
- –ü—Ä–∏–≤—è–∑–∫–∞ –∫ –≥—Ä—É–ø–ø–µ (`groupId`)
- –ï–¥–∏–Ω–∏—Ü–∞ –∏–∑–º–µ—Ä–µ–Ω–∏—è: "–º–µ—Å—è—Ü"
- –ú–æ–¥–µ–ª—å —Å–ø–∏—Å–∞–Ω–∏—è: **ON_USE** (—Å–ø–∏—Å–∞–Ω–∏–µ –ø–æ –ø–æ—Å–µ—â–µ–Ω–∏—è–º)
- –¢–∏–ø—ã:
  - **–ë–µ–∑–ª–∏–º–∏—Ç–Ω—ã–π –∞–±–æ–Ω–µ–º–µ–Ω—Ç** - –Ω–µ–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ—Å–µ—â–µ–Ω–∏–π
  - **–ê–±–æ–Ω–µ–º–µ–Ω—Ç N –∑–∞–Ω—è—Ç–∏–π** - —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ—Å–µ—â–µ–Ω–∏–π

**–ü—Ä–∏–º–µ—Ä:**
```json
{
  "name": "–ê–±–æ–Ω–µ–º–µ–Ω—Ç ¬´–¢–∞–Ω—Ü—ã –¥–ª—è –≤–∑—Ä–æ—Å–ª—ã—Ö¬ª (–º–µ—Å—è—Ü)",
  "categoryId": "cat-subscriptions",
  "serviceType": "SUBSCRIPTION",
  "groupId": "group-123",
  "basePrice": 4166.67,
  "vatRate": 20,
  "priceWithVat": 5000.00,
  "unitOfMeasure": "–º–µ—Å—è—Ü",
  "writeOffTiming": "ON_USE",
  "defaultQuantity": 8
}
```

### 2. –ê—Ä–µ–Ω–¥–∞ –ø–æ–º–µ—â–µ–Ω–∏–π (RENTAL)

**–û–ø–∏—Å–∞–Ω–∏–µ:** –ü–æ—á–∞—Å–æ–≤–∞—è –∞—Ä–µ–Ω–¥–∞ –∑–∞–ª–æ–≤, –ø–æ–º–µ—â–µ–Ω–∏–π, –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è.

**–•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏:**
- –ü—Ä–∏–≤—è–∑–∫–∞ –∫ –ø–æ–º–µ—â–µ–Ω–∏—é (`roomId`)
- –ï–¥–∏–Ω–∏—Ü–∞ –∏–∑–º–µ—Ä–µ–Ω–∏—è: "—á–∞—Å"
- –ú–æ–¥–µ–ª—å —Å–ø–∏—Å–∞–Ω–∏—è: **ON_SALE** (—Å–ø–∏—Å–∞–Ω–∏–µ —Å—Ä–∞–∑—É –ø—Ä–∏ –æ–ø–ª–∞—Ç–µ)
- –¶–µ–Ω–∞ —É–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –∑–∞ 1 —á–∞—Å

**–ü—Ä–∏–º–µ—Ä:**
```json
{
  "name": "–ê—Ä–µ–Ω–¥–∞ —Ç–∞–Ω—Ü–µ–≤–∞–ª—å–Ω–æ–≥–æ –∑–∞–ª–∞ (1 —á–∞—Å)",
  "categoryId": "cat-rental",
  "serviceType": "RENTAL",
  "roomId": "room-hall-1",
  "basePrice": 833.33,
  "vatRate": 20,
  "priceWithVat": 1000.00,
  "unitOfMeasure": "—á–∞—Å",
  "writeOffTiming": "ON_SALE",
  "defaultQuantity": 1
}
```

### 3. –†–∞–∑–æ–≤—ã–µ –∑–∞–Ω—è—Ç–∏—è (SINGLE_SESSION)

**–û–ø–∏—Å–∞–Ω–∏–µ:** –†–∞–∑–æ–≤—ã–µ –ø–æ—Å–µ—â–µ–Ω–∏—è –≥—Ä—É–ø–ø–æ–≤—ã—Ö –∑–∞–Ω—è—Ç–∏–π –±–µ–∑ –ø–æ–∫—É–ø–∫–∏ –∞–±–æ–Ω–µ–º–µ–Ω—Ç–∞.

**–•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏:**
- –ú–æ–∂–µ—Ç –±—ã—Ç—å –ø—Ä–∏–≤—è–∑–∫–∞ –∫ –≥—Ä—É–ø–ø–µ (`groupId`) –∏–ª–∏ –±–µ–∑ –Ω–µ–µ
- –ï–¥–∏–Ω–∏—Ü–∞ –∏–∑–º–µ—Ä–µ–Ω–∏—è: "–∑–∞–Ω—è—Ç–∏–µ"
- –ú–æ–¥–µ–ª—å —Å–ø–∏—Å–∞–Ω–∏—è: **ON_SALE** (—Å–ø–∏—Å–∞–Ω–∏–µ —Å—Ä–∞–∑—É –ø—Ä–∏ –æ–ø–ª–∞—Ç–µ)

**–ü—Ä–∏–º–µ—Ä:**
```json
{
  "name": "–†–∞–∑–æ–≤–æ–µ –∑–∞–Ω—è—Ç–∏–µ ¬´–ô–æ–≥–∞¬ª",
  "categoryId": "cat-single",
  "serviceType": "SINGLE_SESSION",
  "groupId": "group-yoga",
  "basePrice": 416.67,
  "vatRate": 20,
  "priceWithVat": 500.00,
  "unitOfMeasure": "–∑–∞–Ω—è—Ç–∏–µ",
  "writeOffTiming": "ON_SALE",
  "defaultQuantity": 1
}
```

### 4. –ò–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã–µ –∑–∞–Ω—è—Ç–∏—è (INDIVIDUAL_LESSON)

**–û–ø–∏—Å–∞–Ω–∏–µ:** –ó–∞–Ω—è—Ç–∏—è —Å –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–º –ø—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª–µ–º –æ–¥–∏–Ω-–Ω–∞-–æ–¥–∏–Ω –∏–ª–∏ –≤ –º–∞–ª–æ–π –≥—Ä—É–ø–ø–µ.

**–•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏:**
- –ú–æ–∂–µ—Ç –±—ã—Ç—å –ø—Ä–∏–≤—è–∑–∫–∞ –∫ –ø—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª—é (—á–µ—Ä–µ–∑ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏)
- –ï–¥–∏–Ω–∏—Ü–∞ –∏–∑–º–µ—Ä–µ–Ω–∏—è: "–∑–∞–Ω—è—Ç–∏–µ" –∏–ª–∏ "—á–∞—Å"
- –ú–æ–¥–µ–ª—å —Å–ø–∏—Å–∞–Ω–∏—è: **ON_SALE**
- –û–±—ã—á–Ω–æ –±–æ–ª–µ–µ –≤—ã—Å–æ–∫–∞—è —Ü–µ–Ω–∞, —á–µ–º –≥—Ä—É–ø–ø–æ–≤—ã–µ –∑–∞–Ω—è—Ç–∏—è

**–ü—Ä–∏–º–µ—Ä:**
```json
{
  "name": "–ò–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω–æ–µ –∑–∞–Ω—è—Ç–∏–µ –≤–æ–∫–∞–ª–æ–º (1 —á–∞—Å)",
  "categoryId": "cat-individual",
  "serviceType": "INDIVIDUAL_LESSON",
  "basePrice": 1666.67,
  "vatRate": 20,
  "priceWithVat": 2000.00,
  "unitOfMeasure": "—á–∞—Å",
  "writeOffTiming": "ON_SALE",
  "defaultQuantity": 1
}
```

### 5. –ü—Ä–æ—á–∏–µ —É—Å–ª—É–≥–∏ (OTHER)

**–û–ø–∏—Å–∞–Ω–∏–µ:** –õ—é–±—ã–µ –¥—Ä—É–≥–∏–µ —É—Å–ª—É–≥–∏, –Ω–µ –ø–æ–ø–∞–¥–∞—é—â–∏–µ –≤ –æ—Å–Ω–æ–≤–Ω—ã–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏.

**–•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏:**
- –ì–∏–±–∫–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –µ–¥–∏–Ω–∏—Ü –∏–∑–º–µ—Ä–µ–Ω–∏—è
- –ú–æ–¥–µ–ª—å —Å–ø–∏—Å–∞–Ω–∏—è: –ø–æ —Å–∏—Ç—É–∞—Ü–∏–∏ (ON_SALE –∏–ª–∏ ON_USE)

**–ü—Ä–∏–º–µ—Ä—ã:**
- –ü–µ—á–∞—Ç—å —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–π
- –ü—Ä–æ–¥–∞–∂–∞ —Ç–æ–≤–∞—Ä–æ–≤ (–∫–∞–Ω—Ü–µ–ª—è—Ä–∏—è, —Å—É–≤–µ–Ω–∏—Ä—ã)
- –£—á–∞—Å—Ç–∏–µ –≤ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è—Ö

---

## –ù–î–° (–ù–∞–ª–æ–≥ –Ω–∞ –¥–æ–±–∞–≤–ª–µ–Ω–Ω—É—é —Å—Ç–æ–∏–º–æ—Å—Ç—å)

### –û–±—â–∞—è –∫–æ–Ω—Ü–µ–ø—Ü–∏—è

–í —Å–∏—Å—Ç–µ–º–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ **–≥–∏–±–∫–∞—è —Å–∏—Å—Ç–µ–º–∞ –ù–î–°**, –ø–æ–∑–≤–æ–ª—è—é—â–∞—è –¥–ª—è –∫–∞–∂–¥–æ–π —É—Å–ª—É–≥–∏ –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞—Ç—å –∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—É—é —Å—Ç–∞–≤–∫—É –Ω–∞–ª–æ–≥–∞.

**–°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ —Å—Ç–∞–≤–∫–∏ –ù–î–° –≤ –†–§:**
- **20%** - —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è —Å—Ç–∞–≤–∫–∞ –¥–ª—è –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–∞ —É—Å–ª—É–≥
- **10%** - –ª—å–≥–æ—Ç–Ω–∞—è —Å—Ç–∞–≤–∫–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –¥–ª—è –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö –æ–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å–Ω—ã—Ö —É—Å–ª—É–≥)
- **0%** - —É—Å–ª—É–≥–∏, –æ—Å–≤–æ–±–æ–∂–¥–µ–Ω–Ω—ã–µ –æ—Ç –ù–î–°

### –†–∞—Å—á–µ—Ç —Ü–µ–Ω

–°–∏—Å—Ç–µ–º–∞ —Ö—Ä–∞–Ω–∏—Ç **—Ç—Ä–∏ –∑–Ω–∞—á–µ–Ω–∏—è** –¥–ª—è –∫–∞–∂–¥–æ–π —É—Å–ª—É–≥–∏:

1. **basePrice** - –±–∞–∑–æ–≤–∞—è —Ü–µ–Ω–∞ –±–µ–∑ –ù–î–°
2. **vatRate** - —Å—Ç–∞–≤–∫–∞ –ù–î–° –≤ –ø—Ä–æ—Ü–µ–Ω—Ç–∞—Ö
3. **priceWithVat** - –∏—Ç–æ–≥–æ–≤–∞—è —Ü–µ–Ω–∞ —Å –ù–î–°

#### –§–æ—Ä–º—É–ª—ã —Ä–∞—Å—á–µ—Ç–∞

```typescript
// –†–∞—Å—á–µ—Ç —Ü–µ–Ω—ã —Å –ù–î–°
priceWithVat = basePrice * (1 + vatRate / 100)

// –†–∞—Å—á–µ—Ç –ù–î–°
vatAmount = basePrice * (vatRate / 100)

// –†–∞—Å—á–µ—Ç –±–∞–∑–æ–≤–æ–π —Ü–µ–Ω—ã –∏–∑ —Ü–µ–Ω—ã —Å –ù–î–°
basePrice = priceWithVat / (1 + vatRate / 100)
```

#### –ü—Ä–∏–º–µ—Ä—ã —Ä–∞—Å—á–µ—Ç–∞

**–ü—Ä–∏–º–µ—Ä 1: –ê–±–æ–Ω–µ–º–µ–Ω—Ç 5000‚ÇΩ —Å –ù–î–° 20%**
```
basePrice = 5000 / 1.20 = 4166.67‚ÇΩ
vatAmount = 4166.67 * 0.20 = 833.33‚ÇΩ
priceWithVat = 5000‚ÇΩ
```

**–ü—Ä–∏–º–µ—Ä 2: –û–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å–Ω–∞—è —É—Å–ª—É–≥–∞ –±–µ–∑ –ù–î–° (0%)**
```
basePrice = 3000‚ÇΩ
vatAmount = 0‚ÇΩ
priceWithVat = 3000‚ÇΩ
```

### –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –≤ —Å—á–µ—Ç–∞—Ö

–ü—Ä–∏ —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–∏ —Å—á–µ—Ç–∞ (Invoice) –¥–ª—è –∫–∞–∂–¥–æ–π –ø–æ–∑–∏—Ü–∏–∏ (InvoiceItem) —É–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è:

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ –ü–æ–∑–∏—Ü–∏—è —Å—á–µ—Ç–∞                                       ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ –ê–±–æ–Ω–µ–º–µ–Ω—Ç ¬´–¢–∞–Ω—Ü—ã¬ª (–º–µ—Å—è—Ü)                           ‚îÇ
‚îÇ –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ: 1                                       ‚îÇ
‚îÇ –¶–µ–Ω–∞ –±–µ–∑ –ù–î–°: 4,166.67‚ÇΩ                             ‚îÇ
‚îÇ –ù–î–° (20%): 833.33‚ÇΩ                                  ‚îÇ
‚îÇ –ò—Ç–æ–≥–æ —Å –ù–î–°: 5,000.00‚ÇΩ                              ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### –ò–∑–º–µ–Ω–µ–Ω–∏–µ —Å—Ç–∞–≤–∫–∏ –ù–î–°

–ü—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ —Å—Ç–∞–≤–∫–∏ –ù–î–° –¥–ª—è —É—Å–ª—É–≥–∏:
- –°—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —Å—á–µ—Ç–∞ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç **—Å—Ç–∞—Ä—É—é —Å—Ç–∞–≤–∫—É –ù–î–°** (–Ω–∞ –º–æ–º–µ–Ω—Ç –≤—ã—Å—Ç–∞–≤–ª–µ–Ω–∏—è)
- –ù–æ–≤—ã–µ —Å—á–µ—Ç–∞ –∏—Å–ø–æ–ª—å–∑—É—é—Ç **–Ω–æ–≤—É—é —Å—Ç–∞–≤–∫—É –ù–î–°**

–≠—Ç–æ –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç—Å—è —Ç–µ–º, —á—Ç–æ `InvoiceItem` —Ö—Ä–∞–Ω–∏—Ç **–∫–æ–ø–∏—é** –¥–∞–Ω–Ω—ã—Ö –æ–± —É—Å–ª—É–≥–µ –Ω–∞ –º–æ–º–µ–Ω—Ç —Å–æ–∑–¥–∞–Ω–∏—è —Å—á–µ—Ç–∞.

---

## –ú–æ–¥–µ–ª–∏ —Å–ø–∏—Å–∞–Ω–∏—è —É—Å–ª—É–≥

### –ö–æ–Ω—Ü–µ–ø—Ü–∏—è

**–ú–æ–¥–µ–ª—å —Å–ø–∏—Å–∞–Ω–∏—è** –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç, **–∫–æ–≥–¥–∞** —É—Å–ª—É–≥–∞ —Å—á–∏—Ç–∞–µ—Ç—Å—è –ø–æ—Ç—Ä–µ–±–ª–µ–Ω–Ω–æ–π:

- **ON_SALE** - —É—Å–ª—É–≥–∞ —Å–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è **—Å—Ä–∞–∑—É –ø—Ä–∏ –æ–ø–ª–∞—Ç–µ** —Å—á–µ—Ç–∞
- **ON_USE** - —É—Å–ª—É–≥–∞ —Å–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è **–ø–æ –º–µ—Ä–µ —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–æ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è**

### 1. –°–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–∏ –ø—Ä–æ–¥–∞–∂–µ (ON_SALE)

**–ü—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –¥–ª—è:**
- –†–∞–∑–æ–≤—ã—Ö –∑–∞–Ω—è—Ç–∏–π
- –ê—Ä–µ–Ω–¥—ã –ø–æ–º–µ—â–µ–Ω–∏–π
- –ò–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã—Ö –∑–∞–Ω—è—Ç–∏–π
- –¢–æ–≤–∞—Ä–æ–≤

**–õ–æ–≥–∏–∫–∞:**
1. –ö–ª–∏–µ–Ω—Ç –æ–ø–ª–∞—á–∏–≤–∞–µ—Ç —Å—á–µ—Ç
2. –£—Å–ª—É–≥–∞ —Å—Ä–∞–∑—É —Å—á–∏—Ç–∞–µ—Ç—Å—è **–ø–æ–ª–Ω–æ—Å—Ç—å—é –æ–∫–∞–∑–∞–Ω–Ω–æ–π**
3. `writeOffStatus` = `COMPLETED`
4. `remainingQuantity` = 0

**–ü—Ä–∏–º–µ—Ä:**
```
–ö–ª–∏–µ–Ω—Ç –æ–ø–ª–∞—Ç–∏–ª —Ä–∞–∑–æ–≤–æ–µ –∑–∞–Ω—è—Ç–∏–µ –π–æ–≥–æ–π (500‚ÇΩ)
‚Üí –ó–∞–Ω—è—Ç–∏–µ —Å—Ä–∞–∑—É —Å–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è –∫–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–Ω–æ–µ
‚Üí –ö–ª–∏–µ–Ω—Ç –º–æ–∂–µ—Ç –ø–æ—Å–µ—Ç–∏—Ç—å 1 –∑–∞–Ω—è—Ç–∏–µ
```

### 2. –°–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ (ON_USE)

**–ü—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –¥–ª—è:**
- –ê–±–æ–Ω–µ–º–µ–Ω—Ç–æ–≤ –Ω–∞ –≥—Ä—É–ø–ø–æ–≤—ã–µ –∑–∞–Ω—è—Ç–∏—è
- –ú–Ω–æ–≥–æ–¥–Ω–µ–≤–Ω—ã—Ö —É—Å–ª—É–≥ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –∫–æ–≤–æ—Ä–∫–∏–Ω–≥ –Ω–∞ 5 –¥–Ω–µ–π)

**–õ–æ–≥–∏–∫–∞:**
1. –ö–ª–∏–µ–Ω—Ç –æ–ø–ª–∞—á–∏–≤–∞–µ—Ç —Å—á–µ—Ç
2. –£—Å–ª—É–≥–∞ **–Ω–µ —Å–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è —Å—Ä–∞–∑—É**
3. –ü—Ä–∏ –∫–∞–∂–¥–æ–º –ø–æ—Å–µ—â–µ–Ω–∏–∏/–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ —Å–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è **1 –µ–¥–∏–Ω–∏—Ü–∞**
4. `remainingQuantity` —É–º–µ–Ω—å—à–∞–µ—Ç—Å—è –Ω–∞ 1
5. –ö–æ–≥–¥–∞ `remainingQuantity` = 0, `writeOffStatus` = `COMPLETED`

**–ü—Ä–∏–º–µ—Ä:**
```
–ö–ª–∏–µ–Ω—Ç –∫—É–ø–∏–ª –∞–±–æ–Ω–µ–º–µ–Ω—Ç –Ω–∞ 8 –∑–∞–Ω—è—Ç–∏–π —Ç–∞–Ω—Ü–∞–º–∏
‚Üí remainingQuantity = 8
‚Üí –ü–æ—Å–ª–µ 1-–≥–æ –ø–æ—Å–µ—â–µ–Ω–∏—è: remainingQuantity = 7
‚Üí –ü–æ—Å–ª–µ 2-–≥–æ –ø–æ—Å–µ—â–µ–Ω–∏—è: remainingQuantity = 6
‚Üí ...
‚Üí –ü–æ—Å–ª–µ 8-–≥–æ –ø–æ—Å–µ—â–µ–Ω–∏—è: remainingQuantity = 0, writeOffStatus = COMPLETED
```

### –¢–∞–±–ª–∏—Ü–∞ –º–æ–¥–µ–ª–µ–π —Å–ø–∏—Å–∞–Ω–∏—è –ø–æ —Ç–∏–ø–∞–º —É—Å–ª—É–≥

| –¢–∏–ø —É—Å–ª—É–≥–∏ | –ú–æ–¥–µ–ª—å —Å–ø–∏—Å–∞–Ω–∏—è | –ï–¥–∏–Ω–∏—Ü–∞ –∏–∑–º–µ—Ä–µ–Ω–∏—è | –ü—Ä–∏–º–µ—Ä |
|------------|----------------|-------------------|--------|
| SUBSCRIPTION (–±–µ–∑–ª–∏–º–∏—Ç) | ON_USE | –º–µ—Å—è—Ü | –ê–±–æ–Ω–µ–º–µ–Ω—Ç –Ω–∞ 1 –º–µ—Å—è—Ü, —Å–ø–∏—Å–∞–Ω–∏–µ –ø–æ –ø–æ—Å–µ—â–µ–Ω–∏—è–º |
| SUBSCRIPTION (N –∑–∞–Ω—è—Ç–∏–π) | ON_USE | –∑–∞–Ω—è—Ç–∏–µ | –ê–±–æ–Ω–µ–º–µ–Ω—Ç 8 –∑–∞–Ω—è—Ç–∏–π, —Å–ø–∏—Å–∞–Ω–∏–µ –ø–æ –ø–æ—Å–µ—â–µ–Ω–∏—è–º |
| RENTAL | ON_SALE | —á–∞—Å | –ê—Ä–µ–Ω–¥–∞ –∑–∞–ª–∞ 3 —á–∞—Å–∞, —Å–ø–∏—Å–∞–Ω–∏–µ —Å—Ä–∞–∑—É |
| SINGLE_SESSION | ON_SALE | –∑–∞–Ω—è—Ç–∏–µ | –†–∞–∑–æ–≤–æ–µ –∑–∞–Ω—è—Ç–∏–µ, —Å–ø–∏—Å–∞–Ω–∏–µ —Å—Ä–∞–∑—É |
| INDIVIDUAL_LESSON | ON_SALE | –∑–∞–Ω—è—Ç–∏–µ/—á–∞—Å | –ò–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω–æ–µ –∑–∞–Ω—è—Ç–∏–µ, —Å–ø–∏—Å–∞–Ω–∏–µ —Å—Ä–∞–∑—É |
| OTHER | ON_SALE / ON_USE | –ª—é–±–∞—è | –í –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —É—Å–ª—É–≥–∏ |

### –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ —Å–ø–∏—Å–∞–Ω–∏—è –≤ InvoiceItem

```prisma
model InvoiceItem {
  id                 String         @id @default(uuid())
  invoiceId          String
  serviceId          String

  // –°–ø–∏—Å–∞–Ω–∏–µ
  writeOffTiming     WriteOffTiming
  writeOffStatus     WriteOffStatus @default(PENDING)
  quantity           Int            @default(1)
  remainingQuantity  Int            // –°–∫–æ–ª—å–∫–æ –µ—â–µ –æ—Å—Ç–∞–ª–æ—Å—å —Å–ø–∏—Å–∞—Ç—å

  // ... –¥—Ä—É–≥–∏–µ –ø–æ–ª—è
}

enum WriteOffStatus {
  PENDING      // –û–∂–∏–¥–∞–µ—Ç —Å–ø–∏—Å–∞–Ω–∏—è (–¥–ª—è ON_USE)
  IN_PROGRESS  // –ß–∞—Å—Ç–∏—á–Ω–æ —Å–ø–∏—Å–∞–Ω–æ (–¥–ª—è ON_USE)
  COMPLETED    // –ü–æ–ª–Ω–æ—Å—Ç—å—é —Å–ø–∏—Å–∞–Ω–æ
  CANCELLED    // –û—Ç–º–µ–Ω–µ–Ω–æ (–≤–æ–∑–≤—Ä–∞—Ç —Å—Ä–µ–¥—Å—Ç–≤)
}
```

---

## –õ—å–≥–æ—Ç—ã –∏ —Å–∫–∏–¥–∫–∏

### –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å BenefitCategory

–£—Å–ª—É–≥–∏ –∏–∑ –Ω–æ–º–µ–Ω–∫–ª–∞—Ç—É—Ä—ã –º–æ–≥—É—Ç –ø—Ä–æ–¥–∞–≤–∞—Ç—å—Å—è —Å–æ —Å–∫–∏–¥–∫–æ–π –Ω–∞ –æ—Å–Ω–æ–≤–∞–Ω–∏–∏ **–ª—å–≥–æ—Ç–Ω–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –∫–ª–∏–µ–Ω—Ç–∞**.

#### –ú–æ–¥–µ–ª—å BenefitCategory

```prisma
model BenefitCategory {
  id                 String   @id @default(uuid())

  name               String   @unique @db.VarChar(100)
  discountPercent    Decimal  @db.Decimal(5, 2)    // –ü—Ä–æ—Ü–µ–Ω—Ç —Å–∫–∏–¥–∫–∏ (0-100)
  description        String?  @db.Text

  requiresDocument   Boolean  @default(false)       // –¢—Ä–µ–±—É–µ—Ç—Å—è –ª–∏ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞—é—â–∏–π –¥–æ–∫—É–º–µ–Ω—Ç
  isActive           Boolean  @default(true)

  createdAt          DateTime @default(now())
  updatedAt          DateTime @updatedAt

  clients            Client[] @relation("ClientBenefitCategory")

  @@map("benefit_categories")
}
```

#### –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ –ª—å–≥–æ—Ç–Ω—ã–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏

| –ù–∞–∑–≤–∞–Ω–∏–µ | –°–∫–∏–¥–∫–∞ | –¢—Ä–µ–±—É–µ—Ç—Å—è –¥–æ–∫—É–º–µ–Ω—Ç |
|----------|--------|-------------------|
| –ú–Ω–æ–≥–æ–¥–µ—Ç–Ω–∞—è —Å–µ–º—å—è | 30% | –î–∞ (—É–¥–æ—Å—Ç–æ–≤–µ—Ä–µ–Ω–∏–µ) |
| –ò–Ω–≤–∞–ª–∏–¥ | 50% | –î–∞ (—Å–ø—Ä–∞–≤–∫–∞) |
| –ü–µ–Ω—Å–∏–æ–Ω–µ—Ä | 20% | –î–∞ (–ø–µ–Ω—Å–∏–æ–Ω–Ω–æ–µ) |
| –°–æ—Ç—Ä—É–¥–Ω–∏–∫ —Ü–µ–Ω—Ç—Ä–∞ | 100% | –ù–µ—Ç |

### –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –ª—å–≥–æ—Ç –ø—Ä–∏ –ø—Ä–æ–¥–∞–∂–µ

#### –õ–æ–≥–∏–∫–∞ —Ä–∞—Å—á–µ—Ç–∞

1. –ë–µ—Ä–µ—Ç—Å—è **–±–∞–∑–æ–≤–∞—è —Ü–µ–Ω–∞ —É—Å–ª—É–≥–∏** (`priceWithVat`)
2. –ü—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è **—Å–∫–∏–¥–∫–∞** –∏–∑ –ª—å–≥–æ—Ç–Ω–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –∫–ª–∏–µ–Ω—Ç–∞
3. –†–µ–∑—É–ª—å—Ç–∞—Ç –∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è –≤ `InvoiceItem.finalPrice`

```typescript
// –ü—Ä–∏–º–µ—Ä —Ä–∞—Å—á–µ—Ç–∞
const service = await getService(serviceId);
const client = await getClient(clientId);
const benefitCategory = await getBenefitCategory(client.benefitCategoryId);

const basePrice = service.priceWithVat;  // 5000‚ÇΩ
const discountPercent = benefitCategory.discountPercent;  // 30%
const discountAmount = basePrice * (discountPercent / 100);  // 1500‚ÇΩ
const finalPrice = basePrice - discountAmount;  // 3500‚ÇΩ

// –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ InvoiceItem
invoiceItem = {
  serviceName: service.name,
  basePrice: basePrice,           // 5000‚ÇΩ
  discountPercent: discountPercent,  // 30%
  discountAmount: discountAmount,    // 1500‚ÇΩ
  finalPrice: finalPrice,            // 3500‚ÇΩ
  benefitCategoryId: benefitCategory.id
};
```

#### –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –≤ —Å—á–µ—Ç–µ

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ –°—á–µ—Ç #INV-2025-0001                                 ‚îÇ
‚îÇ –ö–ª–∏–µ–Ω—Ç: –ò–≤–∞–Ω–æ–≤–∞ –ú–∞—Ä–∏—è                               ‚îÇ
‚îÇ –õ—å–≥–æ—Ç–Ω–∞—è –∫–∞—Ç–µ–≥–æ—Ä–∏—è: –ú–Ω–æ–≥–æ–¥–µ—Ç–Ω–∞—è —Å–µ–º—å—è (-30%)        ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ –ê–±–æ–Ω–µ–º–µ–Ω—Ç ¬´–¢–∞–Ω—Ü—ã¬ª (–º–µ—Å—è—Ü)                           ‚îÇ
‚îÇ –ë–∞–∑–æ–≤–∞—è —Ü–µ–Ω–∞: 5,000‚ÇΩ                                ‚îÇ
‚îÇ –°–∫–∏–¥–∫–∞ (30%): -1,500‚ÇΩ                               ‚îÇ
‚îÇ –ö –æ–ø–ª–∞—Ç–µ: 3,500‚ÇΩ                                    ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –ª—å–≥–æ—Ç

–ù–µ–∫–æ—Ç–æ—Ä—ã–µ —É—Å–ª—É–≥–∏ –º–æ–≥—É—Ç **–Ω–µ —É—á–∞—Å—Ç–≤–æ–≤–∞—Ç—å** –≤ —Å–∏—Å—Ç–µ–º–µ –ª—å–≥–æ—Ç. –î–ª—è —ç—Ç–æ–≥–æ –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –ø–æ–ª–µ –≤ –º–æ–¥–µ–ª—å `Service`:

```prisma
model Service {
  // ...
  allowBenefits  Boolean  @default(true)  // –ú–æ–∂–Ω–æ –ª–∏ –ø—Ä–∏–º–µ–Ω—è—Ç—å –ª—å–≥–æ—Ç—ã
}
```

---

## –ö–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–∞ —Ü–µ–Ω

### –û–±—â–∞—è –∫–æ–Ω—Ü–µ–ø—Ü–∏—è

–ú–µ–Ω–µ–¥–∂–µ—Ä—ã –º–æ–≥—É—Ç **–≤—Ä—É—á–Ω—É—é –∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∞—Ç—å —Ü–µ–Ω—ã** —É—Å–ª—É–≥ –ø—Ä–∏ —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–∏ —Å—á–µ—Ç–∞. –í—Å–µ —Ç–∞–∫–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è **–ª–æ–≥–∏—Ä—É—é—Ç—Å—è** –¥–ª—è –∫–æ–Ω—Ç—Ä–æ–ª—è –∏ –∞—É–¥–∏—Ç–∞.

### –ú–æ–¥–µ–ª—å InvoiceAuditLog

```prisma
model InvoiceAuditLog {
  id              String         @id @default(uuid())

  invoiceId       String         @map("invoice_id")
  invoiceItemId   String?        @map("invoice_item_id")

  // –ß—Ç–æ –∏–∑–º–µ–Ω–µ–Ω–æ
  action          AuditAction
  fieldName       String?        @db.VarChar(100)  // –ù–∞–∑–≤–∞–Ω–∏–µ –ø–æ–ª—è
  oldValue        String?        @db.Text          // –°—Ç–∞—Ä–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ (JSON)
  newValue        String?        @db.Text          // –ù–æ–≤–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ (JSON)

  // –ü—Ä–∏—á–∏–Ω–∞ –∏–∑–º–µ–Ω–µ–Ω–∏—è
  reason          String         @db.Text          // –û–±—è–∑–∞—Ç–µ–ª—å–Ω–∞—è –ø—Ä–∏—á–∏–Ω–∞
  reasonCategory  String?        @db.VarChar(100)  // –ö–∞—Ç–µ–≥–æ—Ä–∏—è –ø—Ä–∏—á–∏–Ω—ã

  // –ö—Ç–æ –∏ –∫–æ–≥–¥–∞
  userId          String         @map("user_id")
  createdAt       DateTime       @default(now()) @map("created_at")

  // –°–≤—è–∑–∏
  invoice         Invoice        @relation(fields: [invoiceId], references: [id])
  invoiceItem     InvoiceItem?   @relation(fields: [invoiceItemId], references: [id])
  user            User           @relation(fields: [userId], references: [id])

  @@map("invoice_audit_logs")
  @@index([invoiceId])
  @@index([invoiceItemId])
  @@index([userId])
}

enum AuditAction {
  CREATED             // –°—á–µ—Ç —Å–æ–∑–¥–∞–Ω
  UPDATED             // –°—á–µ—Ç –æ–±–Ω–æ–≤–ª–µ–Ω
  PRICE_ADJUSTED      // –¶–µ–Ω–∞ —Å–∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∞
  DISCOUNT_APPLIED    // –ü—Ä–∏–º–µ–Ω–µ–Ω–∞ —Å–∫–∏–¥–∫–∞
  ITEM_ADDED          // –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø–æ–∑–∏—Ü–∏—è
  ITEM_REMOVED        // –£–¥–∞–ª–µ–Ω–∞ –ø–æ–∑–∏—Ü–∏—è
  STATUS_CHANGED      // –ò–∑–º–µ–Ω–µ–Ω —Å—Ç–∞—Ç—É—Å
  CANCELLED           // –°—á–µ—Ç –æ—Ç–º–µ–Ω–µ–Ω
}
```

### –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ InvoiceItem –¥–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–æ–∫

```prisma
model InvoiceItem {
  id                 String    @id @default(uuid())

  // ... –±–∞–∑–æ–≤—ã–µ –ø–æ–ª—è ...

  // –ö–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–∞ —Ü–µ–Ω—ã
  isPriceAdjusted    Boolean   @default(false)  @map("is_price_adjusted")
  adjustmentReason   String?   @db.Text         @map("adjustment_reason")
  originalPrice      Decimal?  @db.Decimal(10, 2)  @map("original_price")
  adjustedPrice      Decimal?  @db.Decimal(10, 2)  @map("adjusted_price")

  auditLogs          InvoiceAuditLog[]

  // ...
}
```

### –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ –ø—Ä–∏—á–∏–Ω –∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–∏

| –ö–∞—Ç–µ–≥–æ—Ä–∏—è | –û–ø–∏—Å–∞–Ω–∏–µ | –ü—Ä–∏–º–µ—Ä |
|-----------|----------|--------|
| INDIVIDUAL_DISCOUNT | –ò–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω–∞—è —Å–∫–∏–¥–∫–∞ | "–ü–æ—Å—Ç–æ—è–Ω–Ω—ã–π –∫–ª–∏–µ–Ω—Ç, —Å–∫–∏–¥–∫–∞ 15%" |
| PROMO_ACTION | –ü—Ä–æ–º–æ-–∞–∫—Ü–∏—è | "–ê–∫—Ü–∏—è ¬´–ü—Ä–∏–≤–µ–¥–∏ –¥—Ä—É–≥–∞¬ª -20%" |
| COMPENSATION | –ö–æ–º–ø–µ–Ω—Å–∞—Ü–∏—è –∑–∞ –Ω–µ—É–¥–æ–±—Å—Ç–≤–∞ | "–ü—Ä–æ–ø—É—Å–∫ –∑–∞–Ω—è—Ç–∏—è –ø–æ –≤–∏–Ω–µ —Ü–µ–Ω—Ç—Ä–∞" |
| ERROR_CORRECTION | –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ—à–∏–±–∫–∏ | "–ù–µ–≤–µ—Ä–Ω–æ —É–∫–∞–∑–∞–Ω–∞ —Ü–µ–Ω–∞ –ø—Ä–∏ –≤—ã—Å—Ç–∞–≤–ª–µ–Ω–∏–∏" |
| MANAGEMENT_DECISION | –†–µ—à–µ–Ω–∏–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–∞ | "–°–æ—Ü–∏–∞–ª—å–Ω–∞—è –ø—Ä–æ–≥—Ä–∞–º–º–∞ –¥–ª—è –ø–µ–Ω—Å–∏–æ–Ω–µ—Ä–æ–≤" |
| OTHER | –ü—Ä–æ—á–µ–µ | –ü—Ä–æ–∏–∑–≤–æ–ª—å–Ω–∞—è –ø—Ä–∏—á–∏–Ω–∞ |

### –ü—Ä–æ—Ü–µ—Å—Å –∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–∏ —Ü–µ–Ω—ã

#### 1. –°–æ–∑–¥–∞–Ω–∏–µ —Å—á–µ—Ç–∞ —Å –±–∞–∑–æ–≤–æ–π —Ü–µ–Ω–æ–π

```typescript
// –°–æ–∑–¥–∞–Ω–∏–µ –ø–æ–∑–∏—Ü–∏–∏ —Å—á–µ—Ç–∞
const invoiceItem = {
  serviceId: service.id,
  serviceName: service.name,
  quantity: 1,
  unitPrice: service.priceWithVat,      // 5000‚ÇΩ
  finalPrice: service.priceWithVat,      // 5000‚ÇΩ
  isPriceAdjusted: false
};
```

#### 2. –ú–µ–Ω–µ–¥–∂–µ—Ä –∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä—É–µ—Ç —Ü–µ–Ω—É

```typescript
// –ö–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–∞ —Ü–µ–Ω—ã
const adjustedPrice = 4500;  // –°–∫–∏–¥–∫–∞ 500‚ÇΩ
const reason = "–ü–æ—Å—Ç–æ—è–Ω–Ω—ã–π –∫–ª–∏–µ–Ω—Ç, –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω–∞—è —Å–∫–∏–¥–∫–∞ 10%";
const reasonCategory = "INDIVIDUAL_DISCOUNT";

// –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ InvoiceItem
await updateInvoiceItem(itemId, {
  isPriceAdjusted: true,
  originalPrice: 5000,
  adjustedPrice: 4500,
  finalPrice: 4500,
  adjustmentReason: reason
});

// –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ InvoiceAuditLog
await createAuditLog({
  invoiceId: invoice.id,
  invoiceItemId: item.id,
  action: "PRICE_ADJUSTED",
  fieldName: "finalPrice",
  oldValue: "5000.00",
  newValue: "4500.00",
  reason: reason,
  reasonCategory: reasonCategory,
  userId: currentUser.id
});
```

#### 3. –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –≤ —Å—á–µ—Ç–µ

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ –°—á–µ—Ç #INV-2025-0001                                 ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ –ê–±–æ–Ω–µ–º–µ–Ω—Ç ¬´–¢–∞–Ω—Ü—ã¬ª (–º–µ—Å—è—Ü)                           ‚îÇ
‚îÇ –ë–∞–∑–æ–≤–∞—è —Ü–µ–Ω–∞: 5,000‚ÇΩ                                ‚îÇ
‚îÇ –°–∫–∏–¥–∫–∞: -500‚ÇΩ                                       ‚îÇ
‚îÇ ‚ö† –¶–µ–Ω–∞ —Å–∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∞ –º–µ–Ω–µ–¥–∂–µ—Ä–æ–º                  ‚îÇ
‚îÇ –ü—Ä–∏—á–∏–Ω–∞: –ü–æ—Å—Ç–æ—è–Ω–Ω—ã–π –∫–ª–∏–µ–Ω—Ç, —Å–∫–∏–¥–∫–∞ 10%              ‚îÇ
‚îÇ –ö –æ–ø–ª–∞—Ç–µ: 4,500‚ÇΩ                                    ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### –ü—Ä–æ—Å–º–æ—Ç—Ä –∏—Å—Ç–æ—Ä–∏–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–π

–î–ª—è –∫–∞–∂–¥–æ–≥–æ —Å—á–µ—Ç–∞ –¥–æ—Å—Ç—É–ø–Ω–∞ –ø–æ–ª–Ω–∞—è –∏—Å—Ç–æ—Ä–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π:

```
–ñ—É—Ä–Ω–∞–ª –∏–∑–º–µ–Ω–µ–Ω–∏–π —Å—á–µ—Ç–∞ #INV-2025-0001
‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
16.01.2025 10:15  | –ü–µ—Ç—Ä–æ–≤–∞ –ê. | –°—á–µ—Ç —Å–æ–∑–¥–∞–Ω
16.01.2025 10:17  | –ü–µ—Ç—Ä–æ–≤–∞ –ê. | –¶–µ–Ω–∞ —Å–∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∞
                                 5000‚ÇΩ ‚Üí 4500‚ÇΩ
                                 –ü—Ä–∏—á–∏–Ω–∞: –ü–æ—Å—Ç–æ—è–Ω–Ω—ã–π –∫–ª–∏–µ–Ω—Ç, —Å–∫–∏–¥–∫–∞ 10%
16.01.2025 14:30  | –°–∏—Å—Ç–µ–º–∞    | –°—Ç–∞—Ç—É—Å –∏–∑–º–µ–Ω–µ–Ω: DRAFT ‚Üí ISSUED
16.01.2025 15:00  | –°–∏—Å—Ç–µ–º–∞    | –°—á–µ—Ç –æ–ø–ª–∞—á–µ–Ω (PAID)
```

---

## –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –¥—Ä—É–≥–∏–º–∏ –º–æ–¥—É–ª—è–º–∏

### 1. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –º–æ–¥—É–ª–µ–º —Å—á–µ—Ç–æ–≤ (06_INVOICES_MODULE)

**–°–≤—è–∑—å:** `Service` ‚Üê `InvoiceItem`

#### –ü—Ä–æ—Ü–µ—Å—Å –ø—Ä–æ–¥–∞–∂–∏ —É—Å–ª—É–≥–∏

```
1. –ú–µ–Ω–µ–¥–∂–µ—Ä –≤—ã–±–∏—Ä–∞–µ—Ç –∫–ª–∏–µ–Ω—Ç–∞
2. –ú–µ–Ω–µ–¥–∂–µ—Ä –¥–æ–±–∞–≤–ª—è–µ—Ç —É—Å–ª—É–≥–∏ –∏–∑ –Ω–æ–º–µ–Ω–∫–ª–∞—Ç—É—Ä—ã –≤ —Å—á–µ—Ç
3. –°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏–º–µ–Ω—è–µ—Ç:
   - –ù–î–° –∏–∑ –Ω–∞—Å—Ç—Ä–æ–µ–∫ —É—Å–ª—É–≥–∏
   - –õ—å–≥–æ—Ç—ã –∏–∑ –ø—Ä–æ—Ñ–∏–ª—è –∫–ª–∏–µ–Ω—Ç–∞
4. –ú–µ–Ω–µ–¥–∂–µ—Ä –º–æ–∂–µ—Ç —Å–∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∞—Ç—å —Ü–µ–Ω—ã –≤—Ä—É—á–Ω—É—é
5. –°—á–µ—Ç –≤—ã—Å—Ç–∞–≤–ª—è–µ—Ç—Å—è –∫–ª–∏–µ–Ω—Ç—É
6. –ü–æ—Å–ª–µ –æ–ø–ª–∞—Ç—ã —Å–æ–∑–¥–∞—é—Ç—Å—è —Å–≤—è–∑–∞–Ω–Ω—ã–µ —Å—É—â–Ω–æ—Å—Ç–∏:
   - Subscription (–¥–ª—è –∞–±–æ–Ω–µ–º–µ–Ω—Ç–æ–≤)
   - RentalContract (–¥–ª—è –∞—Ä–µ–Ω–¥—ã)
```

#### –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –≤ InvoiceItem

–ü—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ —É—Å–ª—É–≥–∏ –≤ —Å—á–µ—Ç **–∫–æ–ø–∏—Ä—É—é—Ç—Å—è** –≤—Å–µ –¥–∞–Ω–Ω—ã–µ —É—Å–ª—É–≥–∏ –Ω–∞ –º–æ–º–µ–Ω—Ç —Å–æ–∑–¥–∞–Ω–∏—è:

```prisma
model InvoiceItem {
  serviceId          String    // –°—Å—ã–ª–∫–∞ –Ω–∞ Service
  serviceName        String    // –ö–û–ü–ò–Ø –Ω–∞–∑–≤–∞–Ω–∏—è
  serviceDescription String?   // –ö–û–ü–ò–Ø –æ–ø–∏—Å–∞–Ω–∏—è
  unitPrice          Decimal   // –ö–û–ü–ò–Ø —Ü–µ–Ω—ã
  vatRate            Decimal   // –ö–û–ü–ò–Ø —Å—Ç–∞–≤–∫–∏ –ù–î–°
  // ...
}
```

–≠—Ç–æ –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç, —á—Ç–æ **–∏–∑–º–µ–Ω–µ–Ω–∏–µ —Ü–µ–Ω—ã —É—Å–ª—É–≥–∏** –≤ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–µ **–Ω–µ –ø–æ–≤–ª–∏—è–µ—Ç** –Ω–∞ —É–∂–µ –≤—ã—Å—Ç–∞–≤–ª–µ–Ω–Ω—ã–µ —Å—á–µ—Ç–∞.

### 2. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –º–æ–¥—É–ª–µ–º –∞–±–æ–Ω–µ–º–µ–Ω—Ç–æ–≤ (04_SUBSCRIPTIONS_MODULE)

**–°–≤—è–∑—å:** `Service` (SUBSCRIPTION) ‚Üí `InvoiceItem` ‚Üí `Subscription`

#### –ü—Ä–æ—Ü–µ—Å—Å —Å–æ–∑–¥–∞–Ω–∏—è –∞–±–æ–Ω–µ–º–µ–Ω—Ç–∞

```
1. –ö–ª–∏–µ–Ω—Ç –ø–æ–∫—É–ø–∞–µ—Ç —É—Å–ª—É–≥—É —Ç–∏–ø–∞ SUBSCRIPTION
2. –ü–æ—Å–ª–µ –æ–ø–ª–∞—Ç—ã —Å—á–µ—Ç–∞ —Å–æ–∑–¥–∞–µ—Ç—Å—è Subscription:
   - clientId = –∏–∑ Invoice
   - groupId = –∏–∑ Service
   - subscriptionTypeId = –ø—Ä–∏–≤—è–∑–∫–∞ –∫ SubscriptionType
   - validMonth = –º–µ—Å—è—Ü –¥–µ–π—Å—Ç–≤–∏—è
   - paidPrice = –∏–∑ InvoiceItem.finalPrice
3. –ê–±–æ–Ω–µ–º–µ–Ω—Ç –∞–∫—Ç–∏–≤–∏—Ä—É–µ—Ç—Å—è
```

#### –ú–∏–≥—Ä–∞—Ü–∏—è —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö SubscriptionType

–î–ª—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–π –º–æ–¥–µ–ª—å—é `SubscriptionType`:

**–í–∞—Ä–∏–∞–Ω—Ç 1: –û–¥–∏–Ω Service = –û–¥–∏–Ω SubscriptionType**
```prisma
model Service {
  subscriptionTypeId  String?  // –°—Å—ã–ª–∫–∞ –Ω–∞ SubscriptionType
  subscriptionType    SubscriptionType?  @relation(...)
}
```

**–í–∞—Ä–∏–∞–Ω—Ç 2: Service —Å–æ–¥–µ—Ä–∂–∏—Ç –≤—Å—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é**
```
–°–æ–∑–¥–∞–µ—Ç—Å—è Service –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Ç–∏–ø–∞ –∞–±–æ–Ω–µ–º–µ–Ω—Ç–∞:
- "–ê–±–æ–Ω–µ–º–µ–Ω—Ç –¢–∞–Ω—Ü—ã –ë–µ–∑–ª–∏–º–∏—Ç (–º–µ—Å—è—Ü)"
- "–ê–±–æ–Ω–µ–º–µ–Ω—Ç –¢–∞–Ω—Ü—ã 8 –∑–∞–Ω—è—Ç–∏–π (–º–µ—Å—è—Ü)"
- ...

–ü—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ Subscription –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –¥–∞–Ω–Ω—ã–µ –∏–∑ Service
```

### 3. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –º–æ–¥—É–ª–µ–º –∫–ª–∏–µ–Ω—Ç–æ–≤

**–°–≤—è–∑—å:** `Client` ‚Üí `BenefitCategory` ‚Üí —Å–∫–∏–¥–∫–∞ –Ω–∞ `Service`

```prisma
model Client {
  // ...
  benefitCategoryId  String?  @map("benefit_category_id")
  benefitCategory    BenefitCategory?  @relation(...)
}
```

–ü—Ä–∏ –≤—ã—Å—Ç–∞–≤–ª–µ–Ω–∏–∏ —Å—á–µ—Ç–∞:
1. –ü—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è, –µ—Å—Ç—å –ª–∏ —É –∫–ª–∏–µ–Ω—Ç–∞ –ª—å–≥–æ—Ç–Ω–∞—è –∫–∞—Ç–µ–≥–æ—Ä–∏—è
2. –ï—Å–ª–∏ –µ—Å—Ç—å, –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è —Å–∫–∏–¥–∫–∞ –∫–æ –≤—Å–µ–º —É—Å–ª—É–≥–∞–º
3. –ú–µ–Ω–µ–¥–∂–µ—Ä –º–æ–∂–µ—Ç —Å–∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –∏—Ç–æ–≥–æ–≤—É—é —Ü–µ–Ω—É –≤—Ä—É—á–Ω—É—é

### 4. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –º–æ–¥—É–ª–µ–º –∞—Ä–µ–Ω–¥—ã –ø–æ–º–µ—â–µ–Ω–∏–π

**–°–≤—è–∑—å:** `Service` (RENTAL) ‚Üí `Room`

```prisma
model Service {
  roomId  String?  // –î–ª—è —É—Å–ª—É–≥ —Ç–∏–ø–∞ RENTAL
  room    Room?    @relation(...)
}
```

–ü—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ —É—Å–ª—É–≥–∏ –∞—Ä–µ–Ω–¥—ã:
```typescript
const rentalService = {
  name: `–ê—Ä–µ–Ω–¥–∞ ${room.name} (1 —á–∞—Å)`,
  serviceType: "RENTAL",
  roomId: room.id,
  basePrice: room.hourlyRate / 1.20,  // –¶–µ–Ω–∞ –±–µ–∑ –ù–î–°
  vatRate: 20,
  priceWithVat: room.hourlyRate,
  unitOfMeasure: "—á–∞—Å"
};
```

---

## API —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è

### Endpoints –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —É—Å–ª—É–≥–∞–º–∏

#### 1. –ü–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ —É—Å–ª—É–≥

```http
GET /api/services
```

**Query Parameters:**
- `categoryId` (UUID, optional) - –§–∏–ª—å—Ç—Ä –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
- `serviceType` (enum, optional) - –§–∏–ª—å—Ç—Ä –ø–æ —Ç–∏–ø—É —É—Å–ª—É–≥–∏
- `isActive` (boolean, optional) - –¢–æ–ª—å–∫–æ –∞–∫—Ç–∏–≤–Ω—ã–µ —É—Å–ª—É–≥–∏
- `search` (string, optional) - –ü–æ–∏—Å–∫ –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—é
- `page` (number, default: 1) - –°—Ç—Ä–∞–Ω–∏—Ü–∞
- `limit` (number, default: 20) - –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ

**Response:**
```json
{
  "data": [
    {
      "id": "uuid",
      "name": "–ê–±–æ–Ω–µ–º–µ–Ω—Ç ¬´–¢–∞–Ω—Ü—ã –¥–ª—è –≤–∑—Ä–æ—Å–ª—ã—Ö¬ª (–º–µ—Å—è—Ü)",
      "shortDescription": "–ë–µ–∑–ª–∏–º–∏—Ç–Ω—ã–π –∞–±–æ–Ω–µ–º–µ–Ω—Ç –Ω–∞ –º–µ—Å—è—Ü",
      "categoryId": "cat-subscriptions",
      "category": {
        "id": "cat-subscriptions",
        "name": "–ê–±–æ–Ω–µ–º–µ–Ω—Ç—ã"
      },
      "serviceType": "SUBSCRIPTION",
      "basePrice": 4166.67,
      "vatRate": 20,
      "priceWithVat": 5000.00,
      "unitOfMeasure": "–º–µ—Å—è—Ü",
      "writeOffTiming": "ON_USE",
      "groupId": "group-123",
      "group": {
        "id": "group-123",
        "name": "–¢–∞–Ω—Ü—ã –¥–ª—è –≤–∑—Ä–æ—Å–ª—ã—Ö (–ü–Ω, –°—Ä 19:00)"
      },
      "isActive": true,
      "createdAt": "2025-01-10T10:00:00Z"
    }
  ],
  "meta": {
    "page": 1,
    "limit": 20,
    "total": 45,
    "totalPages": 3
  }
}
```

#### 2. –ü–æ–ª—É—á–∏—Ç—å —É—Å–ª—É–≥—É –ø–æ ID

```http
GET /api/services/:id
```

**Response:**
```json
{
  "id": "uuid",
  "name": "–ê–±–æ–Ω–µ–º–µ–Ω—Ç ¬´–¢–∞–Ω—Ü—ã –¥–ª—è –≤–∑—Ä–æ—Å–ª—ã—Ö¬ª (–º–µ—Å—è—Ü)",
  "description": "–ë–µ–∑–ª–∏–º–∏—Ç–Ω—ã–π –∞–±–æ–Ω–µ–º–µ–Ω—Ç –Ω–∞ –≥—Ä—É–ø–ø–æ–≤—ã–µ –∑–∞–Ω—è—Ç–∏—è —Ç–∞–Ω—Ü–∞–º–∏...",
  "shortDescription": "–ë–µ–∑–ª–∏–º–∏—Ç–Ω—ã–π –∞–±–æ–Ω–µ–º–µ–Ω—Ç –Ω–∞ –º–µ—Å—è—Ü",
  "categoryId": "cat-subscriptions",
  "serviceType": "SUBSCRIPTION",
  "basePrice": 4166.67,
  "vatRate": 20,
  "priceWithVat": 5000.00,
  "unitOfMeasure": "–º–µ—Å—è—Ü",
  "writeOffTiming": "ON_USE",
  "defaultQuantity": 8,
  "groupId": "group-123",
  "isActive": true,
  "isArchived": false,
  "sortOrder": 1,
  "createdAt": "2025-01-10T10:00:00Z",
  "updatedAt": "2025-01-15T14:30:00Z"
}
```

#### 3. –°–æ–∑–¥–∞—Ç—å —É—Å–ª—É–≥—É

```http
POST /api/services
```

**Request Body:**
```json
{
  "name": "–ê–±–æ–Ω–µ–º–µ–Ω—Ç ¬´–ô–æ–≥–∞¬ª (–º–µ—Å—è—Ü)",
  "description": "–ë–µ–∑–ª–∏–º–∏—Ç–Ω—ã–π –∞–±–æ–Ω–µ–º–µ–Ω—Ç –Ω–∞ –∑–∞–Ω—è—Ç–∏—è –π–æ–≥–æ–π",
  "shortDescription": "–ë–µ–∑–ª–∏–º–∏—Ç–Ω—ã–π –∞–±–æ–Ω–µ–º–µ–Ω—Ç",
  "categoryId": "cat-subscriptions",
  "serviceType": "SUBSCRIPTION",
  "priceWithVat": 4000.00,
  "vatRate": 20,
  "unitOfMeasure": "–º–µ—Å—è—Ü",
  "writeOffTiming": "ON_USE",
  "defaultQuantity": 8,
  "groupId": "group-yoga-1",
  "isActive": true
}
```

**Response:** –°–æ–∑–¥–∞–Ω–Ω–∞—è —É—Å–ª—É–≥–∞ (—Å–º. —Ñ–æ—Ä–º–∞—Ç –≤—ã—à–µ)

#### 4. –û–±–Ω–æ–≤–∏—Ç—å —É—Å–ª—É–≥—É

```http
PATCH /api/services/:id
```

**Request Body:** –ß–∞—Å—Ç–∏—á–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–æ–ª–µ–π

```json
{
  "priceWithVat": 4500.00,
  "basePrice": 3750.00
}
```

#### 5. –ê—Ä—Ö–∏–≤–∏—Ä–æ–≤–∞—Ç—å —É—Å–ª—É–≥—É

```http
POST /api/services/:id/archive
```

**Response:**
```json
{
  "id": "uuid",
  "isArchived": true,
  "archivedAt": "2025-01-16T10:00:00Z"
}
```

#### 6. –£–¥–∞–ª–∏—Ç—å —É—Å–ª—É–≥—É

```http
DELETE /api/services/:id
```

**Note:** –£—Å–ª—É–≥—É –º–æ–∂–Ω–æ —É–¥–∞–ª–∏—Ç—å, —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –æ–Ω–∞ –Ω–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∞—Å—å –Ω–∏ –≤ –æ–¥–Ω–æ–º —Å—á–µ—Ç–µ.

### Endpoints –¥–ª—è –∫–∞—Ç–µ–≥–æ—Ä–∏–π —É—Å–ª—É–≥

#### 1. –ü–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ –∫–∞—Ç–µ–≥–æ—Ä–∏–π

```http
GET /api/service-categories
```

**Response:**
```json
{
  "data": [
    {
      "id": "cat-subscriptions",
      "name": "–ê–±–æ–Ω–µ–º–µ–Ω—Ç—ã",
      "description": "–ê–±–æ–Ω–µ–º–µ–Ω—Ç—ã –Ω–∞ –≥—Ä—É–ø–ø–æ–≤—ã–µ –∑–∞–Ω—è—Ç–∏—è",
      "icon": "üé´",
      "color": "#4CAF50",
      "sortOrder": 1,
      "isActive": true,
      "servicesCount": 12
    }
  ]
}
```

#### 2. –°–æ–∑–¥–∞—Ç—å –∫–∞—Ç–µ–≥–æ—Ä–∏—é

```http
POST /api/service-categories
```

**Request Body:**
```json
{
  "name": "–ê–±–æ–Ω–µ–º–µ–Ω—Ç—ã",
  "description": "–ê–±–æ–Ω–µ–º–µ–Ω—Ç—ã –Ω–∞ –≥—Ä—É–ø–ø–æ–≤—ã–µ –∑–∞–Ω—è—Ç–∏—è",
  "icon": "üé´",
  "color": "#4CAF50"
}
```

---

## –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –ü—Ä–∏–º–µ—Ä 1: –°–æ–∑–¥–∞–Ω–∏–µ –∞–±–æ–Ω–µ–º–µ–Ω—Ç–∞ –¥–ª—è –≥—Ä—É–ø–ø—ã

```typescript
// 1. –°–æ–∑–¥–∞–µ–º —É—Å–ª—É–≥—É-–∞–±–æ–Ω–µ–º–µ–Ω—Ç
const service = await createService({
  name: "–ê–±–æ–Ω–µ–º–µ–Ω—Ç ¬´–¢–∞–Ω—Ü—ã –¥–ª—è –¥–µ—Ç–µ–π 7-10 –ª–µ—Ç¬ª (–º–µ—Å—è—Ü)",
  description: "–ë–µ–∑–ª–∏–º–∏—Ç–Ω—ã–π –∞–±–æ–Ω–µ–º–µ–Ω—Ç –Ω–∞ –≥—Ä—É–ø–ø–æ–≤—ã–µ –∑–∞–Ω—è—Ç–∏—è —Ç–∞–Ω—Ü–∞–º–∏",
  categoryId: "cat-subscriptions",
  serviceType: "SUBSCRIPTION",
  groupId: "group-kids-dance",

  // –¶–µ–Ω–∞ —Å –ù–î–° 3600‚ÇΩ
  priceWithVat: 3600.00,
  vatRate: 20,
  basePrice: 3000.00,  // 3600 / 1.20

  unitOfMeasure: "–º–µ—Å—è—Ü",
  writeOffTiming: "ON_USE",
  defaultQuantity: 8,  // –ü—Ä–∏–º–µ—Ä–Ω–æ 8 –∑–∞–Ω—è—Ç–∏–π –≤ –º–µ—Å—è—Ü
  isActive: true
});

// 2. –ü—Ä–æ–¥–∞–µ–º –∞–±–æ–Ω–µ–º–µ–Ω—Ç –∫–ª–∏–µ–Ω—Ç—É
const client = await getClient(clientId);

// –°–æ–∑–¥–∞–µ–º —Å—á–µ—Ç
const invoice = await createInvoice({
  clientId: client.id,
  status: "DRAFT"
});

// –î–æ–±–∞–≤–ª—è–µ–º —É—Å–ª—É–≥—É –≤ —Å—á–µ—Ç
const invoiceItem = await addInvoiceItem({
  invoiceId: invoice.id,
  serviceId: service.id,
  quantity: 1,

  // –ö–æ–ø–∏—Ä—É–µ–º –¥–∞–Ω–Ω—ã–µ —É—Å–ª—É–≥–∏
  serviceName: service.name,
  unitPrice: service.priceWithVat,
  vatRate: service.vatRate,
  basePrice: service.basePrice,

  // –ü—Ä–∏–º–µ–Ω—è–µ–º –ª—å–≥–æ—Ç—É –∫–ª–∏–µ–Ω—Ç–∞ (–µ—Å–ª–∏ –µ—Å—Ç—å)
  discountPercent: client.benefitCategory?.discountPercent || 0,
  finalPrice: calculateFinalPrice(service, client)
});

// 3. –ö–ª–∏–µ–Ω—Ç –æ–ø–ª–∞—á–∏–≤–∞–µ—Ç —Å—á–µ—Ç
await payInvoice(invoice.id, {
  amount: invoice.totalAmount,
  paymentMethod: "CARD"
});

// 4. –°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞–µ—Ç –∞–±–æ–Ω–µ–º–µ–Ω—Ç
const subscription = await createSubscription({
  clientId: client.id,
  groupId: service.groupId,
  invoiceItemId: invoiceItem.id,
  validMonth: "2025-02",
  paidPrice: invoiceItem.finalPrice,
  status: "ACTIVE"
});
```

### –ü—Ä–∏–º–µ—Ä 2: –ê—Ä–µ–Ω–¥–∞ –ø–æ–º–µ—â–µ–Ω–∏—è

```typescript
// 1. –°–æ–∑–¥–∞–µ–º —É—Å–ª—É–≥—É –∞—Ä–µ–Ω–¥—ã –∑–∞–ª–∞
const room = await getRoom("room-hall-1");

const rentalService = await createService({
  name: `–ê—Ä–µ–Ω–¥–∞ ${room.name} (1 —á–∞—Å)`,
  description: `–ü–æ—á–∞—Å–æ–≤–∞—è –∞—Ä–µ–Ω–¥–∞ ${room.name}`,
  categoryId: "cat-rental",
  serviceType: "RENTAL",
  roomId: room.id,

  priceWithVat: 1000.00,
  vatRate: 20,
  basePrice: 833.33,

  unitOfMeasure: "—á–∞—Å",
  writeOffTiming: "ON_SALE",  // –°–ø–∏—Å–∞–Ω–∏–µ —Å—Ä–∞–∑—É
  defaultQuantity: 1,
  isActive: true
});

// 2. –ö–ª–∏–µ–Ω—Ç —Ö–æ—á–µ—Ç –∞—Ä–µ–Ω–¥–æ–≤–∞—Ç—å –∑–∞–ª –Ω–∞ 3 —á–∞—Å–∞
const invoice = await createInvoice({
  clientId: client.id
});

const invoiceItem = await addInvoiceItem({
  invoiceId: invoice.id,
  serviceId: rentalService.id,
  quantity: 3,  // 3 —á–∞—Å–∞

  unitPrice: 1000.00,
  finalPrice: 3000.00,  // 1000 * 3

  writeOffTiming: "ON_SALE"
});

// 3. –ü–æ—Å–ª–µ –æ–ø–ª–∞—Ç—ã –∞—Ä–µ–Ω–¥–∞ —Å—Ä–∞–∑—É —Å–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è
await payInvoice(invoice.id);

// invoiceItem.writeOffStatus = "COMPLETED"
// invoiceItem.remainingQuantity = 0
```

### –ü—Ä–∏–º–µ—Ä 3: –ö–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–∞ —Ü–µ–Ω—ã –¥–ª—è –ø–æ—Å—Ç–æ—è–Ω–Ω–æ–≥–æ –∫–ª–∏–µ–Ω—Ç–∞

```typescript
// –ö–ª–∏–µ–Ω—Ç - –ø–æ—Å—Ç–æ—è–Ω–Ω—ã–π, –¥–∞–µ–º —Å–∫–∏–¥–∫—É 15%
const service = await getService(serviceId);  // –¶–µ–Ω–∞: 5000‚ÇΩ

const invoice = await createInvoice({ clientId });

let invoiceItem = await addInvoiceItem({
  invoiceId: invoice.id,
  serviceId: service.id,
  quantity: 1,
  unitPrice: 5000.00,
  finalPrice: 5000.00
});

// –ú–µ–Ω–µ–¥–∂–µ—Ä –∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä—É–µ—Ç —Ü–µ–Ω—É
invoiceItem = await adjustInvoiceItemPrice({
  invoiceItemId: invoiceItem.id,
  newPrice: 4250.00,  // –°–∫–∏–¥–∫–∞ 750‚ÇΩ (15%)
  reason: "–ü–æ—Å—Ç–æ—è–Ω–Ω—ã–π –∫–ª–∏–µ–Ω—Ç, –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω–∞—è —Å–∫–∏–¥–∫–∞ 15%",
  reasonCategory: "INDIVIDUAL_DISCOUNT",
  userId: currentUser.id
});

// –°–æ–∑–¥–∞–µ—Ç—Å—è –∑–∞–ø–∏—Å—å –≤ InvoiceAuditLog:
// {
//   action: "PRICE_ADJUSTED",
//   oldValue: "5000.00",
//   newValue: "4250.00",
//   reason: "–ü–æ—Å—Ç–æ—è–Ω–Ω—ã–π –∫–ª–∏–µ–Ω—Ç, —Å–∫–∏–¥–∫–∞ 15%",
//   userId: manager.id
// }
```

### –ü—Ä–∏–º–µ—Ä 4: –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –ª—å–≥–æ—Ç—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏

```typescript
// –ö–ª–∏–µ–Ω—Ç –∏–º–µ–µ—Ç –ª—å–≥–æ—Ç–Ω—É—é –∫–∞—Ç–µ–≥–æ—Ä–∏—é "–ú–Ω–æ–≥–æ–¥–µ—Ç–Ω–∞—è —Å–µ–º—å—è" (30%)
const client = await getClient(clientId);
// client.benefitCategoryId = "benefit-large-family"
// client.benefitCategory.discountPercent = 30

const service = await getService(serviceId);
// service.priceWithVat = 5000‚ÇΩ

const invoice = await createInvoice({ clientId: client.id });

// –ü—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ —É—Å–ª—É–≥–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –ª—å–≥–æ—Ç–∞
const invoiceItem = await addInvoiceItem({
  invoiceId: invoice.id,
  serviceId: service.id,
  quantity: 1
});

// –°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç:
// basePrice = 5000‚ÇΩ
// discountPercent = 30%
// discountAmount = 1500‚ÇΩ
// finalPrice = 3500‚ÇΩ

console.log(invoiceItem);
// {
//   serviceName: "–ê–±–æ–Ω–µ–º–µ–Ω—Ç ¬´–¢–∞–Ω—Ü—ã¬ª (–º–µ—Å—è—Ü)",
//   unitPrice: 5000.00,
//   discountPercent: 30,
//   discountAmount: 1500.00,
//   finalPrice: 3500.00,
//   benefitCategoryId: "benefit-large-family"
// }
```

### –ü—Ä–∏–º–µ—Ä 5: –†–∞–∑–æ–≤–æ–µ –∑–∞–Ω—è—Ç–∏–µ –±–µ–∑ –∞–±–æ–Ω–µ–º–µ–Ω—Ç–∞

```typescript
// –ö–ª–∏–µ–Ω—Ç —Ö–æ—á–µ—Ç –ø–æ—Å–µ—Ç–∏—Ç—å –æ–¥–Ω–æ –∑–∞–Ω—è—Ç–∏–µ –π–æ–≥–æ–π
const singleSessionService = await createService({
  name: "–†–∞–∑–æ–≤–æ–µ –∑–∞–Ω—è—Ç–∏–µ ¬´–ô–æ–≥–∞¬ª",
  categoryId: "cat-single",
  serviceType: "SINGLE_SESSION",
  groupId: "group-yoga",

  priceWithVat: 500.00,
  vatRate: 20,
  basePrice: 416.67,

  unitOfMeasure: "–∑–∞–Ω—è—Ç–∏–µ",
  writeOffTiming: "ON_SALE",  // –°–ø–∏—Å–∞–Ω–∏–µ —Å—Ä–∞–∑—É
  isActive: true
});

const invoice = await createInvoice({ clientId });
const invoiceItem = await addInvoiceItem({
  invoiceId: invoice.id,
  serviceId: singleSessionService.id,
  quantity: 1
});

// –ü–æ—Å–ª–µ –æ–ø–ª–∞—Ç—ã —Å—Ä–∞–∑—É —Å–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è
await payInvoice(invoice.id);

// invoiceItem.writeOffStatus = "COMPLETED"
// –ö–ª–∏–µ–Ω—Ç –º–æ–∂–µ—Ç –ø–æ—Å–µ—Ç–∏—Ç—å 1 –∑–∞–Ω—è—Ç–∏–µ
```

---

## –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

–ú–æ–¥—É–ª—å **–ù–æ–º–µ–Ω–∫–ª–∞—Ç—É—Ä–∞ —É—Å–ª—É–≥** —è–≤–ª—è–µ—Ç—Å—è —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–º —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–æ–º –¥–ª—è –≤—Å–µ—Ö –ø—Ä–æ–¥–∞–≤–∞–µ–º—ã—Ö —É—Å–ª—É–≥ –∫—É–ª—å—Ç—É—Ä–Ω–æ–≥–æ —Ü–µ–Ω—Ç—Ä–∞. –û–Ω –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç:

‚úÖ **–ï–¥–∏–Ω–æ–æ–±—Ä–∞–∑–∏–µ** - –≤—Å–µ —É—Å–ª—É–≥–∏ —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ –æ–¥–Ω–æ–π —Ç–∞–±–ª–∏—Ü–µ
‚úÖ **–ì–∏–±–∫–æ—Å—Ç—å** - –ø–æ–¥–¥–µ—Ä–∂–∫–∞ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Ç–∏–ø–æ–≤ —É—Å–ª—É–≥ –∏ –º–æ–¥–µ–ª–µ–π —Å–ø–∏—Å–∞–Ω–∏—è
‚úÖ **–ü—Ä–æ–∑—Ä–∞—á–Ω–æ—Å—Ç—å** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –ù–î–° –∏ –ª—å–≥–æ—Ç
‚úÖ **–ö–æ–Ω—Ç—Ä–æ–ª—å** - –ø–æ–ª–Ω—ã–π –∞—É–¥–∏—Ç –∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–æ–∫ —Ü–µ–Ω
‚úÖ **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è** - —Ç–µ—Å–Ω–∞—è —Å–≤—è–∑—å —Å –º–æ–¥—É–ª—è–º–∏ —Å—á–µ—Ç–æ–≤, –∞–±–æ–Ω–µ–º–µ–Ω—Ç–æ–≤, –∞—Ä–µ–Ω–¥—ã

### –î–∞–ª—å–Ω–µ–π—à–∏–µ —à–∞–≥–∏

1. **–†–µ–∞–ª–∏–∑–∞—Ü–∏—è –º–æ–¥–µ–ª–µ–π Prisma** - —Å–æ–∑–¥–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö
2. **–†–∞–∑—Ä–∞–±–æ—Ç–∫–∞ API** - NestJS –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä—ã –∏ —Å–µ—Ä–≤–∏—Å—ã
3. **–ú–∏–≥—Ä–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö** - –ø–µ—Ä–µ–Ω–æ—Å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö `SubscriptionType` –≤ `Service`
4. **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –º–æ–¥—É–ª–µ–º —Å—á–µ—Ç–æ–≤** - —Å–≤—è–∑–∫–∞ —Å `Invoice` –∏ `InvoiceItem`
5. **UI –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è** - –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –Ω–æ–º–µ–Ω–∫–ª–∞—Ç—É—Ä–æ–π

---

**–î–æ–∫—É–º–µ–Ω—Ç –ø–æ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω:** 16.01.2025
**–ê–≤—Ç–æ—Ä:** –°–∏—Å—Ç–µ–º–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ ArtSVAO
**–í–µ—Ä—Å–∏—è:** 1.0
