# ะะพะดัะปั 3: ะกััะดะธะธ ะธ ัะตะบัะธะธ

**ะะตััะธั:** 1.0
**ะะฐัะฐ:** 2025-11-13
**ะกัะฐััั:** ะ ัะฐะทัะฐะฑะพัะบะต

---

## ะกะพะดะตัะถะฐะฝะธะต

1. [ะะฑัะตะต ะพะฟะธัะฐะฝะธะต](#1-ะพะฑัะตะต-ะพะฟะธัะฐะฝะธะต)
2. [ะกัััะบัััั ะดะฐะฝะฝัั](#2-ััััะบัััั-ะดะฐะฝะฝัั)
3. [ะะธะทะฝะตั-ะฟัะพัะตััั](#3-ะฑะธะทะฝะตั-ะฟัะพัะตััั)
4. [ะะฐะปะธะดะฐัะธั ะดะฐะฝะฝัั](#4-ะฒะฐะปะธะดะฐัะธั-ะดะฐะฝะฝัั)
5. [UI/UX ัะฟะตัะธัะธะบะฐัะธั](#5-uiux-ัะฟะตัะธัะธะบะฐัะธั)
6. [API ัะฝะดะฟะพะธะฝัั](#6-api-ัะฝะดะฟะพะธะฝัั)
7. [ะะฝัะตะณัะฐัะธะธ](#7-ะธะฝัะตะณัะฐัะธะธ)
8. [ะัะฐะฒะฐ ะดะพัััะฟะฐ](#8-ะฟัะฐะฒะฐ-ะดะพัััะฟะฐ)

---

## 1. ะะฑัะตะต ะพะฟะธัะฐะฝะธะต

### 1.1. ะะฐะทะฝะฐัะตะฝะธะต ะผะพะดัะปั

ะะพะดัะปั **ะกััะดะธะธ ะธ ัะตะบัะธะธ** ะพะฑะตัะฟะตัะธะฒะฐะตั ัะฟัะฐะฒะปะตะฝะธะต ะพะฑัะฐะทะพะฒะฐัะตะปัะฝะพะน ะดะตััะตะปัะฝะพัััั ะบัะปััััะฝะพะณะพ ัะตะฝััะฐ:
- ะัะณะฐะฝะธะทะฐัะธั ะฝะฐะฟัะฐะฒะปะตะฝะธะน, ัััะดะธะน ะธ ะณััะฟะฟ
- ะะฐะฟะธัั ะบะปะธะตะฝัะพะฒ ะฒ ะณััะฟะฟั (ะฟะพััะพัะฝะฝะฐั ะธ ัะฐะทะพะฒะฐั)
- ะฃัะตั ะฟะพัะตัะฐะตะผะพััะธ ะธ ะฟัะพะฟััะบะพะฒ
- ะฃะฟัะฐะฒะปะตะฝะธะต ะธะฝะดะธะฒะธะดัะฐะปัะฝัะผะธ ะทะฐะฝััะธัะผะธ
- ะะฐััะตั ะทะฐัะฐะฑะพัะฝะพะน ะฟะปะฐัั ะฟัะตะฟะพะดะฐะฒะฐัะตะปะตะน
- ะะฝะฐะปะธัะธะบะฐ ะธ ะพััะตัะฝะพััั

### 1.2. ะัะฝะพะฒะฝัะต ะฒะพะทะผะพะถะฝะพััะธ

**ะะปั ะฐะดะผะธะฝะธัััะฐัะพัะพะฒ:**
- ะกะพะทะดะฐะฝะธะต ะธ ัะฟัะฐะฒะปะตะฝะธะต ะฝะฐะฟัะฐะฒะปะตะฝะธัะผะธ, ัััะดะธัะผะธ, ะณััะฟะฟะฐะผะธ
- ะะฐัััะพะนะบะฐ ะปะธะผะธัะพะฒ ััะฐััะฝะธะบะพะฒ ะธ ััะพะธะผะพััะธ
- ะะฐะทะฝะฐัะตะฝะธะต ะฟัะตะฟะพะดะฐะฒะฐัะตะปะตะน
- ะัะพัะผะพัั ะฐะฝะฐะปะธัะธะบะธ ะธ ะพััะตัะพะฒ

**ะะปั ะผะตะฝะตะดะถะตัะพะฒ:**
- ะะฐะฟะธัั ะบะปะธะตะฝัะพะฒ ะฒ ะณััะฟะฟั
- ะฃะฟัะฐะฒะปะตะฝะธะต ัะฟะธัะบะฐะผะธ ััะฐััะฝะธะบะพะฒ
- ะะตะดะตะฝะธะต ะปะธััะฐ ะพะถะธะดะฐะฝะธั
- ะะตัะตะฒะพะด ััะฐััะฝะธะบะพะฒ ะผะตะถะดั ะณััะฟะฟะฐะผะธ

**ะะปั ะฟัะตะฟะพะดะฐะฒะฐัะตะปะตะน:**
- ะัะผะตัะบะฐ ะฟะพัะตัะฐะตะผะพััะธ
- ะัะพัะผะพัั ัะฟะธัะบะพะฒ ัะฒะพะธั ะณััะฟะฟ
- ะะฝะตัะตะฝะธะต ะบะพะผะผะตะฝัะฐัะธะตะฒ ะฟะพ ะทะฐะฝััะธัะผ

### 1.3. ะะปััะตะฒัะต ะบะพะฝัะตะฟัะธะธ

#### ะะตัะฐััะธั
```
ะะฐะฟัะฐะฒะปะตะฝะธะต (Category)
  โโ ะกััะดะธั (Studio)
      โโ ะััะฟะฟะฐ (Group)
          โโ ะฃัะฐััะฝะธะบ ะณััะฟะฟั (GroupMember)
```

#### ะขะธะฟั ะทะฐะฝััะธะน
- **ะััะฟะฟะพะฒัะต ะทะฐะฝััะธั** โ ัะตะณัะปััะฝัะต ะทะฐะฝััะธั ะฟะพ ัะฐัะฟะธัะฐะฝะธั
- **ะะฝะดะธะฒะธะดัะฐะปัะฝัะต ะทะฐะฝััะธั** โ ะฟะตััะพะฝะฐะปัะฝัะต ะทะฐะฝััะธั ั ะฟัะตะฟะพะดะฐะฒะฐัะตะปะตะผ (ะพัะดะตะปัะฝะฐั ัััะฝะพััั)
- **ะัะพะฑะฝัะต ะทะฐะฝััะธั** โ ัะฐะทะพะฒัะต ะฟะพัะตัะตะฝะธั ะดะปั ะฝะพะฒัั ะบะปะธะตะฝัะพะฒ

#### ะขะธะฟั ะทะฐะฟะธัะธ ะฒ ะณััะฟะฟั
- **ะะพััะพัะฝะฝะฐั ะทะฐะฟะธัั** โ ะบะปะธะตะฝั ัะฒะปัะตััั ััะฐััะฝะธะบะพะผ ะณััะฟะฟั ะฝะฐ ะฟะพััะพัะฝะฝะพะน ะพัะฝะพะฒะต
- **ะะฐะทะพะฒะฐั ะทะฐะฟะธัั** โ ะบะปะธะตะฝั ะทะฐะฟะธััะฒะฐะตััั ะฝะฐ ะบะพะฝะบัะตัะฝะพะต ะทะฐะฝััะธะต

---

## 2. ะกัััะบัััั ะดะฐะฝะฝัั

### 2.1. Category (ะะฐะฟัะฐะฒะปะตะฝะธะต)

ะะตััะฝะธะน ััะพะฒะตะฝั ะณััะฟะฟะธัะพะฒะบะธ ัััะดะธะน (ะฝะฐะฟัะธะผะตั: ะกะฟะพัั, ะัะบััััะฒะพ, ะะฑัะฐะทะพะฒะฐะฝะธะต).

```prisma
model Category {
  id          String    @id @default(uuid())
  name        String    @db.VarChar(100)
  description String?   @db.Text
  color       String?   @db.VarChar(7)  // HEX color, ะฝะฐะฟัะธะผะตั #FF5733
  status      CategoryStatus @default(ACTIVE)

  studios     Studio[]

  createdAt   DateTime  @default(now()) @map("created_at")
  updatedAt   DateTime  @updatedAt @map("updated_at")

  @@map("categories")
}

enum CategoryStatus {
  ACTIVE
  CLOSED
}
```

**ะะพะปั:**
- `id` โ UUID, ะฟะตัะฒะธัะฝัะน ะบะปัั
- `name` โ ะะฐะทะฒะฐะฝะธะต ะฝะฐะฟัะฐะฒะปะตะฝะธั (ะพะฑัะทะฐัะตะปัะฝะพะต, ะดะพ 100 ัะธะผะฒะพะปะพะฒ)
- `description` โ ะะฟะธัะฐะฝะธะต ะฝะฐะฟัะฐะฒะปะตะฝะธั (ะพะฟัะธะพะฝะฐะปัะฝะพ)
- `color` โ ะฆะฒะตัะพะฒะฐั ะผะตัะบะฐ ะฒ HEX ัะพัะผะฐัะต (ะพะฟัะธะพะฝะฐะปัะฝะพ)
- `status` โ ะกัะฐััั ะฝะฐะฟัะฐะฒะปะตะฝะธั (ACTIVE / CLOSED)

---

### 2.2. Studio (ะกััะดะธั)

ะกััะดะธั ะธะปะธ ัะตะบัะธั ะฒ ัะฐะผะบะฐั ะฝะฐะฟัะฐะฒะปะตะฝะธั (ะฝะฐะฟัะธะผะตั: ะขะฐะฝัั, ะะพะบะฐะป, ะจะฐัะผะฐัั).

```prisma
model Studio {
  id          String    @id @default(uuid())
  categoryId  String    @map("category_id")
  name        String    @db.VarChar(100)
  description String?   @db.Text
  color       String?   @db.VarChar(7)  // HEX color ะดะปั ัะฐัะฟะธัะฐะฝะธั
  isFree      Boolean   @default(false) @map("is_free")  // ะะตัะฟะปะฐัะฝะฐั ัััะดะธั
  status      StudioStatus @default(ACTIVE)

  // ะกะฒัะทะธ
  category          Category          @relation(fields: [categoryId], references: [id], onDelete: Cascade)
  teachers          StudioTeacher[]
  groups            Group[]
  individualLessons IndividualLesson[]  // ะะฑัะฐัะฝะฐั ัะฒัะทั ั ะธะฝะดะธะฒะธะดัะฐะปัะฝัะผะธ ะทะฐะฝััะธัะผะธ

  createdAt   DateTime  @default(now()) @map("created_at")
  updatedAt   DateTime  @updatedAt @map("updated_at")

  @@map("studios")
  @@index([categoryId])
}

enum StudioStatus {
  ACTIVE
  CLOSED
}
```

**ะะพะปั:**
- `id` โ UUID, ะฟะตัะฒะธัะฝัะน ะบะปัั
- `categoryId` โ ID ัะพะดะธัะตะปััะบะพะณะพ ะฝะฐะฟัะฐะฒะปะตะฝะธั
- `name` โ ะะฐะทะฒะฐะฝะธะต ัััะดะธะธ (ะพะฑัะทะฐัะตะปัะฝะพะต, ะดะพ 100 ัะธะผะฒะพะปะพะฒ)
- `description` โ ะะฟะธัะฐะฝะธะต ัััะดะธะธ (ะพะฟัะธะพะฝะฐะปัะฝะพ)
- `color` โ ะฆะฒะตัะพะฒะฐั ะผะตัะบะฐ ะดะปั ะพัะพะฑัะฐะถะตะฝะธั ะฒ ัะฐัะฟะธัะฐะฝะธะธ (ะพะฟัะธะพะฝะฐะปัะฝะพ)
- `isFree` โ ะคะปะฐะณ ะฑะตัะฟะปะฐัะฝะพะน ัััะดะธะธ (ะดะปั ะฑะตัะฟะปะฐัะฝัั ะฐะฑะพะฝะตะผะตะฝัะพะฒ)
- `status` โ ะกัะฐััั ัััะดะธะธ (ACTIVE / CLOSED)

---

### 2.3. StudioTeacher (ะัะตะฟะพะดะฐะฒะฐัะตะปะธ ัััะดะธะธ)

ะกะฒัะทั ะฟัะตะฟะพะดะฐะฒะฐัะตะปะตะน ัะพ ัััะดะธัะผะธ.

```prisma
model StudioTeacher {
  id                String   @id @default(uuid())
  studioId          String   @map("studio_id")
  teacherId         String   @map("teacher_id")
  salaryPercentage  Decimal  @default(50.00) @map("salary_percentage") @db.Decimal(5, 2)  // ะัะพัะตะฝั ะพั ะฒััััะบะธ

  // ะกะฒัะทะธ
  studio    Studio   @relation(fields: [studioId], references: [id], onDelete: Cascade)
  teacher   Teacher  @relation(fields: [teacherId], references: [id], onDelete: Cascade)

  createdAt DateTime @default(now()) @map("created_at")

  @@map("studio_teachers")
  @@unique([studioId, teacherId])
  @@index([studioId])
  @@index([teacherId])
}
```

**ะะพะปั:**
- `id` โ UUID, ะฟะตัะฒะธัะฝัะน ะบะปัั
- `studioId` โ ID ัััะดะธะธ
- `teacherId` โ ID ะฟัะตะฟะพะดะฐะฒะฐัะตะปั (ะธะท ัะฟัะฐะฒะพัะฝะธะบะฐ Teachers)
- `salaryPercentage` โ ะัะพัะตะฝั ะพั ะฒััััะบะธ ัััะดะธะธ ะดะปั ัะฐััะตัะฐ ะะ (ะฟะพ ัะผะพะปัะฐะฝะธั 50%)

---

### 2.4. Group (ะััะฟะฟะฐ)

ะััะฟะฟะฐ ะฒ ัะฐะผะบะฐั ัััะดะธะธ (ะฝะฐะฟัะธะผะตั: ะะฐัะธะฝะฐััะธะต 5-7 ะปะตั, ะัะพะดะฒะธะฝัััะต ะฒะทัะพัะปัะต).

```prisma
model Group {
  id              String    @id @default(uuid())
  studioId        String    @map("studio_id")
  name            String    @db.VarChar(100)
  level           String?   @db.VarChar(50)      // ะฃัะพะฒะตะฝั: ะะฐัะธะฝะฐััะธะต, ะัะพะดะฒะธะฝัััะต ะธ ั.ะด.
  ageCategory     String?   @map("age_category") @db.VarChar(50)  // 5-7 ะปะตั, 8-12 ะปะตั, ะฒะทัะพัะปัะต
  maxParticipants Int       @map("max_participants")
  singleVisitPrice Decimal? @map("single_visit_price") @db.Decimal(10, 2)  // ะกัะพะธะผะพััั ัะฐะทะพะฒะพะณะพ ะฟะพัะตัะตะฝะธั
  status          GroupStatus @default(ACTIVE)

  // ะกะฒัะทะธ
  studio          Studio    @relation(fields: [studioId], references: [id], onDelete: Cascade)
  members         GroupMember[]
  schedules       Schedule[]
  subscriptions   Subscription[]

  createdAt       DateTime  @default(now()) @map("created_at")
  updatedAt       DateTime  @updatedAt @map("updated_at")

  @@map("groups")
  @@index([studioId])
}

enum GroupStatus {
  ACTIVE
  CLOSED
}
```

**ะะพะปั:**
- `id` โ UUID, ะฟะตัะฒะธัะฝัะน ะบะปัั
- `studioId` โ ID ัะพะดะธัะตะปััะบะพะน ัััะดะธะธ
- `name` โ ะะฐะทะฒะฐะฝะธะต ะณััะฟะฟั (ะพะฑัะทะฐัะตะปัะฝะพะต, ะดะพ 100 ัะธะผะฒะพะปะพะฒ)
- `level` โ ะฃัะพะฒะตะฝั ะฟะพะดะณะพัะพะฒะบะธ (ะพะฟัะธะพะฝะฐะปัะฝะพ, ะดะพ 50 ัะธะผะฒะพะปะพะฒ)
- `ageCategory` โ ะะพะทัะฐััะฝะฐั ะบะฐัะตะณะพัะธั (ะพะฟัะธะพะฝะฐะปัะฝะพ, ะดะพ 50 ัะธะผะฒะพะปะพะฒ)
- `maxParticipants` โ ะะฐะบัะธะผะฐะปัะฝะพะต ะบะพะปะธัะตััะฒะพ ััะฐััะฝะธะบะพะฒ ะฒ ะณััะฟะฟะต (ะพะฑัะทะฐัะตะปัะฝะพะต)
- `singleVisitPrice` โ ะกัะพะธะผะพััั ัะฐะทะพะฒะพะณะพ ะฟะพัะตัะตะฝะธั (ะพะฟัะธะพะฝะฐะปัะฝะพ)
- `status` โ ะกัะฐััั ะณััะฟะฟั (ACTIVE / CLOSED)

---

### 2.5. GroupMember (ะฃัะฐััะฝะธะบ ะณััะฟะฟั)

ะกะฒัะทั ะบะปะธะตะฝัะพะฒ ั ะณััะฟะฟะฐะผะธ (ะฟะพััะพัะฝะฝะพะต ัะปะตะฝััะฒะพ).

```prisma
model GroupMember {
  id              String            @id @default(uuid())
  groupId         String            @map("group_id")
  clientId        String            @map("client_id")
  status          GroupMemberStatus @default(ACTIVE)
  joinedAt        DateTime          @default(now()) @map("joined_at")
  leftAt          DateTime?         @map("left_at")
  waitlistPosition Int?             @map("waitlist_position")  // ะะพะทะธัะธั ะฒ ะปะธััะต ะพะถะธะดะฐะฝะธั
  notes           String?           @db.Text

  // ะกะฒัะทะธ
  group           Group             @relation(fields: [groupId], references: [id], onDelete: Cascade)
  client          Client            @relation(fields: [clientId], references: [id], onDelete: Cascade)

  createdAt       DateTime          @default(now()) @map("created_at")
  updatedAt       DateTime          @updatedAt @map("updated_at")

  @@map("group_members")
  @@unique([groupId, clientId])
  @@index([groupId])
  @@index([clientId])
  @@index([status])
}

enum GroupMemberStatus {
  ACTIVE        // ะะบัะธะฒะฝัะน ััะฐััะฝะธะบ
  EXPELLED      // ะััะธัะปะตะฝ
  WAITLIST      // ะ ะปะธััะต ะพะถะธะดะฐะฝะธั
}
```

**ะะพะปั:**
- `id` โ UUID, ะฟะตัะฒะธัะฝัะน ะบะปัั
- `groupId` โ ID ะณััะฟะฟั
- `clientId` โ ID ะบะปะธะตะฝัะฐ
- `status` โ ะกัะฐััั ััะฐััะฝะธะบะฐ (ACTIVE / EXPELLED / WAITLIST)
- `joinedAt` โ ะะฐัะฐ ะทะฐะฟะธัะธ ะฒ ะณััะฟะฟั
- `leftAt` โ ะะฐัะฐ ะพััะธัะปะตะฝะธั (ะตัะปะธ ะพััะธัะปะตะฝ)
- `waitlistPosition` โ ะะพะทะธัะธั ะฒ ะพัะตัะตะดะธ ะพะถะธะดะฐะฝะธั (ะตัะปะธ status = WAITLIST)
- `notes` โ ะัะธะผะตัะฐะฝะธั

---

### 2.6. Attendance (ะะพัะตัะฐะตะผะพััั)

ะััะฝะฐะป ะฟะพัะตัะฐะตะผะพััะธ ะณััะฟะฟะพะฒัั ะทะฐะฝััะธะน.

```prisma
model Attendance {
  id          String          @id @default(uuid())
  scheduleId  String          @map("schedule_id")
  clientId    String          @map("client_id")
  status      AttendanceStatus @default(SCHEDULED)
  markedBy    String?         @map("marked_by")  // ID ะฟะพะปัะทะพะฒะฐัะตะปั, ะพัะผะตัะธะฒัะตะณะพ ะฟะพัะตัะตะฝะธะต
  markedAt    DateTime?       @map("marked_at")
  notes       String?         @db.Text

  // ะกะฒัะทะธ
  schedule      Schedule        @relation(fields: [scheduleId], references: [id], onDelete: Cascade)
  client        Client          @relation(fields: [clientId], references: [id], onDelete: Cascade)
  marker        User?           @relation(fields: [markedBy], references: [id], onDelete: SetNull)
  compensation  Compensation?   // ะะฑัะฐัะฝะฐั ัะฒัะทั ั ะบะพะผะฟะตะฝัะฐัะธะตะน ะทะฐ ะฟัะพะฟััะบ

  createdAt   DateTime        @default(now()) @map("created_at")
  updatedAt   DateTime        @updatedAt @map("updated_at")

  @@map("attendances")
  @@unique([scheduleId, clientId])
  @@index([scheduleId])
  @@index([clientId])
  @@index([status])
}

enum AttendanceStatus {
  SCHEDULED       // ะะฐะฟะปะฐะฝะธัะพะฒะฐะฝะพ (ะฐะฒัะพ-ัะพะทะดะฐะฝะพ ะดะปั ะฟะพััะพัะฝะฝัั ััะฐััะฝะธะบะพะฒ)
  PRESENT         // ะัะธัััััะฒะพะฒะฐะป
  ABSENT          // ะััััััะฒะพะฒะฐะป
  SICK            // ะะพะปะตะป (ั ะบะพะผะฟะตะฝัะฐัะธะตะน)
  EXCUSED         // ะฃะฒะฐะถะธัะตะปัะฝะฐั ะฟัะธัะธะฝะฐ (ั ะบะพะผะฟะตะฝัะฐัะธะตะน)
}
```

**ะะพะปั:**
- `id` โ UUID, ะฟะตัะฒะธัะฝัะน ะบะปัั
- `scheduleId` โ ID ะทะฐะฝััะธั ะธะท ัะฐัะฟะธัะฐะฝะธั (ัะฒัะทั ั ะผะพะดัะปะตะผ ะะฐัะฟะธัะฐะฝะธั)
- `clientId` โ ID ะบะปะธะตะฝัะฐ
- `status` โ ะกัะฐััั ะฟะพัะตัะตะฝะธั (SCHEDULED / PRESENT / ABSENT / SICK / EXCUSED)
- `markedBy` โ ID ะฟะพะปัะทะพะฒะฐัะตะปั, ะพัะผะตัะธะฒัะตะณะพ ะฟะพัะตัะตะฝะธะต (ะฟัะตะฟะพะดะฐะฒะฐัะตะปั ะธะปะธ ะผะตะฝะตะดะถะตั)
- `markedAt` โ ะะฐัะฐ ะธ ะฒัะตะผั ะพัะผะตัะบะธ
- `notes` โ ะัะธะผะตัะฐะฝะธั (ะพะฟัะธะพะฝะฐะปัะฝะพ)

---

### 2.7. IndividualLesson (ะะฝะดะธะฒะธะดัะฐะปัะฝะพะต ะทะฐะฝััะธะต)

**ะะฐะทะฝะฐัะตะฝะธะต:** ะะฐะทะพะฒัะต ะฟะปะฐัะฝัะต ะธะฝะดะธะฒะธะดัะฐะปัะฝัะต ะทะฐะฝััะธั ะะะ ัะธััะตะผั ะฐะฑะพะฝะตะผะตะฝัะพะฒ.

**ะะฐะถะฝะพ:** ะะปั ัะตะณัะปััะฝัั ะธะฝะดะธะฒะธะดัะฐะปัะฝัั ะทะฐะฝััะธะน ะฒ ัะฐะผะบะฐั ะฐะฑะพะฝะตะผะตะฝัะพะฒ ะธัะฟะพะปัะทัะตััั
ัะฐะฑะปะธัะฐ `schedules` (ัะผ. ะะพะดัะปั ะะฐัะฟะธัะฐะฝะธั) ั ะฟะพะปะตะผ `type='individual'`.
ะะพะดะตะปั `IndividualLesson` ะธัะฟะพะปัะทัะตััั ัะพะปัะบะพ ะดะปั ะฟะปะฐัะฝัั ัะฐะทะพะฒัั ะทะฐะฝััะธะน, ะบะพัะพััะต
ะพะฟะปะฐัะธะฒะฐัััั ะพัะดะตะปัะฝะพ ะทะฐ ะบะฐะถะดะพะต ะทะฐะฝััะธะต, ะฐ ะฝะต ะฟะพ ะฐะฑะพะฝะตะผะตะฝัั.

```prisma
model IndividualLesson {
  id              String              @id @default(uuid())
  studioId        String              @map("studio_id")
  clientId        String              @map("client_id")
  teacherId       String              @map("teacher_id")
  roomId          String              @map("room_id")
  date            DateTime            @db.Date
  startTime       DateTime            @map("start_time") @db.Time
  endTime         DateTime            @map("end_time") @db.Time
  price           Decimal             @db.Decimal(10, 2)
  status          IndividualLessonStatus @default(SCHEDULED)
  notes           String?             @db.Text

  // ะกะฒัะทะธ
  studio          Studio              @relation(fields: [studioId], references: [id], onDelete: Restrict)
  client          Client              @relation(fields: [clientId], references: [id], onDelete: Cascade)
  teacher         Teacher             @relation(fields: [teacherId], references: [id], onDelete: Restrict)
  room            Room                @relation(fields: [roomId], references: [id], onDelete: Restrict)

  createdAt       DateTime            @default(now()) @map("created_at")
  updatedAt       DateTime            @updatedAt @map("updated_at")

  @@map("individual_lessons")
  @@index([studioId])
  @@index([clientId])
  @@index([teacherId])
  @@index([date])
}

enum IndividualLessonStatus {
  SCHEDULED     // ะะฐะฟะปะฐะฝะธัะพะฒะฐะฝะพ
  COMPLETED     // ะัะพะฒะตะดะตะฝะพ
  CANCELLED     // ะัะผะตะฝะตะฝะพ
  NO_SHOW       // ะะต ัะฒะธะปัั
}
```

**ะะพะปั:**
- `id` โ UUID, ะฟะตัะฒะธัะฝัะน ะบะปัั
- `studioId` โ ID ัััะดะธะธ
- `clientId` โ ID ะบะปะธะตะฝัะฐ
- `teacherId` โ ID ะฟัะตะฟะพะดะฐะฒะฐัะตะปั
- `roomId` โ ID ะฟะพะผะตัะตะฝะธั
- `date` โ ะะฐัะฐ ะทะฐะฝััะธั
- `startTime` โ ะัะตะผั ะฝะฐัะฐะปะฐ
- `endTime` โ ะัะตะผั ะพะบะพะฝัะฐะฝะธั
- `price` โ ะกัะพะธะผะพััั ะทะฐะฝััะธั
- `status` โ ะกัะฐััั ะทะฐะฝััะธั (SCHEDULED / COMPLETED / CANCELLED / NO_SHOW)
- `notes` โ ะัะธะผะตัะฐะฝะธั

---

## 3. ะะธะทะฝะตั-ะฟัะพัะตััั

### 3.1. ะกะพะทะดะฐะฝะธะต ะฝะฐะฟัะฐะฒะปะตะฝะธั

**ะฃัะฐััะฝะธะบะธ:** ะะดะผะธะฝะธัััะฐัะพั

**ะัะพัะตัั:**
1. ะะดะผะธะฝะธัััะฐัะพั ะพัะบััะฒะฐะตั ัะพัะผั ัะพะทะดะฐะฝะธั ะฝะฐะฟัะฐะฒะปะตะฝะธั
2. ะะฒะพะดะธั ะพะฑัะทะฐัะตะปัะฝัะต ะดะฐะฝะฝัะต:
   - ะะฐะทะฒะฐะฝะธะต ะฝะฐะฟัะฐะฒะปะตะฝะธั
3. ะะฟัะธะพะฝะฐะปัะฝะพ:
   - ะะฟะธัะฐะฝะธะต
   - ะฆะฒะตัะพะฒะฐั ะผะตัะบะฐ
4. ะกะธััะตะผะฐ ะฒะฐะปะธะดะธััะตั ะดะฐะฝะฝัะต
5. ะกะธััะตะผะฐ ัะพะทะดะฐะตั ะฝะฐะฟัะฐะฒะปะตะฝะธะต ัะพ ััะฐัััะพะผ ACTIVE
6. ะกะธััะตะผะฐ ะฒะพะทะฒัะฐัะฐะตั ะดะฐะฝะฝัะต ัะพะทะดะฐะฝะฝะพะณะพ ะฝะฐะฟัะฐะฒะปะตะฝะธั

**ะะตะทัะปััะฐั:** ะะพะฒะพะต ะฝะฐะฟัะฐะฒะปะตะฝะธะต ัะพะทะดะฐะฝะพ ะธ ะดะพัััะฟะฝะพ ะดะปั ะดะพะฑะฐะฒะปะตะฝะธั ัััะดะธะน

---

### 3.2. ะกะพะทะดะฐะฝะธะต ัััะดะธะธ

**ะฃัะฐััะฝะธะบะธ:** ะะดะผะธะฝะธัััะฐัะพั

**ะัะพัะตัั:**
1. ะะดะผะธะฝะธัััะฐัะพั ะฒัะฑะธัะฐะตั ะฝะฐะฟัะฐะฒะปะตะฝะธะต
2. ะัะบััะฒะฐะตั ัะพัะผั ัะพะทะดะฐะฝะธั ัััะดะธะธ
3. ะะฒะพะดะธั ะพะฑัะทะฐัะตะปัะฝัะต ะดะฐะฝะฝัะต:
   - ะะฐะทะฒะฐะฝะธะต ัััะดะธะธ
   - ะะฐะฟัะฐะฒะปะตะฝะธะต (ัะพะดะธัะตะปั)
4. ะะฟัะธะพะฝะฐะปัะฝะพ:
   - ะะฟะธัะฐะฝะธะต
   - ะฆะฒะตัะพะฒะฐั ะผะตัะบะฐ ะดะปั ัะฐัะฟะธัะฐะฝะธั
   - ะคะปะฐะณ "ะะตัะฟะปะฐัะฝะฐั ัััะดะธั"
5. ะกะธััะตะผะฐ ะฒะฐะปะธะดะธััะตั ะดะฐะฝะฝัะต
6. ะกะธััะตะผะฐ ัะพะทะดะฐะตั ัััะดะธั ัะพ ััะฐัััะพะผ ACTIVE
7. ะะดะผะธะฝะธัััะฐัะพั ะผะพะถะตั ะฝะฐะทะฝะฐัะธัั ะฟัะตะฟะพะดะฐะฒะฐัะตะปะตะน:
   - ะัะฑะธัะฐะตั ะฟัะตะฟะพะดะฐะฒะฐัะตะปะตะน ะธะท ัะฟัะฐะฒะพัะฝะธะบะฐ
   - ะฃะบะฐะทัะฒะฐะตั ะฟัะพัะตะฝั ะพั ะฒััััะบะธ ะดะปั ะบะฐะถะดะพะณะพ (ะฟะพ ัะผะพะปัะฐะฝะธั 50%)
8. ะกะธััะตะผะฐ ัะพััะฐะฝัะตั ัะฒัะทะธ ะฟัะตะฟะพะดะฐะฒะฐัะตะปะตะน

**ะะตะทัะปััะฐั:** ะะพะฒะฐั ัััะดะธั ัะพะทะดะฐะฝะฐ ะธ ะดะพัััะฟะฝะฐ ะดะปั ะดะพะฑะฐะฒะปะตะฝะธั ะณััะฟะฟ

---

### 3.3. ะกะพะทะดะฐะฝะธะต ะณััะฟะฟั

**ะฃัะฐััะฝะธะบะธ:** ะะดะผะธะฝะธัััะฐัะพั

**ะัะพัะตัั:**
1. ะะดะผะธะฝะธัััะฐัะพั ะฒัะฑะธัะฐะตั ัััะดะธั
2. ะัะบััะฒะฐะตั ัะพัะผั ัะพะทะดะฐะฝะธั ะณััะฟะฟั
3. ะะฒะพะดะธั ะพะฑัะทะฐัะตะปัะฝัะต ะดะฐะฝะฝัะต:
   - ะะฐะทะฒะฐะฝะธะต ะณััะฟะฟั
   - ะกััะดะธั (ัะพะดะธัะตะปั)
   - ะะฐะบัะธะผะฐะปัะฝะพะต ะบะพะปะธัะตััะฒะพ ััะฐััะฝะธะบะพะฒ
4. ะะฟัะธะพะฝะฐะปัะฝะพ:
   - ะฃัะพะฒะตะฝั (ะะฐัะธะฝะฐััะธะต, ะัะพะดะฒะธะฝัััะต ะธ ั.ะด.)
   - ะะพะทัะฐััะฝะฐั ะบะฐัะตะณะพัะธั (5-7 ะปะตั, 8-12 ะปะตั, ะฒะทัะพัะปัะต)
   - ะกัะพะธะผะพััั ัะฐะทะพะฒะพะณะพ ะฟะพัะตัะตะฝะธั
5. ะกะธััะตะผะฐ ะฒะฐะปะธะดะธััะตั ะดะฐะฝะฝัะต
6. ะกะธััะตะผะฐ ัะพะทะดะฐะตั ะณััะฟะฟั ัะพ ััะฐัััะพะผ ACTIVE
7. ะะดะผะธะฝะธัััะฐัะพั ะผะพะถะตั ัะพะทะดะฐัั ัะฐัะฟะธัะฐะฝะธะต ะทะฐะฝััะธะน (ัะผ. ะะพะดัะปั ะะฐัะฟะธัะฐะฝะธั)

**ะะตะทัะปััะฐั:** ะะพะฒะฐั ะณััะฟะฟะฐ ัะพะทะดะฐะฝะฐ ะธ ะดะพัััะฟะฝะฐ ะดะปั ะทะฐะฟะธัะธ ะบะปะธะตะฝัะพะฒ

---

### 3.4. ะะพััะพัะฝะฝะฐั ะทะฐะฟะธัั ะบะปะธะตะฝัะฐ ะฒ ะณััะฟะฟั

**ะฃัะฐััะฝะธะบะธ:** ะะตะฝะตะดะถะตั, ะะปะธะตะฝั

**ะกัะตะฝะฐัะธะน 1: ะััั ัะฒะพะฑะพะดะฝัะต ะผะตััะฐ**

1. ะะตะฝะตะดะถะตั ะฝะฐัะพะดะธั ะบะปะธะตะฝัะฐ ะฒ CRM
2. ะัะฑะธัะฐะตั ะณััะฟะฟั ะดะปั ะทะฐะฟะธัะธ
3. ะกะธััะตะผะฐ ะฟัะพะฒะตััะตั ะดะพัััะฟะฝะพััั ะผะตัั:
   ```typescript
   const activeMembers = await countActiveMembers(groupId);
   const maxParticipants = group.maxParticipants;

   if (activeMembers >= maxParticipants) {
     return { error: 'ะััะฟะฟะฐ ะทะฐะฟะพะปะฝะตะฝะฐ' };
   }
   ```
4. ะกะธััะตะผะฐ ัะพะทะดะฐะตั ะทะฐะฟะธัั GroupMember ัะพ ััะฐัััะพะผ ACTIVE
5. ะกะธััะตะผะฐ ะฟัะตะดะปะฐะณะฐะตั ะพัะพัะผะธัั ะฐะฑะพะฝะตะผะตะฝั (ะฟะตัะตัะพะด ะฒ ะผะพะดัะปั ะะฑะพะฝะตะผะตะฝัะพะฒ)
6. ะกะธััะตะผะฐ ะฐะฒัะพะผะฐัะธัะตัะบะธ ัะพะทะดะฐะตั ะทะฐะฟะธัะธ Attendance (status = SCHEDULED) ะดะปั ะฒัะตั ะฑัะดััะธั ะทะฐะฝััะธะน ะณััะฟะฟั
7. ะกะธััะตะผะฐ ะพัะฟัะฐะฒะปัะตั ัะฒะตะดะพะผะปะตะฝะธะต ะบะปะธะตะฝัั (email/SMS)

**ะกัะตะฝะฐัะธะน 2: ะะตั ัะฒะพะฑะพะดะฝัั ะผะตัั**

1. ะะตะฝะตะดะถะตั ะฝะฐัะพะดะธั ะบะปะธะตะฝัะฐ ะฒ CRM
2. ะัะฑะธัะฐะตั ะณััะฟะฟั ะดะปั ะทะฐะฟะธัะธ
3. ะกะธััะตะผะฐ ะพะฟัะตะดะตะปัะตั, ััะพ ะณััะฟะฟะฐ ะทะฐะฟะพะปะฝะตะฝะฐ
4. ะะตะฝะตะดะถะตั ะฟัะตะดะปะฐะณะฐะตั ะบะปะธะตะฝัั ะดะพะฑะฐะฒะธัั ะฒ ะปะธัั ะพะถะธะดะฐะฝะธั
5. ะัะปะธ ะบะปะธะตะฝั ัะพะณะปะฐัะตะฝ:
   - ะกะธััะตะผะฐ ัะพะทะดะฐะตั GroupMember ัะพ ััะฐัััะพะผ WAITLIST
   - ะกะธััะตะผะฐ ะพะฟัะตะดะตะปัะตั ะฟะพะทะธัะธั ะฒ ะพัะตัะตะดะธ (FIFO):
     ```typescript
     const maxPosition = await getMaxWaitlistPosition(groupId);
     const newPosition = (maxPosition || 0) + 1;
     ```
   - ะกะธััะตะผะฐ ะพัะฟัะฐะฒะปัะตั ัะฒะตะดะพะผะปะตะฝะธะต ะบะปะธะตะฝัั ะพ ะฟะพััะฐะฝะพะฒะบะต ะฒ ะปะธัั ะพะถะธะดะฐะฝะธั

**ะะตะทัะปััะฐั:** ะะปะธะตะฝั ะทะฐะฟะธัะฐะฝ ะฒ ะณััะฟะฟั ะบะฐะบ ะฟะพััะพัะฝะฝัะน ััะฐััะฝะธะบ ะธะปะธ ะดะพะฑะฐะฒะปะตะฝ ะฒ ะปะธัั ะพะถะธะดะฐะฝะธั

---

### 3.5. ะะฐะทะพะฒะฐั ะทะฐะฟะธัั ะฝะฐ ะทะฐะฝััะธะต

**ะฃัะฐััะฝะธะบะธ:** ะะตะฝะตะดะถะตั, ะะปะธะตะฝั

**ะัะพัะตัั:**
1. ะะตะฝะตะดะถะตั ะฝะฐัะพะดะธั ะบะปะธะตะฝัะฐ ะฒ CRM
2. ะัะฑะธัะฐะตั ะบะพะฝะบัะตัะฝะพะต ะทะฐะฝััะธะต ะธะท ัะฐัะฟะธัะฐะฝะธั
3. ะกะธััะตะผะฐ ะฟัะพะฒะตััะตั ะดะพัััะฟะฝะพััั:
   - ะััั ะปะธ ัะฒะพะฑะพะดะฝัะต ะผะตััะฐ ะฝะฐ ะทะฐะฝััะธะธ
   - ะะต ะทะฐะบะพะฝัะธะปะพัั ะปะธ ะฒัะตะผั ะดะปั ะทะฐะฟะธัะธ (ะฝะฐะฟัะธะผะตั, ะทะฐ 1 ัะฐั ะดะพ ะฝะฐัะฐะปะฐ)
4. ะกะธััะตะผะฐ ัะพะทะดะฐะตั ะทะฐะฟะธัั Attendance ัะพ ััะฐัััะพะผ SCHEDULED
5. ะกะธััะตะผะฐ ัะธะบัะธััะตั ะพะฟะปะฐัั:
   - ะะฐะทะพะฒะพะต ะฟะพัะตัะตะฝะธะต (ะธัะฟะพะปัะทัะตััั singleVisitPrice ะธะท Group)
   - ะะปะธ ัะฟะธััะฒะฐะตั ั ะฐะฑะพะฝะตะผะตะฝัะฐ ะบะปะธะตะฝัะฐ (ัะผ. ะะพะดัะปั ะะฑะพะฝะตะผะตะฝัะพะฒ)
6. ะกะธััะตะผะฐ ะพัะฟัะฐะฒะปัะตั ะฟะพะดัะฒะตัะถะดะตะฝะธะต ะบะปะธะตะฝัั

**ะะตะทัะปััะฐั:** ะะปะธะตะฝั ะทะฐะฟะธัะฐะฝ ะฝะฐ ัะฐะทะพะฒะพะต ะทะฐะฝััะธะต

---

### 3.6. ะัะผะตัะบะฐ ะฟะพัะตัะฐะตะผะพััะธ (ะบะพะผะฑะธะฝะธัะพะฒะฐะฝะฝัะน ะฟะพะดัะพะด)

**ะฃัะฐััะฝะธะบะธ:** ะัะตะฟะพะดะฐะฒะฐัะตะปั, ะะตะฝะตะดะถะตั

**ะัะพัะตัั:**

**ะญัะฐะฟ 1: ะะฒัะพ-ัะพัะผะธัะพะฒะฐะฝะธะต ัะฟะธัะบะฐ (ะดะพ ะทะฐะฝััะธั)**

1. ะกะธััะตะผะฐ ะฐะฒัะพะผะฐัะธัะตัะบะธ ัะพะทะดะฐะตั ะทะฐะฟะธัะธ Attendance ะดะปั ะฒัะตั ะฟะพััะพัะฝะฝัั ััะฐััะฝะธะบะพะฒ ะณััะฟะฟั (GroupMember ัะพ ััะฐัััะพะผ ACTIVE)
2. ะะพะฑะฐะฒะปัะตั ัะฐะทะพะฒัะต ะทะฐะฟะธัะธ (ะตัะปะธ ะตััั)
3. ะัะต ะทะฐะฟะธัะธ ะธะผะตัั ััะฐััั SCHEDULED

**ะญัะฐะฟ 2: ะัะผะตัะบะฐ ะฟัะตะฟะพะดะฐะฒะฐัะตะปะตะผ (ะฒะพ ะฒัะตะผั ะธะปะธ ะฟะพัะปะต ะทะฐะฝััะธั)**

1. ะัะตะฟะพะดะฐะฒะฐัะตะปั ะพัะบััะฒะฐะตั ะถััะฝะฐะป ะฟะพัะตัะฐะตะผะพััะธ ะดะปั ะทะฐะฝััะธั
2. ะะธะดะธั ะฟัะตะดะฒะฐัะธัะตะปัะฝัะน ัะฟะธัะพะบ ััะฐััะฝะธะบะพะฒ
3. ะัะผะตัะฐะตั ะบะฐะถะดะพะณะพ ััะฐััะฝะธะบะฐ:
   - โ PRESENT โ ะัะธัััััะฒะพะฒะฐะป
   - โ ABSENT โ ะััััััะฒะพะฒะฐะป
   - ๐ค SICK โ ะะพะปะตะป (ั ะบะพะผะฟะตะฝัะฐัะธะตะน)
   - ๐ EXCUSED โ ะฃะฒะฐะถะธัะตะปัะฝะฐั ะฟัะธัะธะฝะฐ (ั ะบะพะผะฟะตะฝัะฐัะธะตะน)
4. ะะพะถะตั ะดะพะฑะฐะฒะธัั ะฟัะธะผะตัะฐะฝะธั
5. ะกะธััะตะผะฐ ัะพััะฐะฝัะตั ะพัะผะตัะบะธ:
   ```typescript
   await updateAttendance(attendanceId, {
     status: 'PRESENT',
     markedBy: teacherId,
     markedAt: new Date(),
     notes: 'ะัะปะธัะฝะพะต ะฒััััะฟะปะตะฝะธะต',
   });
   ```

**ะญัะฐะฟ 3: ะะฑัะฐะฑะพัะบะฐ ะฟัะพะฟััะบะพะฒ**

- **ABSENT** โ ะทะฐะฝััะธะต ัะฟะธััะฒะฐะตััั ั ะฐะฑะพะฝะตะผะตะฝัะฐ, ััะธััะฒะฐะตััั ะฒ ััะฐัะธััะธะบะต
- **SICK / EXCUSED** โ ะทะฐะฝััะธะต ัะฟะธััะฒะฐะตััั, ะฝะพ ััะพะธะผะพััั ะบะพะผะฟะตะฝัะธััะตััั:
  - ะกะธััะตะผะฐ ะฒััะธัะปัะตั ััะพะธะผะพััั ะฟัะพะฟััะตะฝะฝะพะณะพ ะทะฐะฝััะธั
  - ะัะธ ะฟัะพะดะปะตะฝะธะธ ะฐะฑะพะฝะตะผะตะฝัะฐ ะฝะฐ ัะปะตะดัััะธะน ะผะตััั ััะพะธะผะพััั ัะผะตะฝััะฐะตััั ะฝะฐ ััะผะผั ะบะพะผะฟะตะฝัะฐัะธะธ

**ะะตะทัะปััะฐั:** ะะพัะตัะฐะตะผะพััั ะพัะผะตัะตะฝะฐ, ะดะฐะฝะฝัะต ัะพััะฐะฝะตะฝั ะดะปั ะพััะตัะฝะพััะธ ะธ ัะฐััะตัะฐ ะะ

---

### 3.7. ะะฐะฑะพัะฐ ั ะปะธััะพะผ ะพะถะธะดะฐะฝะธั

**ะฃัะฐััะฝะธะบะธ:** ะกะธััะตะผะฐ, ะะตะฝะตะดะถะตั, ะะปะธะตะฝั

**ะัะพัะตัั:**

**ะกัะตะฝะฐัะธะน 1: ะัะฒะพะฑะพะถะดะตะฝะธะต ะผะตััะฐ ะฒ ะณััะฟะฟะต**

1. ะะปะธะตะฝั ะพััะธัะปะตะฝ ะธะท ะณััะฟะฟั (ัะผ. ะฟ. 3.8)
2. ะกะธััะตะผะฐ ะพะฟัะตะดะตะปัะตั ะบะพะปะธัะตััะฒะพ ะฐะบัะธะฒะฝัั ััะฐััะฝะธะบะพะฒ:
   ```typescript
   const activeCount = await countActiveMembers(groupId);
   const maxParticipants = group.maxParticipants;

   if (activeCount < maxParticipants) {
     // ะััั ัะฒะพะฑะพะดะฝะพะต ะผะตััะพ
     await notifyWaitlist(groupId);
   }
   ```
3. ะกะธััะตะผะฐ ะฝะฐัะพะดะธั ะฟะตัะฒะพะณะพ ะบะปะธะตะฝัะฐ ะฒ ะปะธััะต ะพะถะธะดะฐะฝะธั (FIFO):
   ```typescript
   const firstInWaitlist = await getFirstWaitlistMember(groupId);
   ```
4. ะกะธััะตะผะฐ ะพัะฟัะฐะฒะปัะตั ะฐะฒัะพัะฒะตะดะพะผะปะตะฝะธะต ะบะปะธะตะฝัั:
   - Email ั ะธะฝัะพัะผะฐัะธะตะน ะพ ัะฒะพะฑะพะดะฝะพะผ ะผะตััะต
   - SMS-ัะฒะตะดะพะผะปะตะฝะธะต (ะพะฟัะธะพะฝะฐะปัะฝะพ)
5. ะะตะฝะตะดะถะตั ัะฒัะทัะฒะฐะตััั ั ะบะปะธะตะฝัะพะผ ะดะปั ะฟะพะดัะฒะตัะถะดะตะฝะธั
6. ะัะปะธ ะบะปะธะตะฝั ะฟะพะดัะฒะตัะถะดะฐะตั:
   - ะกะธััะตะผะฐ ะผะตะฝัะตั ััะฐััั GroupMember ั WAITLIST ะฝะฐ ACTIVE
   - ะะฑะฝัะปัะตั waitlistPosition
   - ะกะธััะตะผะฐ ะฟะตัะตะฝัะผะตัะพะฒัะฒะฐะตั ะพััะฐะฒัะธััั ะฒ ะปะธััะต ะพะถะธะดะฐะฝะธั
7. ะัะปะธ ะบะปะธะตะฝั ะพัะบะฐะทัะฒะฐะตััั:
   - ะกะธััะตะผะฐ ะฟะตัะตะฒะพะดะธั ัะปะตะดัััะตะณะพ ะฒ ะพัะตัะตะดะธ

**ะกัะตะฝะฐัะธะน 2: ะััะฝะพะต ัะฟัะฐะฒะปะตะฝะธะต ะปะธััะพะผ ะพะถะธะดะฐะฝะธั**

1. ะะตะฝะตะดะถะตั ะพัะบััะฒะฐะตั ัะฟะธัะพะบ ะณััะฟะฟั
2. ะะธะดะธั ัะฐะทะดะตะป "ะะธัั ะพะถะธะดะฐะฝะธั" ั ะฟะพะทะธัะธัะผะธ
3. ะะพะถะตั ะฒัััะฝัั:
   - ะะตัะตะฒะตััะธ ะบะปะธะตะฝัะฐ ั ะปะธััะฐ ะพะถะธะดะฐะฝะธั ะฒ ะฐะบัะธะฒะฝัะต
   - ะะทะผะตะฝะธัั ะฟะพััะดะพะบ ะฒ ะปะธััะต ะพะถะธะดะฐะฝะธั
   - ะฃะดะฐะปะธัั ะบะปะธะตะฝัะฐ ะธะท ะปะธััะฐ ะพะถะธะดะฐะฝะธั

**ะะตะทัะปััะฐั:** ะะตััะฐ ะฒ ะณััะฟะฟะต ัะฐัะฟัะตะดะตะปะตะฝั ัะฟัะฐะฒะตะดะปะธะฒะพ, ะบะปะธะตะฝัั ัะฒะตะดะพะผะปะตะฝั

---

### 3.8. ะััะธัะปะตะฝะธะต ััะฐััะฝะธะบะฐ ะธะท ะณััะฟะฟั

**ะฃัะฐััะฝะธะบะธ:** ะะตะฝะตะดะถะตั, ะกะธััะตะผะฐ

**ะกัะตะฝะฐัะธะน 1: ะััะฝะพะต ะพััะธัะปะตะฝะธะต ะผะตะฝะตะดะถะตัะพะผ**

1. ะะตะฝะตะดะถะตั ะพัะบััะฒะฐะตั ะบะฐััะพัะบั ััะฐััะฝะธะบะฐ ะณััะฟะฟั
2. ะะฐะถะธะผะฐะตั "ะััะธัะปะธัั ะธะท ะณััะฟะฟั"
3. ะกะธััะตะผะฐ ะทะฐะฟัะฐัะธะฒะฐะตั ะฟะพะดัะฒะตัะถะดะตะฝะธะต ะธ ะฟัะธัะธะฝั
4. ะะตะฝะตะดะถะตั ะฟะพะดัะฒะตัะถะดะฐะตั
5. ะกะธััะตะผะฐ ะพะฑะฝะพะฒะปัะตั ะทะฐะฟะธัั GroupMember:
   ```typescript
   await updateGroupMember(memberId, {
     status: 'EXPELLED',
     leftAt: new Date(),
     notes: 'ะะพ ะถะตะปะฐะฝะธั ะบะปะธะตะฝัะฐ',
   });
   ```
6. ะกะธััะตะผะฐ ะพัะผะตะฝัะตั ะฒัะต ะฑัะดััะธะต ะทะฐะฟะธัะธ Attendance ะดะปั ััะพะณะพ ะบะปะธะตะฝัะฐ
7. ะกะธััะตะผะฐ ะฟัะพะฒะตััะตั ะฐะฑะพะฝะตะผะตะฝั:
   - ะัะปะธ ะฐะฑะพะฝะตะผะตะฝั ะฐะบัะธะฒะตะฝ, ะฟัะธะพััะฐะฝะฐะฒะปะธะฒะฐะตั ะตะณะพ ะธะปะธ ะฒะพะทะฒัะฐัะฐะตั ะพััะฐัะพะบ (ัะผ. ะะพะดัะปั ะะฑะพะฝะตะผะตะฝัะพะฒ)
8. ะกะธััะตะผะฐ ะทะฐะฟััะบะฐะตั ะฟัะพัะตัั ัะฐะฑะพัั ั ะปะธััะพะผ ะพะถะธะดะฐะฝะธั (ัะผ. ะฟ. 3.7)
9. ะกะธััะตะผะฐ ะพัะฟัะฐะฒะปัะตั ัะฒะตะดะพะผะปะตะฝะธะต ะบะปะธะตะฝัั

**ะกัะตะฝะฐัะธะน 2: ะะฒัะพะผะฐัะธัะตัะบะพะต ะพััะธัะปะตะฝะธะต ะทะฐ ะฝะตัะฟะปะฐัั**

1. ะกะธััะตะผะฐ ะตะถะตะดะฝะตะฒะฝะพ ะฟัะพะฒะตััะตั ะฟัะพััะพัะตะฝะฝัะต ััะตัะฐ:
   ```typescript
   const overdueSubscriptions = await findOverdueSubscriptions({
     daysOverdue: 14,
     status: 'EXPIRED',
   });
   ```
2. ะะปั ะบะฐะถะดะพะณะพ ะฟัะพััะพัะตะฝะฝะพะณะพ ะฐะฑะพะฝะตะผะตะฝัะฐ:
   - ะกะธััะตะผะฐ ะฝะฐัะพะดะธั ัะฒัะทะฐะฝะฝัะต GroupMember
   - ะะตะฝัะตั ััะฐััั ะฝะฐ EXPELLED
   - ะฃััะฐะฝะฐะฒะปะธะฒะฐะตั leftAt = ัะตะบััะฐั ะดะฐัะฐ
   - ะะพะฑะฐะฒะปัะตั notes: "ะะฒัะพะผะฐัะธัะตัะบะพะต ะพััะธัะปะตะฝะธะต ะทะฐ ะฝะตัะฟะปะฐัั (14+ ะดะฝะตะน)"
3. ะกะธััะตะผะฐ ะพัะฟัะฐะฒะปัะตั ัะฒะตะดะพะผะปะตะฝะธะต ะบะปะธะตะฝัั
4. ะกะธััะตะผะฐ ะทะฐะฟััะบะฐะตั ะฟัะพัะตัั ัะฐะฑะพัั ั ะปะธััะพะผ ะพะถะธะดะฐะฝะธั

**ะะตะทัะปััะฐั:** ะฃัะฐััะฝะธะบ ะพััะธัะปะตะฝ ะธะท ะณััะฟะฟั, ะผะตััะพ ะพัะฒะพะฑะพะถะดะตะฝะพ

---

### 3.9. ะะตัะตะฒะพะด ััะฐััะฝะธะบะฐ ะผะตะถะดั ะณััะฟะฟะฐะผะธ

**ะฃัะฐััะฝะธะบะธ:** ะะตะฝะตะดะถะตั, ะะปะธะตะฝั

**ะัะพัะตัั:**
1. ะะตะฝะตะดะถะตั ะพัะบััะฒะฐะตั ะบะฐััะพัะบั ััะฐััะฝะธะบะฐ ะณััะฟะฟั
2. ะะฐะถะธะผะฐะตั "ะะตัะตะฒะตััะธ ะฒ ะดััะณัั ะณััะฟะฟั"
3. ะกะธััะตะผะฐ ะฟะพะบะฐะทัะฒะฐะตั ัะฟะธัะพะบ ะดะพัััะฟะฝัั ะณััะฟะฟ (ัะพะน ะถะต ัััะดะธะธ ะธะปะธ ะดััะณะพะน)
4. ะะตะฝะตะดะถะตั ะฒัะฑะธัะฐะตั ัะตะปะตะฒัั ะณััะฟะฟั
5. ะกะธััะตะผะฐ ะฟัะพะฒะตััะตั ะดะพัััะฟะฝะพััั ะผะตัั ะฒ ัะตะปะตะฒะพะน ะณััะฟะฟะต
6. ะกะธััะตะผะฐ ะฒัะฟะพะปะฝัะตั ะฟะตัะตัะฐััะตั ััะพะธะผะพััะธ ะฐะฑะพะฝะตะผะตะฝัะฐ:
   ```typescript
   const currentPrice = sourceGroup.monthlyPrice;
   const newPrice = targetGroup.monthlyPrice;

   if (newPrice !== currentPrice) {
     // ะะตัะตัะฐััะตั ะฟัะพะฟะพััะธะพะฝะฐะปัะฝะพ ะพััะฐะฒัะธะผัั ะดะฝัะผ/ะทะฐะฝััะธัะผ
     const remainingDays = calculateRemainingDays(subscription);
     const priceDiff = (newPrice - currentPrice) * (remainingDays / 30);

     if (priceDiff > 0) {
       // ะขัะตะฑัะตััั ะดะพะฟะปะฐัะฐ
       await createInvoice(clientId, priceDiff, 'ะะพะฟะปะฐัะฐ ะฟัะธ ะฟะตัะตะฒะพะดะต ะฒ ะณััะฟะฟั');
     } else {
       // ะะพะทะฒัะฐั ััะตะดััะฒ ะธะปะธ ะทะฐัะตั ะฝะฐ ัะปะตะดัััะธะน ะผะตััั
       await createCredit(clientId, Math.abs(priceDiff));
     }
   }
   ```
7. ะกะธััะตะผะฐ ะพะฑะฝะพะฒะปัะตั ะทะฐะฟะธัะธ:
   - ะััะธัะปัะตั ะธะท ะธััะพะดะฝะพะน ะณััะฟะฟั (status = EXPELLED)
   - ะกะพะทะดะฐะตั ะฝะพะฒัั ะทะฐะฟะธัั ะฒ ัะตะปะตะฒะพะน ะณััะฟะฟะต (status = ACTIVE)
   - ะะฑะฝะพะฒะปัะตั ะฐะฑะพะฝะตะผะตะฝั (ัะฒัะทั ั ะฝะพะฒะพะน ะณััะฟะฟะพะน)
8. ะกะธััะตะผะฐ ะพัะผะตะฝัะตั ะฑัะดััะธะต Attendance ะฒ ััะฐัะพะน ะณััะฟะฟะต
9. ะกะธััะตะผะฐ ัะพะทะดะฐะตั ะฝะพะฒัะต Attendance ะฒ ะฝะพะฒะพะน ะณััะฟะฟะต
10. ะกะธััะตะผะฐ ะพัะฟัะฐะฒะปัะตั ัะฒะตะดะพะผะปะตะฝะธะต ะบะปะธะตะฝัั

**ะะตะทัะปััะฐั:** ะฃัะฐััะฝะธะบ ะฟะตัะตะฒะตะดะตะฝ ะฒ ะฝะพะฒัั ะณััะฟะฟั ั ะฟะตัะตัะฐััะตัะพะผ ััะพะธะผะพััะธ

---

### 3.10. ะกะพะทะดะฐะฝะธะต ะธ ัะฟัะฐะฒะปะตะฝะธะต ะธะฝะดะธะฒะธะดัะฐะปัะฝัะผะธ ะทะฐะฝััะธัะผะธ

**ะฃัะฐััะฝะธะบะธ:** ะะตะฝะตะดะถะตั, ะะปะธะตะฝั, ะัะตะฟะพะดะฐะฒะฐัะตะปั

**ะัะพัะตัั:**
1. ะะตะฝะตะดะถะตั ะพัะบััะฒะฐะตั ัะฐะทะดะตะป "ะะฝะดะธะฒะธะดัะฐะปัะฝัะต ะทะฐะฝััะธั"
2. ะะฐะถะธะผะฐะตั "ะกะพะทะดะฐัั ะทะฐะฝััะธะต"
3. ะะฐะฟะพะปะฝัะตั ะพะฑัะทะฐัะตะปัะฝัะต ะดะฐะฝะฝัะต:
   - ะกััะดะธั
   - ะะปะธะตะฝั
   - ะัะตะฟะพะดะฐะฒะฐัะตะปั
   - ะะพะผะตัะตะฝะธะต
   - ะะฐัะฐ ะธ ะฒัะตะผั (ะฝะฐัะฐะปะพ ะธ ะพะบะพะฝัะฐะฝะธะต)
   - ะกัะพะธะผะพััั
4. ะกะธััะตะผะฐ ะฟัะพะฒะตััะตั ะบะพะฝัะปะธะบัั:
   - ะะฐะฝััะพััั ะฟะพะผะตัะตะฝะธั
   - ะะฐะฝััะพััั ะฟัะตะฟะพะดะฐะฒะฐัะตะปั
   - ะะฐะฝััะพััั ะบะปะธะตะฝัะฐ (ะพะฟัะธะพะฝะฐะปัะฝะพ)
5. ะกะธััะตะผะฐ ัะพะทะดะฐะตั ะทะฐะฟะธัั IndividualLesson ัะพ ััะฐัััะพะผ SCHEDULED
6. ะกะธััะตะผะฐ ะดะพะฑะฐะฒะปัะตั ะทะฐะฝััะธะต ะฒ ะพะฑัะตะต ัะฐัะฟะธัะฐะฝะธะต
7. ะกะธััะตะผะฐ ัะธะบัะธััะตั ะพะฟะปะฐัั ะธะปะธ ัะฟะธััะฒะฐะตั ั ะฐะฑะพะฝะตะผะตะฝัะฐ
8. ะกะธััะตะผะฐ ะพัะฟัะฐะฒะปัะตั ัะฒะตะดะพะผะปะตะฝะธั ะบะปะธะตะฝัั ะธ ะฟัะตะฟะพะดะฐะฒะฐัะตะปั

**ะะพัะปะต ะฟัะพะฒะตะดะตะฝะธั ะทะฐะฝััะธั:**
1. ะัะตะฟะพะดะฐะฒะฐัะตะปั ะธะปะธ ะผะตะฝะตะดะถะตั ะผะตะฝัะตั ััะฐััั ะฝะฐ COMPLETED
2. ะกะธััะตะผะฐ ััะธััะฒะฐะตั ะทะฐะฝััะธะต ะดะปั ัะฐััะตัะฐ ะะ ะฟัะตะฟะพะดะฐะฒะฐัะตะปั
3. ะกะธััะตะผะฐ ะพะฑะฝะพะฒะปัะตั ะธััะพัะธั ะบะปะธะตะฝัะฐ

**ะัะผะตะฝะฐ ะทะฐะฝััะธั:**
1. ะะตะฝะตะดะถะตั ะผะตะฝัะตั ััะฐััั ะฝะฐ CANCELLED
2. ะกะธััะตะผะฐ ะฒะพะทะฒัะฐัะฐะตั ััะตะดััะฒะฐ ะธะปะธ ะฒะพะทะฒัะฐัะฐะตั ะทะฐะฝััะธะต ะฝะฐ ะฐะฑะพะฝะตะผะตะฝั
3. ะกะธััะตะผะฐ ะพัะฟัะฐะฒะปัะตั ัะฒะตะดะพะผะปะตะฝะธั

**ะะตะทัะปััะฐั:** ะะฝะดะธะฒะธะดัะฐะปัะฝะพะต ะทะฐะฝััะธะต ัะพะทะดะฐะฝะพ ะธ ัะฟัะฐะฒะปัะตััั ะพัะดะตะปัะฝะพ ะพั ะณััะฟะฟะพะฒัั

---

## 4. ะะฐะปะธะดะฐัะธั ะดะฐะฝะฝัั

### 4.1. Category (ะะฐะฟัะฐะฒะปะตะฝะธะต)

| ะะพะปะต | ะัะฐะฒะธะปะพ | ะกะพะพะฑัะตะฝะธะต ะพะฑ ะพัะธะฑะบะต |
|------|---------|---------------------|
| `name` | ะะฑัะทะฐัะตะปัะฝะพะต, 1-100 ัะธะผะฒะพะปะพะฒ | "ะะฐะทะฒะฐะฝะธะต ะฝะฐะฟัะฐะฒะปะตะฝะธั ะพะฑัะทะฐัะตะปัะฝะพ" |
| `name` | ะฃะฝะธะบะฐะปัะฝะพะต ััะตะดะธ ะฐะบัะธะฒะฝัั ะฝะฐะฟัะฐะฒะปะตะฝะธะน | "ะะฐะฟัะฐะฒะปะตะฝะธะต ั ัะฐะบะธะผ ะฝะฐะทะฒะฐะฝะธะตะผ ัะถะต ัััะตััะฒัะตั" |
| `color` | HEX ัะพัะผะฐั (#RRGGBB) ะธะปะธ ะฟัััะพ | "ะะตะฒะตัะฝัะน ัะพัะผะฐั ัะฒะตัะฐ" |
| `status` | ะขะพะปัะบะพ ACTIVE ะธะปะธ CLOSED | "ะะตะฒะตัะฝัะน ััะฐััั ะฝะฐะฟัะฐะฒะปะตะฝะธั" |

**ะะธะทะฝะตั-ะฟัะฐะฒะธะปะฐ:**
- ะะตะปัะทั ะทะฐะบัััั ะฝะฐะฟัะฐะฒะปะตะฝะธะต, ะตัะปะธ ั ะฝะตะณะพ ะตััั ะฐะบัะธะฒะฝัะต ัััะดะธะธ
- ะัะธ ะทะฐะบัััะธะธ ะฝะฐะฟัะฐะฒะปะตะฝะธั (status = CLOSED) ะฒัะต ัะฒัะทะฐะฝะฝัะต ัััะดะธะธ ัะฐะบะถะต ะดะพะปะถะฝั ะฑััั ะทะฐะบัััั

---

### 4.2. Studio (ะกััะดะธั)

| ะะพะปะต | ะัะฐะฒะธะปะพ | ะกะพะพะฑัะตะฝะธะต ะพะฑ ะพัะธะฑะบะต |
|------|---------|---------------------|
| `name` | ะะฑัะทะฐัะตะปัะฝะพะต, 1-100 ัะธะผะฒะพะปะพะฒ | "ะะฐะทะฒะฐะฝะธะต ัััะดะธะธ ะพะฑัะทะฐัะตะปัะฝะพ" |
| `categoryId` | ะกััะตััะฒัััะตะต ะฝะฐะฟัะฐะฒะปะตะฝะธะต | "ะะฐะฟัะฐะฒะปะตะฝะธะต ะฝะต ะฝะฐะนะดะตะฝะพ" |
| `color` | HEX ัะพัะผะฐั (#RRGGBB) ะธะปะธ ะฟัััะพ | "ะะตะฒะตัะฝัะน ัะพัะผะฐั ัะฒะตัะฐ" |
| `isFree` | Boolean | "ะะตะบะพััะตะบัะฝะพะต ะทะฝะฐัะตะฝะธะต ะฟะพะปั" |
| `status` | ะขะพะปัะบะพ ACTIVE ะธะปะธ CLOSED | "ะะตะฒะตัะฝัะน ััะฐััั ัััะดะธะธ" |

**ะะธะทะฝะตั-ะฟัะฐะฒะธะปะฐ:**
- ะะตะปัะทั ะทะฐะบัััั ัััะดะธั, ะตัะปะธ ั ะฝะตะต ะตััั ะฐะบัะธะฒะฝัะต ะณััะฟะฟั
- ะัะธ ะทะฐะบัััะธะธ ัััะดะธะธ ะฒัะต ัะฒัะทะฐะฝะฝัะต ะณััะฟะฟั ัะฐะบะถะต ะดะพะปะถะฝั ะฑััั ะทะฐะบัััั
- ะะตัะฟะปะฐัะฝะฐั ัััะดะธั (isFree = true) ะผะพะถะตั ะธะผะตัั ัะพะปัะบะพ ะฑะตัะฟะปะฐัะฝัะต ะฐะฑะพะฝะตะผะตะฝัั

---

### 4.3. Group (ะััะฟะฟะฐ)

| ะะพะปะต | ะัะฐะฒะธะปะพ | ะกะพะพะฑัะตะฝะธะต ะพะฑ ะพัะธะฑะบะต |
|------|---------|---------------------|
| `name` | ะะฑัะทะฐัะตะปัะฝะพะต, 1-100 ัะธะผะฒะพะปะพะฒ | "ะะฐะทะฒะฐะฝะธะต ะณััะฟะฟั ะพะฑัะทะฐัะตะปัะฝะพ" |
| `studioId` | ะกััะตััะฒัััะฐั ัััะดะธั | "ะกััะดะธั ะฝะต ะฝะฐะนะดะตะฝะฐ" |
| `maxParticipants` | ะฆะตะปะพะต ัะธัะปะพ >= 1 | "ะะฐะบั. ะบะพะปะธัะตััะฒะพ ััะฐััะฝะธะบะพะฒ ะดะพะปะถะฝะพ ะฑััั ะฝะต ะผะตะฝะตะต 1" |
| `singleVisitPrice` | >= 0 ะธะปะธ ะฟัััะพ | "ะกัะพะธะผะพััั ะฝะต ะผะพะถะตั ะฑััั ะพััะธัะฐัะตะปัะฝะพะน" |
| `status` | ะขะพะปัะบะพ ACTIVE ะธะปะธ CLOSED | "ะะตะฒะตัะฝัะน ััะฐััั ะณััะฟะฟั" |

**ะะธะทะฝะตั-ะฟัะฐะฒะธะปะฐ:**
- ะะตะปัะทั ะทะฐะบัััั ะณััะฟะฟั, ะตัะปะธ ั ะฝะตะต ะตััั ะฐะบัะธะฒะฝัะต ััะฐััะฝะธะบะธ
- ะะตะปัะทั ัะผะตะฝััะธัั maxParticipants ะฝะธะถะต ัะตะบััะตะณะพ ะบะพะปะธัะตััะฒะฐ ะฐะบัะธะฒะฝัั ััะฐััะฝะธะบะพะฒ
- ะัะปะธ ัััะดะธั ะฑะตัะฟะปะฐัะฝะฐั, singleVisitPrice ะดะพะปะถะฝะพ ะฑััั null ะธะปะธ 0

---

### 4.4. GroupMember (ะฃัะฐััะฝะธะบ ะณััะฟะฟั)

| ะะพะปะต | ะัะฐะฒะธะปะพ | ะกะพะพะฑัะตะฝะธะต ะพะฑ ะพัะธะฑะบะต |
|------|---------|---------------------|
| `groupId` | ะกััะตััะฒัััะฐั ะณััะฟะฟะฐ | "ะััะฟะฟะฐ ะฝะต ะฝะฐะนะดะตะฝะฐ" |
| `clientId` | ะกััะตััะฒัััะธะน ะบะปะธะตะฝั | "ะะปะธะตะฝั ะฝะต ะฝะฐะนะดะตะฝ" |
| `status` | ะขะพะปัะบะพ ACTIVE, EXPELLED, WAITLIST | "ะะตะฒะตัะฝัะน ััะฐััั ััะฐััะฝะธะบะฐ" |
| `waitlistPosition` | ะฆะตะปะพะต ัะธัะปะพ >= 1, ัะพะปัะบะพ ะดะปั WAITLIST | "ะะตะฒะตัะฝะฐั ะฟะพะทะธัะธั ะฒ ะปะธััะต ะพะถะธะดะฐะฝะธั" |

**ะะธะทะฝะตั-ะฟัะฐะฒะธะปะฐ:**
- ะะปะธะตะฝั ะฝะต ะผะพะถะตั ะฑััั ะดะพะฑะฐะฒะปะตะฝ ะฒ ะพะดะฝั ะธ ัั ะถะต ะณััะฟะฟั ะดะฒะฐะถะดั (ัะฝะธะบะฐะปัะฝะพััั ะฟะพ groupId + clientId)
- ะัะธ ะดะพะฑะฐะฒะปะตะฝะธะธ ััะฐััะฝะธะบะฐ ัะพ ััะฐัััะพะผ ACTIVE:
  - ะะพะปะธัะตััะฒะพ ะฐะบัะธะฒะฝัั ััะฐััะฝะธะบะพะฒ ะฝะต ะดะพะปะถะฝะพ ะฟัะตะฒััะฐัั maxParticipants
- ะัะธ ัะผะตะฝะต ััะฐัััะฐ ั ACTIVE ะฝะฐ EXPELLED:
  - ะะฑัะทะฐัะตะปัะฝะพ ะทะฐะฟะพะปะฝะธัั leftAt
- ะัะธ ัะผะตะฝะต ััะฐัััะฐ ั WAITLIST ะฝะฐ ACTIVE:
  - ะัะพะฒะตัะธัั ะดะพัััะฟะฝะพััั ะผะตัั
  - ะะฑะฝัะปะธัั waitlistPosition

---

### 4.5. Attendance (ะะพัะตัะฐะตะผะพััั)

| ะะพะปะต | ะัะฐะฒะธะปะพ | ะกะพะพะฑัะตะฝะธะต ะพะฑ ะพัะธะฑะบะต |
|------|---------|---------------------|
| `scheduleId` | ะกััะตััะฒัััะตะต ะทะฐะฝััะธะต | "ะะฐะฝััะธะต ะฝะต ะฝะฐะนะดะตะฝะพ" |
| `clientId` | ะกััะตััะฒัััะธะน ะบะปะธะตะฝั | "ะะปะธะตะฝั ะฝะต ะฝะฐะนะดะตะฝ" |
| `status` | ะขะพะปัะบะพ SCHEDULED, PRESENT, ABSENT, SICK, EXCUSED | "ะะตะฒะตัะฝัะน ััะฐััั ะฟะพัะตัะตะฝะธั" |

**ะะธะทะฝะตั-ะฟัะฐะฒะธะปะฐ:**
- ะะปะธะตะฝั ะฝะต ะผะพะถะตั ะฑััั ะดะพะฑะฐะฒะปะตะฝ ะฒ ะถััะฝะฐะป ะพะดะฝะพะณะพ ะทะฐะฝััะธั ะดะฒะฐะถะดั (ัะฝะธะบะฐะปัะฝะพััั ะฟะพ scheduleId + clientId)
- ะะตะปัะทั ะพัะผะตัะธัั ะฟะพัะตัะตะฝะธะต ะดะปั ะทะฐะฝััะธั, ะบะพัะพัะพะต ะตัะต ะฝะต ะฝะฐัะฐะปะพัั (ะบัะพะผะต SCHEDULED)
- ะัะธ ะธะทะผะตะฝะตะฝะธะธ ััะฐัััะฐ ั SCHEDULED ะฝะฐ PRESENT/ABSENT/SICK/EXCUSED:
  - ะะฑัะทะฐัะตะปัะฝะพ ะทะฐะฟะพะปะฝะธัั markedBy ะธ markedAt

---

### 4.6. IndividualLesson (ะะฝะดะธะฒะธะดัะฐะปัะฝะพะต ะทะฐะฝััะธะต)

| ะะพะปะต | ะัะฐะฒะธะปะพ | ะกะพะพะฑัะตะฝะธะต ะพะฑ ะพัะธะฑะบะต |
|------|---------|---------------------|
| `studioId` | ะกััะตััะฒัััะฐั ัััะดะธั | "ะกััะดะธั ะฝะต ะฝะฐะนะดะตะฝะฐ" |
| `clientId` | ะกััะตััะฒัััะธะน ะบะปะธะตะฝั | "ะะปะธะตะฝั ะฝะต ะฝะฐะนะดะตะฝ" |
| `teacherId` | ะกััะตััะฒัััะธะน ะฟัะตะฟะพะดะฐะฒะฐัะตะปั | "ะัะตะฟะพะดะฐะฒะฐัะตะปั ะฝะต ะฝะฐะนะดะตะฝ" |
| `roomId` | ะกััะตััะฒัััะตะต ะฟะพะผะตัะตะฝะธะต | "ะะพะผะตัะตะฝะธะต ะฝะต ะฝะฐะนะดะตะฝะพ" |
| `date` | ะะต ะฒ ะฟัะพัะปะพะผ (ะฟัะธ ัะพะทะดะฐะฝะธะธ) | "ะะฐัะฐ ะทะฐะฝััะธั ะฝะต ะผะพะถะตั ะฑััั ะฒ ะฟัะพัะปะพะผ" |
| `startTime` | ะะพััะตะบัะฝะพะต ะฒัะตะผั | "ะะตะฒะตัะฝะพะต ะฒัะตะผั ะฝะฐัะฐะปะฐ" |
| `endTime` | ะะพะทะถะต startTime | "ะัะตะผั ะพะบะพะฝัะฐะฝะธั ะดะพะปะถะฝะพ ะฑััั ะฟะพะทะถะต ะฝะฐัะฐะปะฐ" |
| `price` | >= 0 | "ะกัะพะธะผะพััั ะฝะต ะผะพะถะตั ะฑััั ะพััะธัะฐัะตะปัะฝะพะน" |
| `status` | ะขะพะปัะบะพ SCHEDULED, COMPLETED, CANCELLED, NO_SHOW | "ะะตะฒะตัะฝัะน ััะฐััั ะทะฐะฝััะธั" |

**ะะธะทะฝะตั-ะฟัะฐะฒะธะปะฐ:**
- ะะตะปัะทั ัะพะทะดะฐัั ะทะฐะฝััะธะต, ะตัะปะธ ะฟะพะผะตัะตะฝะธะต ะทะฐะฝััะพ ะฒ ััะพ ะฒัะตะผั
- ะะตะปัะทั ัะพะทะดะฐัั ะทะฐะฝััะธะต, ะตัะปะธ ะฟัะตะฟะพะดะฐะฒะฐัะตะปั ะทะฐะฝัั ะฒ ััะพ ะฒัะตะผั
- ะะตะปัะทั ะธะทะผะตะฝะธัั ััะฐััั ะฝะฐ COMPLETED ะดะปั ะทะฐะฝััะธั, ะบะพัะพัะพะต ะตัะต ะฝะต ะทะฐะบะพะฝัะธะปะพัั

---

## 5. UI/UX ัะฟะตัะธัะธะบะฐัะธั

### 5.1. ะกััะฐะฝะธัะฐ "ะะฐะฟัะฐะฒะปะตะฝะธั ะธ ัััะดะธะธ"

**ะะฐะบะตั:**
```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ ะะฐะฟัะฐะฒะปะตะฝะธั ะธ ัััะดะธะธ                      [+ ะะฐะฟัะฐะฒะปะตะฝะธะต]   โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโค
โ                                                               โ
โ โผ ะกะฟะพัั                                           [Edit]     โ
โ   โโ ะขะฐะฝัั (5 ะณััะฟะฟ)                             [Edit]     โ
โ   โโ ะะพะณะฐ (3 ะณััะฟะฟั)                             [Edit]     โ
โ   โโ ะะฐัะฐัั (2 ะณััะฟะฟั)                           [Edit]     โ
โ                                                               โ
โ โผ ะัะบััััะฒะพ                                       [Edit]     โ
โ   โโ ะะพะบะฐะป (4 ะณััะฟะฟั)                            [Edit]     โ
โ   โโ ะะธัะพะฒะฐะฝะธะต (6 ะณััะฟะฟ)                         [Edit]     โ
โ   โโ ะขะตะฐัั (2 ะณััะฟะฟั)                            [Edit]     โ
โ                                                               โ
โ โผ ะะฑัะฐะทะพะฒะฐะฝะธะต                                     [Edit]     โ
โ   โโ ะะฝะณะปะธะนัะบะธะน ัะทัะบ (5 ะณััะฟะฟ)                   [Edit]     โ
โ   โโ ะจะฐัะผะฐัั (3 ะณััะฟะฟั)                          [Edit]     โ
โ                                                               โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

**ะคัะฝะบัะธะพะฝะฐะป:**
- ะะตัะฐััะธัะตัะบะพะต ะดะตัะตะฒะพ: ะะฐะฟัะฐะฒะปะตะฝะธะต โ ะกััะดะธั
- ะกะฒะพัะฐัะธะฒะฐะฝะธะต/ัะฐะทะฒะพัะฐัะธะฒะฐะฝะธะต ะฝะฐะฟัะฐะฒะปะตะฝะธะน
- ะฆะฒะตัะพะฒัะต ะผะตัะบะธ ััะดะพะผ ั ะฝะฐะทะฒะฐะฝะธัะผะธ ัััะดะธะน
- ะะฝะดะธะบะฐัะพั ััะฐัััะฐ (ะะบัะธะฒะฝะฐั/ะะฐะบัััะฐั)
- ะััััะพะต ัะพะทะดะฐะฝะธะต ะฝะฐะฟัะฐะฒะปะตะฝะธั ะธ ัััะดะธะธ

---

### 5.2. ะกััะฐะฝะธัะฐ "ะััะฟะฟั ัััะดะธะธ"

**ะะฐะบะตั:**
```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ ะขะฐะฝัั โบ ะััะฟะฟั                                [+ ะััะฟะฟะฐ]     โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโค
โ                                                               โ
โ โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ โ
โ โ ะะฐัะธะฝะฐััะธะต 5-7 ะปะตั                          [Edit]      โ โ
โ โ ะฃัะฐััะฝะธะบะพะฒ: 12 / 15     ะะธัั ะพะถะธะดะฐะฝะธั: 3               โ โ
โ โ ะะฐัะฟะธัะฐะฝะธะต: ะะฝ, ะกั, ะั 16:00-17:00                     โ โ
โ โ ะัะตะฟะพะดะฐะฒะฐัะตะปั: ะะฒะฐะฝะพะฒะฐ ะ.ะก.                             โ โ
โ โ ะกัะพะธะผะพััั ัะฐะทะพะฒะพะณะพ: 500 ััะฑ.                            โ โ
โ โ [ะฃัะฐััะฝะธะบะธ] [ะะฐัะฟะธัะฐะฝะธะต] [ะััะตัั]                       โ โ
โ โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ โ
โ                                                               โ
โ โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ โ
โ โ ะัะพะดะฒะธะฝัััะต 8-12 ะปะตั                        [Edit]      โ โ
โ โ ะฃัะฐััะฝะธะบะพะฒ: 15 / 15 (ะะฐะฟะพะปะฝะตะฝะฐ)  ะะธัั ะพะถะธะดะฐะฝะธั: 5      โ โ
โ โ ะะฐัะฟะธัะฐะฝะธะต: ะั, ะงั 17:00-18:30                          โ โ
โ โ ะัะตะฟะพะดะฐะฒะฐัะตะปั: ะะตััะพะฒะฐ ะ.ะ.                             โ โ
โ โ ะกัะพะธะผะพััั ัะฐะทะพะฒะพะณะพ: 600 ััะฑ.                            โ โ
โ โ [ะฃัะฐััะฝะธะบะธ] [ะะฐัะฟะธัะฐะฝะธะต] [ะััะตัั]                       โ โ
โ โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ โ
โ                                                               โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

**ะคัะฝะบัะธะพะฝะฐะป:**
- ะกะฟะธัะพะบ ะฒัะตั ะณััะฟะฟ ัััะดะธะธ
- ะะฝะดะธะบะฐัะธั ะทะฐะฟะพะปะฝะตะฝะฝะพััะธ
- ะัััััะน ะดะพัััะฟ ะบ ััะฐััะฝะธะบะฐะผ, ัะฐัะฟะธัะฐะฝะธั, ะพััะตัะฐะผ
- ะะฝะพะฟะบะฐ ัะพะทะดะฐะฝะธั ะฝะพะฒะพะน ะณััะฟะฟั

---

### 5.3. ะกััะฐะฝะธัะฐ "ะฃัะฐััะฝะธะบะธ ะณััะฟะฟั"

**ะะฐะบะตั:**
```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ ะขะฐะฝัั โบ ะะฐัะธะฝะฐััะธะต 5-7 ะปะตั โบ ะฃัะฐััะฝะธะบะธ      [+ ะะพะฑะฐะฒะธัั]   โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโค
โ                                                               โ
โ ะะบะปะฐะดะบะธ: [ะะบัะธะฒะฝัะต (12)] [ะะธัั ะพะถะธะดะฐะฝะธั (3)] [ะััะธัะปะตะฝะฝัะต] โ
โ                                                               โ
โ โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ โ
โ โ ะะฒะฐะฝะพะฒ ะะฒะฐะฝ ะะฒะฐะฝะพะฒะธั, 6 ะปะตั                 [...]       โ โ
โ โ ะขะตะปะตัะพะฝ: +7 (900) 123-45-67                             โ โ
โ โ ะะฐัะฐ ะทะฐะฟะธัะธ: 01.09.2024                                 โ โ
โ โ ะะฑะพะฝะตะผะตะฝั: ะะพ 30.11.2024 (ะพััะฐะปะพัั 15 ะทะฐะฝััะธะน)         โ โ
โ โ ะะพัะตัะฐะตะผะพััั: 24 / 30 (80%)                             โ โ
โ โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ โ
โ                                                               โ
โ โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ โ
โ โ ะะตััะพะฒะฐ ะะฝะฝะฐ ะกะตัะณะตะตะฒะฝะฐ, 7 ะปะตั               [...]       โ โ
โ โ ะขะตะปะตัะพะฝ: +7 (900) 234-56-78                             โ โ
โ โ ะะฐัะฐ ะทะฐะฟะธัะธ: 15.09.2024                                 โ โ
โ โ ะะฑะพะฝะตะผะตะฝั: ะะพ 31.12.2024 (ะพััะฐะปะพัั 20 ะทะฐะฝััะธะน)         โ โ
โ โ ะะพัะตัะฐะตะผะพััั: 18 / 20 (90%)                             โ โ
โ โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ โ
โ                                                               โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

**ะคัะฝะบัะธะพะฝะฐะป:**
- ะขัะธ ะฒะบะปะฐะดะบะธ: ะะบัะธะฒะฝัะต, ะะธัั ะพะถะธะดะฐะฝะธั, ะััะธัะปะตะฝะฝัะต
- ะะพะธัะบ ะธ ัะธะปัััะฐัะธั ััะฐััะฝะธะบะพะฒ
- ะะฝัะพัะผะฐัะธั ะพะฑ ะฐะฑะพะฝะตะผะตะฝัะต ะธ ะฟะพัะตัะฐะตะผะพััะธ
- ะะพะฝัะตะบััะฝะพะต ะผะตะฝั [...] ะดะปั ะบะฐะถะดะพะณะพ ััะฐััะฝะธะบะฐ:
  - ะะตัะตะฒะตััะธ ะฒ ะดััะณัั ะณััะฟะฟั
  - ะััะธัะปะธัั ะธะท ะณััะฟะฟั
  - ะะพะฑะฐะฒะธัั ะฒ ะปะธัั ะพะถะธะดะฐะฝะธั (ะตัะปะธ ะทะฐะฟะพะปะฝะตะฝะฐ)
  - ะัะพัะผะพััะตัั ะบะฐััะพัะบั ะบะปะธะตะฝัะฐ
- ะะฝะพะฟะบะฐ ะดะพะฑะฐะฒะปะตะฝะธั ะฝะพะฒะพะณะพ ััะฐััะฝะธะบะฐ

---

### 5.4. ะััะฝะฐะป ะฟะพัะตัะฐะตะผะพััะธ

**ะะฐะบะตั:**
```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ ะััะฝะฐะป ะฟะพัะตัะฐะตะผะพััะธ: ะขะฐะฝัั โบ ะะฐัะธะฝะฐััะธะต 5-7 ะปะตั             โ
โ ะะฐัะฐ: 13.11.2024, ะะฝ 16:00-17:00        [ะกะพััะฐะฝะธัั]         โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโค
โ                                                               โ
โ โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ โ
โ โ โ ะะฒะฐะฝะพะฒ ะะฒะฐะฝ ะะฒะฐะฝะพะฒะธั                                  โ โ
โ โ    ะกัะฐััั: [โ ะัะธัััััะฒะพะฒะฐะป] [ ะััััััะฒะพะฒะฐะป]           โ โ
โ โ            [ ะะพะปะตะป] [ ะฃะฒะฐะถะธัะตะปัะฝะฐั ะฟัะธัะธะฝะฐ]             โ โ
โ โ    ะัะธะผะตัะฐะฝะธะต: _________________________________        โ โ
โ โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ โ
โ                                                               โ
โ โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ โ
โ โ โ ะะตััะพะฒะฐ ะะฝะฝะฐ ะกะตัะณะตะตะฒะฝะฐ                                โ โ
โ โ    ะกัะฐััั: [ ะัะธัััััะฒะพะฒะฐะป] [โ ะััััััะฒะพะฒะฐะป]           โ โ
โ โ            [ ะะพะปะตะป] [ ะฃะฒะฐะถะธัะตะปัะฝะฐั ะฟัะธัะธะฝะฐ]             โ โ
โ โ    ะัะธะผะตัะฐะฝะธะต: ะะพะปะตะปะฐ, ะตััั ัะฟัะฐะฒะบะฐ                     โ โ
โ โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ โ
โ                                                               โ
โ โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ โ
โ โ โ ะกะธะดะพัะพะฒ ะะตัั ะะปะตะบัะฐะฝะดัะพะฒะธั                            โ โ
โ โ    ะกัะฐััั: [โ ะัะธัััััะฒะพะฒะฐะป] [ ะััััััะฒะพะฒะฐะป]           โ โ
โ โ            [ ะะพะปะตะป] [ ะฃะฒะฐะถะธัะตะปัะฝะฐั ะฟัะธัะธะฝะฐ]             โ โ
โ โ    ะัะธะผะตัะฐะฝะธะต: ะัะปะธัะฝะพะต ะฒััััะฟะปะตะฝะธะต                     โ โ
โ โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ โ
โ                                                               โ
โ [+ ะะพะฑะฐะฒะธัั ัะฐะทะพะฒัั ะทะฐะฟะธัั]                                  โ
โ                                                               โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

**ะคัะฝะบัะธะพะฝะฐะป:**
- ะกะฟะธัะพะบ ะฟัะตะดะฒะฐัะธัะตะปัะฝะพ ััะพัะผะธัะพะฒะฐะฝ (ะฟะพััะพัะฝะฝัะต ััะฐััะฝะธะบะธ + ัะฐะทะพะฒัะต ะทะฐะฟะธัะธ)
- ะัะตะฟะพะดะฐะฒะฐัะตะปั ะพัะผะตัะฐะตั ััะฐััั ะบะฐะถะดะพะณะพ ััะฐััะฝะธะบะฐ
- ะะพะทะผะพะถะฝะพััั ะดะพะฑะฐะฒะปะตะฝะธั ะฟัะธะผะตัะฐะฝะธะน
- ะะพะทะผะพะถะฝะพััั ะดะพะฑะฐะฒะธัั ัะฐะทะพะฒัั ะทะฐะฟะธัั ะฟััะผะพ ะฝะฐ ะทะฐะฝััะธะต
- ะะฒัะพัะพััะฐะฝะตะฝะธะต ะฟัะธ ะธะทะผะตะฝะตะฝะธะธ
- ะะฝะดะธะบะฐัะธั ัะพััะฐะฝะตะฝะธั

---

### 5.5. ะะธัั ะพะถะธะดะฐะฝะธั

**ะะฐะบะตั:**
```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ ะะธัั ะพะถะธะดะฐะฝะธั: ะขะฐะฝัั โบ ะัะพะดะฒะธะฝัััะต 8-12 ะปะตั                 โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโค
โ                                                               โ
โ ะกะฒะพะฑะพะดะฝัั ะผะตัั: 0 / 15                                       โ
โ ะ ะปะธััะต ะพะถะธะดะฐะฝะธั: 5 ัะตะปะพะฒะตะบ                                  โ
โ                                                               โ
โ โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ โ
โ โ 1. ะกะผะธัะฝะพะฒะฐ ะะปัะณะฐ ะะตััะพะฒะฝะฐ                  [โ] [โ]     โ โ
โ โ    ะขะตะปะตัะพะฝ: +7 (900) 345-67-89                          โ โ
โ โ    ะะฐัะฐ ะดะพะฑะฐะฒะปะตะฝะธั: 10.10.2024                          โ โ
โ โ    [ะะตัะตะฒะตััะธ ะฒ ะฐะบัะธะฒะฝัะต] [ะฃะดะฐะปะธัั ะธะท ะปะธััะฐ]            โ โ
โ โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ โ
โ                                                               โ
โ โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ โ
โ โ 2. ะะพะทะปะพะฒ ะะผะธััะธะน ะกะตัะณะตะตะฒะธั                 [โ] [โ]     โ โ
โ โ    ะขะตะปะตัะพะฝ: +7 (900) 456-78-90                          โ โ
โ โ    ะะฐัะฐ ะดะพะฑะฐะฒะปะตะฝะธั: 15.10.2024                          โ โ
โ โ    [ะะตัะตะฒะตััะธ ะฒ ะฐะบัะธะฒะฝัะต] [ะฃะดะฐะปะธัั ะธะท ะปะธััะฐ]            โ โ
โ โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ โ
โ                                                               โ
โ ...                                                          โ
โ                                                               โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

**ะคัะฝะบัะธะพะฝะฐะป:**
- ะกะฟะธัะพะบ ะบะปะธะตะฝัะพะฒ ะฒ ะฟะพััะดะบะต ะพัะตัะตะดะธ (FIFO)
- ะะพะทะผะพะถะฝะพััั ะธะทะผะตะฝะธัั ะฟะพััะดะพะบ (ะบะฝะพะฟะบะธ โ โ)
- ะััะฝะพะน ะฟะตัะตะฒะพะด ะฒ ะฐะบัะธะฒะฝัะต ััะฐััะฝะธะบะธ
- ะฃะดะฐะปะตะฝะธะต ะธะท ะปะธััะฐ ะพะถะธะดะฐะฝะธั
- ะะฝะดะธะบะฐัะธั ัะฒะพะฑะพะดะฝัั ะผะตัั
- ะะฒัะพัะฒะตะดะพะผะปะตะฝะธะต ะฟัะธ ะพัะฒะพะฑะพะถะดะตะฝะธะธ ะผะตััะฐ (ะฝะฐัััะฐะธะฒะฐะตััั)

---

### 5.6. ะะฝะดะธะฒะธะดัะฐะปัะฝัะต ะทะฐะฝััะธั

**ะะฐะบะตั:**
```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ ะะฝะดะธะฒะธะดัะฐะปัะฝัะต ะทะฐะฝััะธั                     [+ ะกะพะทะดะฐัั]      โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโค
โ ะคะธะปัััั: [ะัะต ัััะดะธะธ โผ] [ะัะต ะฟัะตะฟะพะดะฐะฒะฐัะตะปะธ โผ] [ะะตะดะตะปั โผ]   โ
โ                                                               โ
โ โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ โ
โ โ 13.11.2024, ะะฝ 10:00-11:00                  [Edit]      โ โ
โ โ ะกััะดะธั: ะะพะบะฐะป                                           โ โ
โ โ ะะปะธะตะฝั: ะะฒะฐะฝะพะฒะฐ ะะฐัะธั ะะตััะพะฒะฝะฐ                          โ โ
โ โ ะัะตะฟะพะดะฐะฒะฐัะตะปั: ะกะธะดะพัะพะฒะฐ ะ.ะ.                            โ โ
โ โ ะะพะผะตัะตะฝะธะต: ะะฐะป 3                                        โ โ
โ โ ะกัะพะธะผะพััั: 2000 ััะฑ.                                    โ โ
โ โ ะกัะฐััั: โ ะัะพะฒะตะดะตะฝะพ                                    โ โ
โ โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ โ
โ                                                               โ
โ โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ โ
โ โ 14.11.2024, ะั 15:00-16:00                  [Edit]      โ โ
โ โ ะกััะดะธั: ะคะพััะตะฟะธะฐะฝะพ                                      โ โ
โ โ ะะปะธะตะฝั: ะะตััะพะฒ ะะฒะฐะฝ ะกะตัะณะตะตะฒะธั                           โ โ
โ โ ะัะตะฟะพะดะฐะฒะฐัะตะปั: ะะพะทะปะพะฒะฐ ะ.ะ.                             โ โ
โ โ ะะพะผะตัะตะฝะธะต: ะะฐะฑะธะฝะตั 5                                    โ โ
โ โ ะกัะพะธะผะพััั: 1500 ััะฑ.                                    โ โ
โ โ ะกัะฐััั: ๐ ะะฐะฟะปะฐะฝะธัะพะฒะฐะฝะพ                                โ โ
โ โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ โ
โ                                                               โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

**ะคัะฝะบัะธะพะฝะฐะป:**
- ะกะฟะธัะพะบ ะฒัะตั ะธะฝะดะธะฒะธะดัะฐะปัะฝัั ะทะฐะฝััะธะน
- ะคะธะปัััะฐัะธั ะฟะพ ัััะดะธะธ, ะฟัะตะฟะพะดะฐะฒะฐัะตะปั, ะฟะตัะธะพะดั
- ะกัะฐัััั: ะะฐะฟะปะฐะฝะธัะพะฒะฐะฝะพ, ะัะพะฒะตะดะตะฝะพ, ะัะผะตะฝะตะฝะพ, ะะต ัะฒะธะปัั
- ะะฝะพะฟะบะฐ ัะพะทะดะฐะฝะธั ะฝะพะฒะพะณะพ ะทะฐะฝััะธั
- ะะตะดะฐะบัะธัะพะฒะฐะฝะธะต ะธ ะพัะผะตะฝะฐ ะทะฐะฝััะธะน

---

## 6. API ัะฝะดะฟะพะธะฝัั

### 6.1. ะะฐะฟัะฐะฒะปะตะฝะธั (Categories)

#### `GET /api/categories`

ะะพะปััะธัั ัะฟะธัะพะบ ะฒัะตั ะฝะฐะฟัะฐะฒะปะตะฝะธะน.

**Query ะฟะฐัะฐะผะตััั:**
- `status` (optional): `ACTIVE` | `CLOSED` โ ัะธะปััั ะฟะพ ััะฐัััั

**Response 200:**
```json
{
  "categories": [
    {
      "id": "uuid",
      "name": "ะกะฟะพัั",
      "description": "ะกะฟะพััะธะฒะฝัะต ัะตะบัะธะธ",
      "color": "#FF5733",
      "status": "ACTIVE",
      "studiosCount": 5,
      "createdAt": "2024-11-13T10:00:00Z",
      "updatedAt": "2024-11-13T10:00:00Z"
    }
  ]
}
```

---

#### `POST /api/categories`

ะกะพะทะดะฐัั ะฝะพะฒะพะต ะฝะฐะฟัะฐะฒะปะตะฝะธะต.

**Request Body:**
```json
{
  "name": "ะกะฟะพัั",
  "description": "ะกะฟะพััะธะฒะฝัะต ัะตะบัะธะธ",
  "color": "#FF5733"
}
```

**Response 201:**
```json
{
  "id": "uuid",
  "name": "ะกะฟะพัั",
  "description": "ะกะฟะพััะธะฒะฝัะต ัะตะบัะธะธ",
  "color": "#FF5733",
  "status": "ACTIVE",
  "createdAt": "2024-11-13T10:00:00Z",
  "updatedAt": "2024-11-13T10:00:00Z"
}
```

**Response 400:** ะัะธะฑะบะฐ ะฒะฐะปะธะดะฐัะธะธ

---

#### `PATCH /api/categories/:id`

ะะฑะฝะพะฒะธัั ะฝะฐะฟัะฐะฒะปะตะฝะธะต.

**Request Body:**
```json
{
  "name": "ะกะฟะพัั ะธ ะทะดะพัะพะฒัะต",
  "status": "CLOSED"
}
```

**Response 200:** ะะฑะฝะพะฒะปะตะฝะฝะพะต ะฝะฐะฟัะฐะฒะปะตะฝะธะต

**Response 400:** ะัะธะฑะบะฐ ะฒะฐะปะธะดะฐัะธะธ (ะฝะฐะฟัะธะผะตั, ะฝะตะปัะทั ะทะฐะบัััั ะฝะฐะฟัะฐะฒะปะตะฝะธะต ั ะฐะบัะธะฒะฝัะผะธ ัััะดะธัะผะธ)

---

### 6.2. ะกััะดะธะธ (Studios)

#### `GET /api/studios`

ะะพะปััะธัั ัะฟะธัะพะบ ะฒัะตั ัััะดะธะน.

**Query ะฟะฐัะฐะผะตััั:**
- `categoryId` (optional): ะคะธะปััั ะฟะพ ะฝะฐะฟัะฐะฒะปะตะฝะธั
- `status` (optional): `ACTIVE` | `CLOSED`

**Response 200:**
```json
{
  "studios": [
    {
      "id": "uuid",
      "categoryId": "uuid",
      "name": "ะขะฐะฝัั",
      "description": "ะกะพะฒัะตะผะตะฝะฝัะต ัะฐะฝัั",
      "color": "#3498DB",
      "isFree": false,
      "status": "ACTIVE",
      "groupsCount": 5,
      "teachers": [
        {
          "id": "uuid",
          "name": "ะะฒะฐะฝะพะฒะฐ ะะฝะฝะฐ ะกะตัะณะตะตะฒะฝะฐ",
          "salaryPercentage": 50
        }
      ],
      "createdAt": "2024-11-13T10:00:00Z",
      "updatedAt": "2024-11-13T10:00:00Z"
    }
  ]
}
```

---

#### `POST /api/studios`

ะกะพะทะดะฐัั ะฝะพะฒัั ัััะดะธั.

**Request Body:**
```json
{
  "categoryId": "uuid",
  "name": "ะขะฐะฝัั",
  "description": "ะกะพะฒัะตะผะตะฝะฝัะต ัะฐะฝัั",
  "color": "#3498DB",
  "isFree": false,
  "teacherIds": ["teacher-uuid-1", "teacher-uuid-2"]
}
```

**Response 201:** ะกะพะทะดะฐะฝะฝะฐั ัััะดะธั

---

#### `PATCH /api/studios/:id`

ะะฑะฝะพะฒะธัั ัััะดะธั.

**Request Body:**
```json
{
  "name": "ะขะฐะฝัั ะธ ัะพัะตะพะณัะฐัะธั",
  "status": "CLOSED"
}
```

**Response 200:** ะะฑะฝะพะฒะปะตะฝะฝะฐั ัััะดะธั

---

#### `POST /api/studios/:id/teachers`

ะะพะฑะฐะฒะธัั ะฟัะตะฟะพะดะฐะฒะฐัะตะปั ะบ ัััะดะธะธ.

**Request Body:**
```json
{
  "teacherId": "uuid",
  "salaryPercentage": 50
}
```

**Response 201:** ะกะฒัะทั StudioTeacher ัะพะทะดะฐะฝะฐ

---

#### `DELETE /api/studios/:studioId/teachers/:teacherId`

ะฃะดะฐะปะธัั ะฟัะตะฟะพะดะฐะฒะฐัะตะปั ะธะท ัััะดะธะธ.

**Response 204:** ะฃัะฟะตัะฝะพ ัะดะฐะปะตะฝะพ

---

### 6.3. ะััะฟะฟั (Groups)

#### `GET /api/groups`

ะะพะปััะธัั ัะฟะธัะพะบ ะฒัะตั ะณััะฟะฟ.

**Query ะฟะฐัะฐะผะตััั:**
- `studioId` (optional): ะคะธะปััั ะฟะพ ัััะดะธะธ
- `status` (optional): `ACTIVE` | `CLOSED`

**Response 200:**
```json
{
  "groups": [
    {
      "id": "uuid",
      "studioId": "uuid",
      "name": "ะะฐัะธะฝะฐััะธะต 5-7 ะปะตั",
      "level": "ะะฐัะธะฝะฐััะธะต",
      "ageCategory": "5-7 ะปะตั",
      "maxParticipants": 15,
      "singleVisitPrice": 500.00,
      "status": "ACTIVE",
      "activeMembers": 12,
      "waitlistCount": 3,
      "studio": {
        "id": "uuid",
        "name": "ะขะฐะฝัั"
      },
      "createdAt": "2024-11-13T10:00:00Z",
      "updatedAt": "2024-11-13T10:00:00Z"
    }
  ]
}
```

---

#### `POST /api/groups`

ะกะพะทะดะฐัั ะฝะพะฒัั ะณััะฟะฟั.

**Request Body:**
```json
{
  "studioId": "uuid",
  "name": "ะะฐัะธะฝะฐััะธะต 5-7 ะปะตั",
  "level": "ะะฐัะธะฝะฐััะธะต",
  "ageCategory": "5-7 ะปะตั",
  "maxParticipants": 15,
  "singleVisitPrice": 500.00
}
```

**Response 201:** ะกะพะทะดะฐะฝะฝะฐั ะณััะฟะฟะฐ

---

#### `PATCH /api/groups/:id`

ะะฑะฝะพะฒะธัั ะณััะฟะฟั.

**Request Body:**
```json
{
  "name": "ะะฐัะธะฝะฐััะธะต 5-8 ะปะตั",
  "maxParticipants": 18
}
```

**Response 200:** ะะฑะฝะพะฒะปะตะฝะฝะฐั ะณััะฟะฟะฐ

**Response 400:** ะัะธะฑะบะฐ (ะฝะฐะฟัะธะผะตั, ะฝะตะปัะทั ัะผะตะฝััะธัั maxParticipants ะฝะธะถะต ัะตะบััะตะณะพ ะบะพะปะธัะตััะฒะฐ ะฐะบัะธะฒะฝัั)

---

### 6.4. ะฃัะฐััะฝะธะบะธ ะณััะฟะฟั (GroupMembers)

#### `GET /api/groups/:groupId/members`

ะะพะปััะธัั ัะฟะธัะพะบ ััะฐััะฝะธะบะพะฒ ะณััะฟะฟั.

**Query ะฟะฐัะฐะผะตััั:**
- `status` (optional): `ACTIVE` | `EXPELLED` | `WAITLIST`

**Response 200:**
```json
{
  "members": [
    {
      "id": "uuid",
      "groupId": "uuid",
      "clientId": "uuid",
      "status": "ACTIVE",
      "joinedAt": "2024-09-01T10:00:00Z",
      "leftAt": null,
      "waitlistPosition": null,
      "client": {
        "id": "uuid",
        "lastName": "ะะฒะฐะฝะพะฒ",
        "firstName": "ะะฒะฐะฝ",
        "middleName": "ะะฒะฐะฝะพะฒะธั",
        "phone": "+79001234567",
        "dateOfBirth": "2018-05-15"
      },
      "subscription": {
        "id": "uuid",
        "validUntil": "2024-11-30",
        "remainingVisits": 15
      },
      "attendanceStats": {
        "total": 30,
        "present": 24,
        "absent": 4,
        "sick": 2,
        "attendanceRate": 80
      }
    }
  ]
}
```

---

#### `POST /api/groups/:groupId/members`

ะะฐะฟะธัะฐัั ะบะปะธะตะฝัะฐ ะฒ ะณััะฟะฟั.

**Request Body:**
```json
{
  "clientId": "uuid"
}
```

**Response 201:** ะกะพะทะดะฐะฝ GroupMember ัะพ ััะฐัััะพะผ ACTIVE ะธะปะธ WAITLIST

**Response 400:** ะัะธะฑะบะธ:
- ะััะฟะฟะฐ ะทะฐะฟะพะปะฝะตะฝะฐ (ะฟัะตะดะปะพะถะตะฝะธะต ะดะพะฑะฐะฒะธัั ะฒ ะปะธัั ะพะถะธะดะฐะฝะธั)
- ะะปะธะตะฝั ัะถะต ะทะฐะฟะธัะฐะฝ ะฒ ััั ะณััะฟะฟั

---

#### `PATCH /api/group-members/:id`

ะะฑะฝะพะฒะธัั ััะฐััั ััะฐััะฝะธะบะฐ.

**Request Body:**
```json
{
  "status": "EXPELLED",
  "notes": "ะะพ ะถะตะปะฐะฝะธั ะบะปะธะตะฝัะฐ"
}
```

**Response 200:** ะะฑะฝะพะฒะปะตะฝะฝัะน ััะฐััะฝะธะบ

---

#### `POST /api/group-members/:id/transfer`

ะะตัะตะฒะตััะธ ััะฐััะฝะธะบะฐ ะฒ ะดััะณัั ะณััะฟะฟั.

**Request Body:**
```json
{
  "targetGroupId": "uuid"
}
```

**Response 200:**
```json
{
  "message": "ะฃัะฐััะฝะธะบ ััะฟะตัะฝะพ ะฟะตัะตะฒะตะดะตะฝ",
  "oldGroupMember": { ... },
  "newGroupMember": { ... },
  "priceAdjustment": {
    "amount": 500.00,
    "type": "charge" // ะธะปะธ "refund"
  }
}
```

**Response 400:** ะัะธะฑะบะธ:
- ะฆะตะปะตะฒะฐั ะณััะฟะฟะฐ ะทะฐะฟะพะปะฝะตะฝะฐ
- ะฆะตะปะตะฒะฐั ะณััะฟะฟะฐ ะทะฐะบัััะฐ

---

### 6.5. ะะพัะตัะฐะตะผะพััั (Attendance)

#### `GET /api/schedules/:scheduleId/attendances`

ะะพะปััะธัั ะถััะฝะฐะป ะฟะพัะตัะฐะตะผะพััะธ ะดะปั ะทะฐะฝััะธั.

**Response 200:**
```json
{
  "schedule": {
    "id": "uuid",
    "groupId": "uuid",
    "date": "2024-11-13",
    "startTime": "16:00:00",
    "endTime": "17:00:00"
  },
  "attendances": [
    {
      "id": "uuid",
      "clientId": "uuid",
      "status": "PRESENT",
      "markedBy": "uuid",
      "markedAt": "2024-11-13T17:05:00Z",
      "notes": "ะัะปะธัะฝะพะต ะฒััััะฟะปะตะฝะธะต",
      "client": {
        "id": "uuid",
        "lastName": "ะะฒะฐะฝะพะฒ",
        "firstName": "ะะฒะฐะฝ",
        "middleName": "ะะฒะฐะฝะพะฒะธั"
      }
    }
  ]
}
```

---

#### `POST /api/schedules/:scheduleId/attendances`

ะกะพะทะดะฐัั ะทะฐะฟะธัั ะพ ะฟะพัะตัะฐะตะผะพััะธ (ัะฐะทะพะฒะฐั ะทะฐะฟะธัั ะฝะฐ ะทะฐะฝััะธะต).

**Request Body:**
```json
{
  "clientId": "uuid"
}
```

**Response 201:** ะกะพะทะดะฐะฝะฐ ะทะฐะฟะธัั Attendance ัะพ ััะฐัััะพะผ SCHEDULED

---

#### `PATCH /api/attendances/:id`

ะะฑะฝะพะฒะธัั ััะฐััั ะฟะพัะตัะตะฝะธั.

**Request Body:**
```json
{
  "status": "PRESENT",
  "notes": "ะัะปะธัะฝะพะต ะฒััััะฟะปะตะฝะธะต"
}
```

**Response 200:** ะะฑะฝะพะฒะปะตะฝะฝะฐั ะทะฐะฟะธัั ะฟะพัะตัะฐะตะผะพััะธ

---

#### `PATCH /api/schedules/:scheduleId/attendances/bulk`

ะะฐััะพะฒะพะต ะพะฑะฝะพะฒะปะตะฝะธะต ะฟะพัะตัะฐะตะผะพััะธ (ะดะปั ะฟัะตะฟะพะดะฐะฒะฐัะตะปั).

**Request Body:**
```json
{
  "attendances": [
    {
      "attendanceId": "uuid-1",
      "status": "PRESENT",
      "notes": ""
    },
    {
      "attendanceId": "uuid-2",
      "status": "ABSENT",
      "notes": ""
    },
    {
      "attendanceId": "uuid-3",
      "status": "SICK",
      "notes": "ะะพะปะตะป, ะตััั ัะฟัะฐะฒะบะฐ"
    }
  ]
}
```

**Response 200:**
```json
{
  "message": "ะะพัะตัะฐะตะผะพััั ะพะฑะฝะพะฒะปะตะฝะฐ",
  "updated": 3
}
```

---

### 6.6. ะะฝะดะธะฒะธะดัะฐะปัะฝัะต ะทะฐะฝััะธั (IndividualLessons)

#### `GET /api/individual-lessons`

ะะพะปััะธัั ัะฟะธัะพะบ ะธะฝะดะธะฒะธะดัะฐะปัะฝัั ะทะฐะฝััะธะน.

**Query ะฟะฐัะฐะผะตััั:**
- `studioId` (optional): ะคะธะปััั ะฟะพ ัััะดะธะธ
- `clientId` (optional): ะคะธะปััั ะฟะพ ะบะปะธะตะฝัั
- `teacherId` (optional): ะคะธะปััั ะฟะพ ะฟัะตะฟะพะดะฐะฒะฐัะตะปั
- `dateFrom` (optional): ะคะธะปััั ั ะดะฐัั
- `dateTo` (optional): ะคะธะปััั ะดะพ ะดะฐัั
- `status` (optional): `SCHEDULED` | `COMPLETED` | `CANCELLED` | `NO_SHOW`

**Response 200:**
```json
{
  "lessons": [
    {
      "id": "uuid",
      "studioId": "uuid",
      "clientId": "uuid",
      "teacherId": "uuid",
      "roomId": "uuid",
      "date": "2024-11-13",
      "startTime": "10:00:00",
      "endTime": "11:00:00",
      "price": 2000.00,
      "status": "COMPLETED",
      "notes": "",
      "studio": { "id": "uuid", "name": "ะะพะบะฐะป" },
      "client": { "id": "uuid", "name": "ะะฒะฐะฝะพะฒะฐ ะะฐัะธั ะะตััะพะฒะฝะฐ" },
      "teacher": { "id": "uuid", "name": "ะกะธะดะพัะพะฒะฐ ะ.ะ." },
      "room": { "id": "uuid", "name": "ะะฐะป 3" },
      "createdAt": "2024-11-13T10:00:00Z",
      "updatedAt": "2024-11-13T11:10:00Z"
    }
  ]
}
```

---

#### `POST /api/individual-lessons`

ะกะพะทะดะฐัั ะธะฝะดะธะฒะธะดัะฐะปัะฝะพะต ะทะฐะฝััะธะต.

**Request Body:**
```json
{
  "studioId": "uuid",
  "clientId": "uuid",
  "teacherId": "uuid",
  "roomId": "uuid",
  "date": "2024-11-14",
  "startTime": "15:00:00",
  "endTime": "16:00:00",
  "price": 1500.00,
  "notes": ""
}
```

**Response 201:** ะกะพะทะดะฐะฝะฝะพะต ะทะฐะฝััะธะต

**Response 400:** ะัะธะฑะบะธ ะบะพะฝัะปะธะบัะฐ:
- ะะพะผะตัะตะฝะธะต ะทะฐะฝััะพ
- ะัะตะฟะพะดะฐะฒะฐัะตะปั ะทะฐะฝัั

---

#### `PATCH /api/individual-lessons/:id`

ะะฑะฝะพะฒะธัั ะธะฝะดะธะฒะธะดัะฐะปัะฝะพะต ะทะฐะฝััะธะต.

**Request Body:**
```json
{
  "status": "COMPLETED",
  "notes": "ะะฐะฝััะธะต ะฟัะพัะปะพ ััะฟะตัะฝะพ"
}
```

**Response 200:** ะะฑะฝะพะฒะปะตะฝะฝะพะต ะทะฐะฝััะธะต

---

### 6.7. ะััะตัั (Reports)

#### `GET /api/reports/studios/attendance`

ะััะตั ะฟะพ ะฟะพัะตัะฐะตะผะพััะธ ะณััะฟะฟ.

**Query ะฟะฐัะฐะผะตััั:**
- `studioId` (optional): ะคะธะปััั ะฟะพ ัััะดะธะธ
- `dateFrom` (required): ะะฐัะฐ ะฝะฐัะฐะปะฐ ะฟะตัะธะพะดะฐ
- `dateTo` (required): ะะฐัะฐ ะพะบะพะฝัะฐะฝะธั ะฟะตัะธะพะดะฐ

**Response 200:**
```json
{
  "period": {
    "from": "2024-11-01",
    "to": "2024-11-30"
  },
  "studios": [
    {
      "studioId": "uuid",
      "studioName": "ะขะฐะฝัั",
      "groups": [
        {
          "groupId": "uuid",
          "groupName": "ะะฐัะธะฝะฐััะธะต 5-7 ะปะตั",
          "totalScheduled": 40,
          "totalPresent": 32,
          "totalAbsent": 5,
          "totalSick": 3,
          "attendanceRate": 80
        }
      ]
    }
  ]
}
```

---

#### `GET /api/reports/studios/revenue`

ะััะตั ะฟะพ ะฒััััะบะต ัััะดะธะน.

**Query ะฟะฐัะฐะผะตััั:**
- `studioId` (optional): ะคะธะปััั ะฟะพ ัััะดะธะธ
- `dateFrom` (required): ะะฐัะฐ ะฝะฐัะฐะปะฐ ะฟะตัะธะพะดะฐ
- `dateTo` (required): ะะฐัะฐ ะพะบะพะฝัะฐะฝะธั ะฟะตัะธะพะดะฐ

**Response 200:**
```json
{
  "period": {
    "from": "2024-11-01",
    "to": "2024-11-30"
  },
  "studios": [
    {
      "studioId": "uuid",
      "studioName": "ะขะฐะฝัั",
      "totalRevenue": 250000.00,
      "subscriptions": 230000.00,
      "singleVisits": 15000.00,
      "individualLessons": 5000.00,
      "groups": [
        {
          "groupId": "uuid",
          "groupName": "ะะฐัะธะฝะฐััะธะต 5-7 ะปะตั",
          "revenue": 120000.00,
          "activeMembers": 12
        }
      ]
    }
  ]
}
```

---

#### `GET /api/reports/groups/capacity`

ะััะตั ะฟะพ ะทะฐะณััะถะตะฝะฝะพััะธ ะณััะฟะฟ.

**Query ะฟะฐัะฐะผะตััั:**
- `studioId` (optional): ะคะธะปััั ะฟะพ ัััะดะธะธ

**Response 200:**
```json
{
  "groups": [
    {
      "groupId": "uuid",
      "groupName": "ะะฐัะธะฝะฐััะธะต 5-7 ะปะตั",
      "studioName": "ะขะฐะฝัั",
      "maxParticipants": 15,
      "activeMembers": 12,
      "waitlistCount": 3,
      "capacityRate": 80,
      "status": "ACTIVE"
    },
    {
      "groupId": "uuid",
      "groupName": "ะัะพะดะฒะธะฝัััะต 8-12 ะปะตั",
      "studioName": "ะขะฐะฝัั",
      "maxParticipants": 15,
      "activeMembers": 15,
      "waitlistCount": 5,
      "capacityRate": 100,
      "status": "FULL"
    }
  ]
}
```

---

## 7. ะะฝัะตะณัะฐัะธะธ

### 7.1. ะะฝัะตะณัะฐัะธั ั ะผะพะดัะปะตะผ CRM

**ะัะฟะพะปัะทะพะฒะฐะฝะธะต:**
- ะะพะปััะตะฝะธะต ะดะฐะฝะฝัั ะบะปะธะตะฝัะพะฒ (Client) ะดะปั ะทะฐะฟะธัะธ ะฒ ะณััะฟะฟั
- ะะฑะฝะพะฒะปะตะฝะธะต ััะฐัััะฐ ะบะปะธะตะฝัะฐ (lastActivityAt) ะฟัะธ ะฟะพัะตัะตะฝะธะธ ะทะฐะฝััะธะน
- ะัะธะผะตะฝะตะฝะธะต ะปัะณะพัะฝัั ะบะฐัะตะณะพัะธะน ะบ ััะพะธะผะพััะธ ะฐะฑะพะฝะตะผะตะฝัะพะฒ

**ะกะฒัะทะธ:**
- `GroupMember.clientId` โ `Client.id`
- `Attendance.clientId` โ `Client.id`
- `IndividualLesson.clientId` โ `Client.id`

---

### 7.2. ะะฝัะตะณัะฐัะธั ั ะผะพะดัะปะตะผ ะะฐัะฟะธัะฐะฝะธั

**ะัะฟะพะปัะทะพะฒะฐะฝะธะต:**
- ะกะพะทะดะฐะฝะธะต ัะฐัะฟะธัะฐะฝะธั ะทะฐะฝััะธะน ะดะปั ะณััะฟะฟ (Schedule)
- ะัะพะฒะตัะบะฐ ะบะพะฝัะปะธะบัะพะฒ ะฟัะธ ัะพะทะดะฐะฝะธะธ ะธะฝะดะธะฒะธะดัะฐะปัะฝัั ะทะฐะฝััะธะน
- ะะฒัะพะผะฐัะธัะตัะบะพะต ัะพะทะดะฐะฝะธะต ะทะฐะฟะธัะตะน Attendance ะดะปั ะทะฐะฝััะธะน

**ะกะฒัะทะธ:**
- `Schedule.groupId` โ `Group.id`
- `Attendance.scheduleId` โ `Schedule.id`
- `IndividualLesson.roomId` โ `Room.id`

**ะัะพัะตัั:**
1. ะัะธ ัะพะทะดะฐะฝะธะธ ัะฐัะฟะธัะฐะฝะธั ะณััะฟะฟะพะฒัั ะทะฐะฝััะธะน (Schedule) ัะธััะตะผะฐ ะฐะฒัะพะผะฐัะธัะตัะบะธ ัะพะทะดะฐะตั ะทะฐะฟะธัะธ Attendance ะดะปั ะฒัะตั ะฐะบัะธะฒะฝัั ััะฐััะฝะธะบะพะฒ ะณััะฟะฟั (GroupMember ัะพ ััะฐัััะพะผ ACTIVE)
2. ะัะธ ัะพะทะดะฐะฝะธะธ ะธะฝะดะธะฒะธะดัะฐะปัะฝะพะณะพ ะทะฐะฝััะธั ัะธััะตะผะฐ ะฟัะพะฒะตััะตั ะบะพะฝัะปะธะบัั ั ะดััะณะธะผะธ ะทะฐะฝััะธัะผะธ ะฒ ัะพะผ ะถะต ะฟะพะผะตัะตะฝะธะธ

---

### 7.3. ะะฝัะตะณัะฐัะธั ั ะผะพะดัะปะตะผ ะะฑะพะฝะตะผะตะฝัะพะฒ

**ะัะฟะพะปัะทะพะฒะฐะฝะธะต:**
- ะัะพัะผะปะตะฝะธะต ะฐะฑะพะฝะตะผะตะฝัะพะฒ ะฟัะธ ะทะฐะฟะธัะธ ะฒ ะณััะฟะฟั
- ะกะฟะธัะฐะฝะธะต ะทะฐะฝััะธะน ั ะฐะฑะพะฝะตะผะตะฝัะฐ ะฟัะธ ะฟะพัะตัะตะฝะธะธ
- ะะฒัะพะผะฐัะธัะตัะบะพะต ะฟัะพะดะปะตะฝะธะต ะฐะฑะพะฝะตะผะตะฝัะพะฒ
- ะัะธะผะตะฝะตะฝะธะต ะปัะณะพั ะดะปั ะปัะณะพัะฝัั ะบะฐัะตะณะพัะธะน
- ะะพะผะฟะตะฝัะฐัะธั ะฟัะพะฟััะบะพะฒ ะฟะพ ะฑะพะปะตะทะฝะธ (ัะผะตะฝััะตะฝะธะต ััะพะธะผะพััะธ ัะปะตะดัััะตะณะพ ะผะตัััะฐ)

**ะกะฒัะทะธ:**
- `Subscription.groupId` โ `Group.id`
- `Subscription.clientId` โ `Client.id`
- ะกัะพะธะผะพััั ะฐะฑะพะฝะตะผะตะฝัะฐ ะฑะตัะตััั ะธะท ะฝะฐัััะพะตะบ ะณััะฟะฟั

**ะัะพัะตัั:**
1. ะัะธ ะทะฐะฟะธัะธ ะบะปะธะตะฝัะฐ ะฒ ะณััะฟะฟั (ะฟะพััะพัะฝะฝะฐั ะทะฐะฟะธัั) ะผะตะฝะตะดะถะตั ะพัะพัะผะปัะตั ะฐะฑะพะฝะตะผะตะฝั
2. ะัะธ ะพัะผะตัะบะต ะฟะพัะตัะฐะตะผะพััะธ (status = PRESENT) ัะธััะตะผะฐ ัะฟะธััะฒะฐะตั ะทะฐะฝััะธะต ั ะฐะฑะพะฝะตะผะตะฝัะฐ
3. ะัะธ ะฟัะพะฟััะบะต ะฟะพ ะฑะพะปะตะทะฝะธ (status = SICK / EXCUSED):
   - ะะฐะฝััะธะต ัะฟะธััะฒะฐะตััั
   - ะกัะพะธะผะพััั ะฟัะพะฟััะตะฝะฝะพะณะพ ะทะฐะฝััะธั ะดะพะฑะฐะฒะปัะตััั ะฒ ะบะพะผะฟะตะฝัะฐัะธั
   - ะัะธ ะฟัะพะดะปะตะฝะธะธ ะฐะฑะพะฝะตะผะตะฝัะฐ ััะพะธะผะพััั ัะผะตะฝััะฐะตััั ะฝะฐ ััะผะผั ะบะพะผะฟะตะฝัะฐัะธะธ

---

### 7.4. ะะฝัะตะณัะฐัะธั ั ะผะพะดัะปะตะผ ะะฟะปะฐัั

**ะัะฟะพะปัะทะพะฒะฐะฝะธะต:**
- ะะฟะปะฐัะฐ ะฐะฑะพะฝะตะผะตะฝัะพะฒ
- ะะฟะปะฐัะฐ ัะฐะทะพะฒัั ะฟะพัะตัะตะฝะธะน
- ะะฟะปะฐัะฐ ะธะฝะดะธะฒะธะดัะฐะปัะฝัั ะทะฐะฝััะธะน
- ะะพะทะฒัะฐั ััะตะดััะฒ ะฟัะธ ะพััะธัะปะตะฝะธะธ

**ะกะฒัะทะธ:**
- `Payment.subscriptionId` โ `Subscription.id`
- `Payment.clientId` โ `Client.id`

---

### 7.5. ะะฝัะตะณัะฐัะธั ั ะผะพะดัะปะตะผ ะะฐััะตัะฐ ะะ

**ะัะฟะพะปัะทะพะฒะฐะฝะธะต:**
- ะะฐััะตั ะทะฐัะฐะฑะพัะฝะพะน ะฟะปะฐัั ะฟัะตะฟะพะดะฐะฒะฐัะตะปะตะน (ะฟัะพัะตะฝั ะพั ะฒััััะบะธ ัััะดะธะธ)
- ะฃัะตั ะฟัะพะฒะตะดะตะฝะฝัั ะทะฐะฝััะธะน (ะณััะฟะฟะพะฒัั ะธ ะธะฝะดะธะฒะธะดัะฐะปัะฝัั)

**ะัะพัะตัั:**
1. ะกะธััะตะผะฐ ะตะถะตะผะตัััะฝะพ ัะฐัััะธััะฒะฐะตั ะฒััััะบั ะบะฐะถะดะพะน ัััะดะธะธ:
   ```typescript
   const studioRevenue = await calculateStudioRevenue(studioId, month);
   ```
2. ะะปั ะบะฐะถะดะพะณะพ ะฟัะตะฟะพะดะฐะฒะฐัะตะปั ัััะดะธะธ:
   ```typescript
   const teacherSalary = studioRevenue * (studioTeacher.salaryPercentage / 100);
   ```
3. ะกะพะทะดะฐะตััั ะทะฐะฟะธัั SalaryCalculation ะดะปั ะฟัะตะฟะพะดะฐะฒะฐัะตะปั

**ะะฐะฝะฝัะต:**
- ะััััะบะฐ ัััะดะธะธ (ะธะท ะฐะฑะพะฝะตะผะตะฝัะพะฒ, ัะฐะทะพะฒัั ะฟะพัะตัะตะฝะธะน, ะธะฝะดะธะฒะธะดัะฐะปัะฝัั ะทะฐะฝััะธะน)
- ะัะพัะตะฝั ะฟัะตะฟะพะดะฐะฒะฐัะตะปั (StudioTeacher.salaryPercentage)

---

### 7.6. ะะฝัะตะณัะฐัะธั ั ะผะพะดัะปะตะผ ะฃะฒะตะดะพะผะปะตะฝะธะน

**ะัะฟะพะปัะทะพะฒะฐะฝะธะต:**
- ะฃะฒะตะดะพะผะปะตะฝะธั ะบะปะธะตะฝัะพะฒ ะพ ะทะฐะฟะธัะธ ะฒ ะณััะฟะฟั
- ะฃะฒะตะดะพะผะปะตะฝะธั ะพ ัะฒะพะฑะพะดะฝะพะผ ะผะตััะต (ะปะธัั ะพะถะธะดะฐะฝะธั)
- ะฃะฒะตะดะพะผะปะตะฝะธั ะพะฑ ะพััะธัะปะตะฝะธะธ
- ะฃะฒะตะดะพะผะปะตะฝะธั ะฟัะตะฟะพะดะฐะฒะฐัะตะปะตะน ะพ ะฝะพะฒัั ะทะฐะฝััะธัั
- ะะฐะฟะพะผะธะฝะฐะฝะธั ะพ ะฟัะตะดััะพััะธั ะทะฐะฝััะธัั

**ะกะพะฑััะธั:**
- `GroupMemberCreated` โ ะบะปะธะตะฝั ะทะฐะฟะธัะฐะฝ ะฒ ะณััะฟะฟั
- `WaitlistSpotAvailable` โ ะฟะพัะฒะธะปะพัั ัะฒะพะฑะพะดะฝะพะต ะผะตััะพ
- `GroupMemberExpelled` โ ะบะปะธะตะฝั ะพััะธัะปะตะฝ
- `IndividualLessonScheduled` โ ะธะฝะดะธะฒะธะดัะฐะปัะฝะพะต ะทะฐะฝััะธะต ัะพะทะดะฐะฝะพ
- `IndividualLessonCancelled` โ ะธะฝะดะธะฒะธะดัะฐะปัะฝะพะต ะทะฐะฝััะธะต ะพัะผะตะฝะตะฝะพ

---

## 8. ะัะฐะฒะฐ ะดะพัััะฟะฐ

### 8.1. ะะดะผะธะฝะธัััะฐัะพั

**ะะพะปะฝัะน ะดะพัััะฟ:**
- ะกะพะทะดะฐะฝะธะต, ัะตะดะฐะบัะธัะพะฒะฐะฝะธะต, ะทะฐะบัััะธะต ะฝะฐะฟัะฐะฒะปะตะฝะธะน, ัััะดะธะน, ะณััะฟะฟ
- ะะฐะทะฝะฐัะตะฝะธะต ะฟัะตะฟะพะดะฐะฒะฐัะตะปะตะน
- ะฃะฟัะฐะฒะปะตะฝะธะต ััะฐััะฝะธะบะฐะผะธ ะณััะฟะฟ (ะทะฐะฟะธัั, ะฟะตัะตะฒะพะด, ะพััะธัะปะตะฝะธะต)
- ะัะพัะผะพัั ะฒัะตั ะพััะตัะพะฒ
- ะะฐัััะพะนะบะฐ ัะตะฝะพะพะฑัะฐะทะพะฒะฐะฝะธั

---

### 8.2. ะะตะฝะตะดะถะตั/ะะตะณะธัััะฐัะพั

**ะะพัััะฟ:**
- ะัะพัะผะพัั ะฝะฐะฟัะฐะฒะปะตะฝะธะน, ัััะดะธะน, ะณััะฟะฟ (ะฑะตะท ัะตะดะฐะบัะธัะพะฒะฐะฝะธั)
- ะะฐะฟะธัั ะบะปะธะตะฝัะพะฒ ะฒ ะณััะฟะฟั
- ะฃะฟัะฐะฒะปะตะฝะธะต ััะฐััะฝะธะบะฐะผะธ ะณััะฟะฟ (ะฟะตัะตะฒะพะด, ะพััะธัะปะตะฝะธะต)
- ะะตะดะตะฝะธะต ะปะธััะฐ ะพะถะธะดะฐะฝะธั
- ะัะพัะผะปะตะฝะธะต ะฐะฑะพะฝะตะผะตะฝัะพะฒ
- ะัะพัะผะพัั ะพััะตัะพะฒ ะฟะพ ัะฒะพะตะน ะทะพะฝะต ะพัะฒะตัััะฒะตะฝะฝะพััะธ

**ะะณัะฐะฝะธัะตะฝะธั:**
- ะะต ะผะพะถะตั ัะพะทะดะฐะฒะฐัั/ัะตะดะฐะบัะธัะพะฒะฐัั ัััะดะธะธ ะธ ะณััะฟะฟั
- ะะต ะผะพะถะตั ะฝะฐะทะฝะฐัะฐัั ะฟัะตะฟะพะดะฐะฒะฐัะตะปะตะน
- ะะต ะผะพะถะตั ะธะทะผะตะฝััั ััะพะธะผะพััั

---

### 8.3. ะัะตะฟะพะดะฐะฒะฐัะตะปั

**ะะพัััะฟ:**
- ะัะพัะผะพัั ัะฐัะฟะธัะฐะฝะธั ัะฒะพะธั ะณััะฟะฟ ะธ ะธะฝะดะธะฒะธะดัะฐะปัะฝัั ะทะฐะฝััะธะน
- ะัะผะตัะบะฐ ะฟะพัะตัะฐะตะผะพััะธ ะฒ ะถััะฝะฐะปะต
- ะัะพัะผะพัั ัะฟะธัะบะพะฒ ัะฒะพะธั ะณััะฟะฟ
- ะะพะฑะฐะฒะปะตะฝะธะต ะบะพะผะผะตะฝัะฐัะธะตะฒ ะฟะพ ะทะฐะฝััะธัะผ
- ะัะพัะผะพัั ััะฐัะธััะธะบะธ ะฟะพ ัะฒะพะธะผ ะณััะฟะฟะฐะผ

**ะะณัะฐะฝะธัะตะฝะธั:**
- ะะต ะผะพะถะตั ัะตะดะฐะบัะธัะพะฒะฐัั ะณััะฟะฟั
- ะะต ะผะพะถะตั ะทะฐะฟะธััะฒะฐัั/ะพััะธัะปััั ััะฐััะฝะธะบะพะฒ
- ะะต ะผะพะถะตั ะฟัะพัะผะฐััะธะฒะฐัั ัะธะฝะฐะฝัะพะฒัั ะธะฝัะพัะผะฐัะธั (ะบัะพะผะต ัะฒะพะตะน ะะ)

---

## 9. ะะพะฟะพะปะฝะธัะตะปัะฝัะต ััะฝะบัะธะธ

### 9.1. ะะผะฟะพัั ะณััะฟะฟ ะธ ััะฐััะฝะธะบะพะฒ ะธะท Excel

**ะคะพัะผะฐั ัะฐะนะปะฐ:**
```
| ะะฐะฟัะฐะฒะปะตะฝะธะต | ะกััะดะธั | ะััะฟะฟะฐ | ะฃัะพะฒะตะฝั | ะะพะทัะฐัั | ะะฐะบั. ััะฐััะฝะธะบะพะฒ | ะกัะพะธะผะพััั ัะฐะทะพะฒะพะณะพ |
|-------------|--------|--------|---------|---------|------------------|--------------------|
| ะกะฟะพัั       | ะขะฐะฝัั  | ะะฐัะธะฝะฐััะธะต 5-7 | ะะฐัะธะฝะฐััะธะต | 5-7 ะปะตั | 15 | 500 |
```

**ะัะพัะตัั:**
1. ะะพะปัะทะพะฒะฐัะตะปั ะทะฐะณััะถะฐะตั Excel-ัะฐะนะป
2. ะกะธััะตะผะฐ ะฒะฐะปะธะดะธััะตั ะดะฐะฝะฝัะต
3. ะกะธััะตะผะฐ ัะพะทะดะฐะตั/ะพะฑะฝะพะฒะปัะตั ะฝะฐะฟัะฐะฒะปะตะฝะธั, ัััะดะธะธ, ะณััะฟะฟั
4. ะกะธััะตะผะฐ ะฟะพะบะฐะทัะฒะฐะตั ะพััะตั (ััะฟะตัะฝะพ / ะพัะธะฑะบะธ)

---

### 9.2. ะญะบัะฟะพัั ะดะฐะฝะฝัั

**ะะพัััะฟะฝัะต ัะพัะผะฐัั:**
- Excel (.xlsx)
- CSV (.csv)
- PDF (ะดะปั ะพััะตัะพะฒ)

**ะญะบัะฟะพััะธััะตะผัะต ะดะฐะฝะฝัะต:**
- ะกะฟะธัะพะบ ะณััะฟะฟ ั ััะฐััะฝะธะบะฐะผะธ
- ะััะฝะฐะป ะฟะพัะตัะฐะตะผะพััะธ
- ะััะตัั ะฟะพ ะฟะพัะตัะฐะตะผะพััะธ ะธ ะฒััััะบะต

---

### 9.3. ะะฒัะพะผะฐัะธัะตัะบะธะต ะฝะฐะฟะพะผะธะฝะฐะฝะธั

**ะะฐัััะฐะธะฒะฐะตะผัะต ัะฒะตะดะพะผะปะตะฝะธั:**
- ะะฐ 24 ัะฐัะฐ ะดะพ ะทะฐะฝััะธั (email/SMS ะบะปะธะตะฝัั)
- ะะฐ 1 ัะฐั ะดะพ ะทะฐะฝััะธั (push-ัะฒะตะดะพะผะปะตะฝะธะต ะฟัะตะฟะพะดะฐะฒะฐัะตะปั)
- ะะถะตะฝะตะดะตะปัะฝะฐั ัะฒะพะดะบะฐ ะฟะพัะตัะฐะตะผะพััะธ (email ะฟัะตะฟะพะดะฐะฒะฐัะตะปั)
- ะะถะตะผะตัััะฝัะน ะพััะตั ะฟะพ ะณััะฟะฟะฐะผ (email ะฐะดะผะธะฝะธัััะฐัะพัั)

---

### 9.4. ะกัะฐัะธััะธะบะฐ ะธ ะฐะฝะฐะปะธัะธะบะฐ

**ะะฐัะฑะพัะด ะดะปั ะฐะดะผะธะฝะธัััะฐัะพัะฐ:**
- ะขะพะฟ-5 ัะฐะผัั ะฟะพะฟัะปััะฝัั ัััะดะธะน (ะฟะพ ะบะพะปะธัะตััะฒั ััะฐััะฝะธะบะพะฒ)
- ะขะพะฟ-5 ัััะดะธะน ะฟะพ ะฒััััะบะต
- ะกัะตะดะฝัั ะฟะพัะตัะฐะตะผะพััั ะฟะพ ะฒัะตะผ ะณััะฟะฟะฐะผ
- ะะธะฝะฐะผะธะบะฐ ะฝะฐะฑะพัะฐ ััะฐััะฝะธะบะพะฒ (ะณัะฐัะธะบ ะฟะพ ะผะตัััะฐะผ)
- ะัะตะฟะพะดะฐะฒะฐัะตะปะธ ั ะปัััะตะน ะฟะพัะตัะฐะตะผะพัััั

**ะะฐัะฑะพัะด ะดะปั ะฟัะตะฟะพะดะฐะฒะฐัะตะปั:**
- ะะพั ััะตะดะฝัั ะฟะพัะตัะฐะตะผะพััั
- ะะพะธ ะณััะฟะฟั (ัะฟะธัะพะบ ั ะบะปััะตะฒัะผะธ ะผะตััะธะบะฐะผะธ)
- ะะปะธะถะฐะนัะธะต ะทะฐะฝััะธั
- ะัะตะดััะพััะธะต ะธะฝะดะธะฒะธะดัะฐะปัะฝัะต ะทะฐะฝััะธั

---

## 10. ะขะตัะฝะธัะตัะบะธะต ะดะตัะฐะปะธ

### 10.1. ะะฝะดะตะบัั ะฑะฐะทั ะดะฐะฝะฝัั

**ะัะธัะธัะฝัะต ะธะฝะดะตะบัั ะดะปั ะฟัะพะธะทะฒะพะดะธัะตะปัะฝะพััะธ:**

```sql
-- ะะปั ะฑััััะพะณะพ ะฟะพะธัะบะฐ ะณััะฟะฟ ะฟะพ ัััะดะธะธ
CREATE INDEX idx_groups_studio_id ON groups(studio_id);

-- ะะปั ะฑััััะพะณะพ ะฟะพะธัะบะฐ ััะฐััะฝะธะบะพะฒ ะฟะพ ะณััะฟะฟะต
CREATE INDEX idx_group_members_group_id ON group_members(group_id);
CREATE INDEX idx_group_members_client_id ON group_members(client_id);
CREATE INDEX idx_group_members_status ON group_members(status);

-- ะะปั ะฑััััะพะณะพ ะฟะพะธัะบะฐ ะฟะพัะตัะฐะตะผะพััะธ
CREATE INDEX idx_attendances_schedule_id ON attendances(schedule_id);
CREATE INDEX idx_attendances_client_id ON attendances(client_id);
CREATE INDEX idx_attendances_status ON attendances(status);

-- ะะปั ะฑััััะพะณะพ ะฟะพะธัะบะฐ ะธะฝะดะธะฒะธะดัะฐะปัะฝัั ะทะฐะฝััะธะน
CREATE INDEX idx_individual_lessons_client_id ON individual_lessons(client_id);
CREATE INDEX idx_individual_lessons_teacher_id ON individual_lessons(teacher_id);
CREATE INDEX idx_individual_lessons_date ON individual_lessons(date);
```

---

### 10.2. ะััะธัะพะฒะฐะฝะธะต

**ะััะธััะตะผัะต ะดะฐะฝะฝัะต:**
- ะกะฟะธัะพะบ ะฝะฐะฟัะฐะฒะปะตะฝะธะน ะธ ัััะดะธะน (TTL = 1 ัะฐั)
- ะกะฟะธัะพะบ ะณััะฟะฟ ะฟะพ ัััะดะธะธ (TTL = 30 ะผะธะฝัั)
- ะะพะปะธัะตััะฒะพ ะฐะบัะธะฒะฝัั ััะฐััะฝะธะบะพะฒ ะฒ ะณััะฟะฟะต (TTL = 5 ะผะธะฝัั)

**ะะฝะฒะฐะปะธะดะฐัะธั ะบััะฐ:**
- ะัะธ ัะพะทะดะฐะฝะธะธ/ะพะฑะฝะพะฒะปะตะฝะธะธ ะฝะฐะฟัะฐะฒะปะตะฝะธั, ัััะดะธะธ, ะณััะฟะฟั
- ะัะธ ะทะฐะฟะธัะธ/ะพััะธัะปะตะฝะธะธ ััะฐััะฝะธะบะฐ

---

### 10.3. ะะฟัะธะผะธะทะฐัะธั ะทะฐะฟัะพัะพะฒ

**ะัะพะฑะปะตะผะฝัะต ะทะฐะฟัะพัั:**

1. **ะะพะปััะตะฝะธะต ัะฟะธัะบะฐ ะณััะฟะฟ ั ะบะพะปะธัะตััะฒะพะผ ััะฐััะฝะธะบะพะฒ:**
   ```typescript
   // ะะปะพัะพ: N+1 ะทะฐะฟัะพั
   const groups = await prisma.group.findMany();
   for (const group of groups) {
     const count = await prisma.groupMember.count({
       where: { groupId: group.id, status: 'ACTIVE' },
     });
   }

   // ะฅะพัะพัะพ: ะพะดะธะฝ ะทะฐะฟัะพั ั ะฐะณัะตะณะฐัะธะตะน
   const groups = await prisma.group.findMany({
     include: {
       _count: {
         select: { members: { where: { status: 'ACTIVE' } } },
       },
     },
   });
   ```

2. **ะะพะปััะตะฝะธะต ะถััะฝะฐะปะฐ ะฟะพัะตัะฐะตะผะพััะธ:**
   ```typescript
   // ะัะฟะพะปัะทัะตะผ JOIN ะดะปั ะฟะพะปััะตะฝะธั ะดะฐะฝะฝัั ะบะปะธะตะฝัะฐ ััะฐะทั
   const attendances = await prisma.attendance.findMany({
     where: { scheduleId },
     include: {
       client: {
         select: {
           id: true,
           lastName: true,
           firstName: true,
           middleName: true,
         },
       },
     },
   });
   ```

---

### 10.4. ะคะพะฝะพะฒัะต ะทะฐะดะฐัะธ (Cron Jobs)

**ะะถะตะดะฝะตะฒะฝัะต ะทะฐะดะฐัะธ:**
- ะะฒัะพะผะฐัะธัะตัะบะพะต ะพััะธัะปะตะฝะธะต ะทะฐ ะฝะตัะฟะปะฐัั (ะฟัะพะฒะตัะบะฐ ะฟัะพััะพัะตะฝะฝัั ะฐะฑะพะฝะตะผะตะฝัะพะฒ > 14 ะดะฝะตะน)
- ะัะฟัะฐะฒะบะฐ ะฝะฐะฟะพะผะธะฝะฐะฝะธะน ะพ ะฟัะตะดััะพััะธั ะทะฐะฝััะธัั

**ะะถะตะฝะตะดะตะปัะฝัะต ะทะฐะดะฐัะธ:**
- ะัะฟัะฐะฒะบะฐ ัะฒะพะดะบะธ ะฟะพัะตัะฐะตะผะพััะธ ะฟัะตะฟะพะดะฐะฒะฐัะตะปัะผ

**ะะถะตะผะตัััะฝัะต ะทะฐะดะฐัะธ:**
- ะะฐััะตั ะทะฐัะฐะฑะพัะฝะพะน ะฟะปะฐัั ะฟัะตะฟะพะดะฐะฒะฐัะตะปะตะน
- ะัะฟัะฐะฒะบะฐ ะพััะตัะฐ ะฐะดะผะธะฝะธัััะฐัะพัั

---

## 11. ะัะธะผะตัั ะธัะฟะพะปัะทะพะฒะฐะฝะธั

### 11.1. ะะฐะฟะธัั ะฝะพะฒะพะณะพ ะบะปะธะตะฝัะฐ ะฒ ะณััะฟะฟั

```typescript
// 1. ะะฐะนัะธ ะบะปะธะตะฝัะฐ
const client = await findClientByPhone('+79001234567');

// 2. ะะฐะนัะธ ะณััะฟะฟั
const group = await findGroupById('group-uuid');

// 3. ะัะพะฒะตัะธัั ะดะพัััะฟะฝะพััั ะผะตัั
const activeCount = await countActiveMembers(group.id);
if (activeCount >= group.maxParticipants) {
  // ะัะตะดะปะพะถะธัั ะปะธัั ะพะถะธะดะฐะฝะธั
  const waitlistPosition = await getNextWaitlistPosition(group.id);
  await createGroupMember({
    groupId: group.id,
    clientId: client.id,
    status: 'WAITLIST',
    waitlistPosition,
  });
  return { status: 'waitlisted', position: waitlistPosition };
}

// 4. ะะฐะฟะธัะฐัั ะฒ ะณััะฟะฟั
const member = await createGroupMember({
  groupId: group.id,
  clientId: client.id,
  status: 'ACTIVE',
});

// 5. ะกะพะทะดะฐัั ะทะฐะฟะธัะธ ะฟะพัะตัะฐะตะผะพััะธ ะดะปั ะฑัะดััะธั ะทะฐะฝััะธะน
const futureSchedules = await findFutureSchedules(group.id);
for (const schedule of futureSchedules) {
  await createAttendance({
    scheduleId: schedule.id,
    clientId: client.id,
    status: 'SCHEDULED',
  });
}

// 6. ะัะฟัะฐะฒะธัั ัะฒะตะดะพะผะปะตะฝะธะต ะบะปะธะตะฝัั
await sendNotification(client.id, {
  type: 'GROUP_ENROLLED',
  data: { groupName: group.name },
});

return { status: 'enrolled', member };
```

---

### 11.2. ะัะผะตัะบะฐ ะฟะพัะตัะฐะตะผะพััะธ ะฟัะตะฟะพะดะฐะฒะฐัะตะปะตะผ

```typescript
// 1. ะะพะปััะธัั ัะฟะธัะพะบ ััะฐััะฝะธะบะพะฒ ะดะปั ะทะฐะฝััะธั
const attendances = await findAttendancesBySchedule(scheduleId);

// 2. ะะฐััะพะฒะพ ะพะฑะฝะพะฒะธัั ััะฐัััั
await updateAttendancesBulk([
  { id: 'att-1', status: 'PRESENT', notes: '' },
  { id: 'att-2', status: 'ABSENT', notes: '' },
  { id: 'att-3', status: 'SICK', notes: 'ะะพะปะตะป, ะตััั ัะฟัะฐะฒะบะฐ' },
]);

// 3. ะะปั ะบะฐะถะดะพะน ะทะฐะฟะธัะธ ัะพ ััะฐัััะพะผ SICK/EXCUSED ัะพะทะดะฐัั ะบะพะผะฟะตะฝัะฐัะธั
const sickAttendances = attendances.filter(a => ['SICK', 'EXCUSED'].includes(a.status));
for (const attendance of sickAttendances) {
  const lessonPrice = await calculateLessonPrice(attendance.scheduleId);
  await createCompensation({
    clientId: attendance.clientId,
    amount: lessonPrice,
    reason: `ะัะพะฟััะบ ะฟะพ ะฑะพะปะตะทะฝะธ: ${attendance.schedule.date}`,
  });
}

// 4. ะะฑะฝะพะฒะธัั lastActivityAt ะดะปั ะบะปะธะตะฝัะพะฒ ั PRESENT
const presentClients = attendances.filter(a => a.status === 'PRESENT').map(a => a.clientId);
await updateClientsActivity(presentClients, new Date());
```

---

### 11.3. ะะฐะฑะพัะฐ ั ะปะธััะพะผ ะพะถะธะดะฐะฝะธั

```typescript
// 1. ะะปะธะตะฝั ะพััะธัะปะตะฝ ะธะท ะณััะฟะฟั
await updateGroupMember(memberId, { status: 'EXPELLED', leftAt: new Date() });

// 2. ะัะพะฒะตัะธัั ะดะพัััะฟะฝะพััั ะผะตัั
const activeCount = await countActiveMembers(groupId);
const group = await findGroupById(groupId);

if (activeCount < group.maxParticipants) {
  // 3. ะะฐะนัะธ ะฟะตัะฒะพะณะพ ะฒ ะปะธััะต ะพะถะธะดะฐะฝะธั
  const firstInWaitlist = await findFirstWaitlistMember(groupId);

  if (firstInWaitlist) {
    // 4. ะัะฟัะฐะฒะธัั ัะฒะตะดะพะผะปะตะฝะธะต
    await sendNotification(firstInWaitlist.clientId, {
      type: 'WAITLIST_SPOT_AVAILABLE',
      data: { groupName: group.name },
    });

    // 5. ะะตะฝะตะดะถะตั ะฒัััะฝัั ะฟะตัะตะฒะพะดะธั ะบะปะธะตะฝัะฐ ะฟะพัะปะต ะฟะพะดัะฒะตัะถะดะตะฝะธั
    // (ะธะปะธ ะผะพะถะฝะพ ะฐะฒัะพะผะฐัะธัะตัะบะธ ัะตัะตะท N ะดะฝะตะน ะฑะตะท ะพัะฒะตัะฐ)
  }
}
```

---

## 12. ะะพะทะผะพะถะฝัะต ัะฐััะธัะตะฝะธั

### 12.1. ะะตะนัะธะฝะณ ะฟัะตะฟะพะดะฐะฒะฐัะตะปะตะน

ะะพะฑะฐะฒะธัั ะฒะพะทะผะพะถะฝะพััั ะบะปะธะตะฝัะฐะผ ะพัะตะฝะธะฒะฐัั ะฟัะตะฟะพะดะฐะฒะฐัะตะปะตะน ะฟะพัะปะต ะทะฐะฝััะธะน.

**ะกัััะบัััะฐ ะดะฐะฝะฝัั:**
```prisma
model TeacherRating {
  id          String   @id @default(uuid())
  teacherId   String   @map("teacher_id")
  clientId    String   @map("client_id")
  scheduleId  String   @map("schedule_id")
  rating      Int      // 1-5
  comment     String?  @db.Text

  teacher     Teacher  @relation(fields: [teacherId], references: [id])
  client      Client   @relation(fields: [clientId], references: [id])
  schedule    Schedule @relation(fields: [scheduleId], references: [id])

  createdAt   DateTime @default(now())

  @@map("teacher_ratings")
  @@unique([scheduleId, clientId])
}
```

---

### 12.2. ะะพััะธะถะตะฝะธั ะธ ะฝะฐะณัะฐะดั

Gamification ะดะปั ะผะพัะธะฒะฐัะธะธ ะบะปะธะตะฝัะพะฒ.

**ะัะธะผะตัั ะดะพััะธะถะตะฝะธะน:**
- "10 ะทะฐะฝััะธะน ะฟะพะดััะด ะฑะตะท ะฟัะพะฟััะบะพะฒ"
- "50 ะฟะพัะตัะตะฝะฝัั ะทะฐะฝััะธะน"
- "ะะพะด ะฒ ัััะดะธะธ"

---

### 12.3. ะะธะดะตะพ-ััะพะบะธ ะธ ะทะฐะฟะธัะธ ะทะฐะฝััะธะน

ะฅัะฐะฝะตะฝะธะต ะทะฐะฟะธัะตะน ะทะฐะฝััะธะน ะดะปั ะบะปะธะตะฝัะพะฒ, ะบะพัะพััะต ะฟัะพะฟัััะธะปะธ.

**ะกัััะบัััะฐ ะดะฐะฝะฝัั:**
```prisma
model LessonRecording {
  id          String   @id @default(uuid())
  scheduleId  String   @map("schedule_id")
  videoUrl    String   @map("video_url")
  duration    Int      // ะฒ ัะตะบัะฝะดะฐั

  schedule    Schedule @relation(fields: [scheduleId], references: [id])

  createdAt   DateTime @default(now())

  @@map("lesson_recordings")
}
```

---

## ะะฐะบะปััะตะฝะธะต

ะะพะดัะปั **ะกััะดะธะธ ะธ ัะตะบัะธะธ** ะพะฑะตัะฟะตัะธะฒะฐะตั ะฟะพะปะฝัะน ัะธะบะป ัะฟัะฐะฒะปะตะฝะธั ะพะฑัะฐะทะพะฒะฐัะตะปัะฝะพะน ะดะตััะตะปัะฝะพัััั ะบัะปััััะฝะพะณะพ ัะตะฝััะฐ:

- โ ะะธะฑะบะฐั ะธะตัะฐััะธั (ะะฐะฟัะฐะฒะปะตะฝะธะต โ ะกััะดะธั โ ะััะฟะฟะฐ)
- โ ะะพััะพัะฝะฝะฐั ะธ ัะฐะทะพะฒะฐั ะทะฐะฟะธัั ะบะปะธะตะฝัะพะฒ
- โ ะะพะผะฑะธะฝะธัะพะฒะฐะฝะฝัะน ััะตั ะฟะพัะตัะฐะตะผะพััะธ
- โ ะะธัั ะพะถะธะดะฐะฝะธั ั ะฐะฒัะพัะฒะตะดะพะผะปะตะฝะธัะผะธ
- โ ะะฝะดะธะฒะธะดัะฐะปัะฝัะต ะทะฐะฝััะธั
- โ ะะฝัะตะณัะฐัะธั ั ะผะพะดัะปัะผะธ CRM, ะะฐัะฟะธัะฐะฝะธั, ะะฑะพะฝะตะผะตะฝัะพะฒ, ะะ
- โ ะััะตัะฝะพััั ะธ ะฐะฝะฐะปะธัะธะบะฐ

ะญัะพั ะผะพะดัะปั ัะฒะปัะตััั ัะตะฝััะฐะปัะฝัะผ ะดะปั ัะฐะฑะพัั ะบัะปััััะฝะพะณะพ ัะตะฝััะฐ ะธ ัะตัะฝะพ ะธะฝัะตะณัะธัะพะฒะฐะฝ ัะพ ะฒัะตะผะธ ะพััะฐะปัะฝัะผะธ ะผะพะดัะปัะผะธ ัะธััะตะผั.

---

**ะกะปะตะดัััะธะน ะผะพะดัะปั:** [04_SUBSCRIPTIONS_MODULE.md](./04_SUBSCRIPTIONS_MODULE.md) โ ะะพะดัะปั ะะฑะพะฝะตะผะตะฝัะพะฒ
