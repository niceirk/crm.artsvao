---

# üìÑ –¢–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ –∑–∞–¥–∞–Ω–∏–µ

## –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è Telegram-–±–æ—Ç–∞ —Å CRM (–º–æ–¥—É–ª—å –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏–π ‚Äú–±–æ—Ç ‚Üî CRM‚Äù)

---

## 1. –¶–µ–ª–∏ –∏ –∑–∞–¥–∞—á–∏

**–¶–µ–ª—å:**
–°–æ–∑–¥–∞—Ç—å –µ–¥–∏–Ω—ã–π –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏–æ–Ω–Ω—ã–π –º–æ–¥—É–ª—å ‚Äú–∫–ª–∏–µ–Ω—Ç ‚Üî CRM‚Äù —á–µ—Ä–µ–∑ Telegram-–±–æ—Ç, –ø–æ–∑–≤–æ–ª—è—é—â–∏–π:

* –ø—Ä–∏–Ω–∏–º–∞—Ç—å —Å–æ–æ–±—â–µ–Ω–∏—è –∫–ª–∏–µ–Ω—Ç–æ–≤;
* –æ–±–µ—Å–ø–µ—á–∏–≤–∞—Ç—å –ø–µ—Ä–µ–ø–∏—Å–∫—É ‚Äú–∫–ª–∏–µ–Ω—Ç ‚Üî –º–µ–Ω–µ–¥–∂–µ—Ä‚Äù –≤–Ω—É—Ç—Ä–∏ CRM;
* –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ —Å–æ–±—ã—Ç–∏—è—Ö –≤ CRM;
* —Ö—Ä–∞–Ω–∏—Ç—å –∏—Å—Ç–æ—Ä–∏—é —Å–æ–æ–±—â–µ–Ω–∏–π –±–µ—Å—Å—Ä–æ—á–Ω–æ;
* –ø—Ä–∏–≤—è–∑—ã–≤–∞—Ç—å –∏–ª–∏ —Å–æ–∑–¥–∞–≤–∞—Ç—å –∫–∞—Ä—Ç–æ—á–∫–∏ –∫–ª–∏–µ–Ω—Ç–æ–≤ –Ω–∞ –æ—Å–Ω–æ–≤–µ –¥–∏–∞–ª–æ–≥–æ–≤.

**–ó–∞–¥–∞—á–∏ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏:**

1. –ü—Ä–∏—ë–º –∏ –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π –∏–∑ Telegram —á–µ—Ä–µ–∑ webhook.
2. –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏–π –º–µ–Ω–µ–¥–∂–µ—Ä–∞–º –≤ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ CRM.
3. –û—Ç–≤–µ—Ç –º–µ–Ω–µ–¥–∂–µ—Ä–∞ —Å –¥–æ—Å—Ç–∞–≤–∫–æ–π –∫–ª–∏–µ–Ω—Ç—É –≤ Telegram.
4. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–∏–≤—è–∑–∫–∞ Telegram-–∞–∫–∫–∞—É–Ω—Ç–∞ –∫ –∫–ª–∏–µ–Ω—Ç—É –∏–ª–∏ —Ä—É—á–Ω–∞—è –ø—Ä–∏–≤—è–∑–∫–∞ –º–µ–Ω–µ–¥–∂–µ—Ä–æ–º.
5. –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å —Å–æ–∑–¥–∞–Ω–∏—è –Ω–æ–≤–æ–π –∫–∞—Ä—Ç–æ—á–∫–∏ –∫–ª–∏–µ–Ω—Ç–∞ –∏–∑ –¥–∏–∞–ª–æ–≥–∞.
6. –û—Ç–ø—Ä–∞–≤–∫–∞ —Å–∏—Å—Ç–µ–º–Ω—ã—Ö —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –ø–æ —Å–æ–±—ã—Ç–∏—è–º CRM (–æ–ø–ª–∞—Ç–∞, –∑–∞–ø–∏—Å—å, —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ).
7. –í–µ–¥–µ–Ω–∏–µ –ª–æ–≥–æ–≤ –¥–µ–π—Å—Ç–≤–∏–π –º–µ–Ω–µ–¥–∂–µ—Ä–æ–≤.
8. –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –æ—Ç–∫–ª—é—á–µ–Ω–∏—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π (–º–µ–Ω–µ–¥–∂–µ—Ä–æ–º –∏–ª–∏ –∫–ª–∏–µ–Ω—Ç–æ–º).

---

## 2. –û—Å–Ω–æ–≤–Ω—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏

### 2.1. –ö–ª–∏–µ–Ω—Ç —Å–∫–∞–Ω–∏—Ä—É–µ—Ç –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–π QR-–∫–æ–¥

1. –í CRM –µ—Å—Ç—å `client_id`.
2. –§–æ—Ä–º–∏—Ä—É–µ—Ç—Å—è –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω–∞—è —Å—Å—ã–ª–∫–∞:
   `https://t.me/<bot_username>?start=client_<client_id>`.
3. –ò–∑ —Å—Å—ã–ª–∫–∏ –º–æ–∂–µ—Ç –±—ã—Ç—å —Å—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω QR-–∫–æ–¥ (–Ω–∞ –∫–≤–∏—Ç–∞–Ω—Ü–∏–∏, –≤ —Å–æ–æ–±—â–µ–Ω–∏–∏, –≤ –õ–ö –∏ —Ç.–ø.).
4. –ö–ª–∏–µ–Ω—Ç —Å–∫–∞–Ω–∏—Ä—É–µ—Ç QR, –Ω–∞–∂–∏–º–∞–µ—Ç **Start** –∏ –ø–∏—à–µ—Ç –≤ –±–æ—Ç–∞.
5. Webhook CRM:

   * –ø–æ–ª—É—á–∞–µ—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä `start` –∏ –∏–∑–≤–ª–µ–∫–∞–µ—Ç `client_id`;
   * —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç/–æ–±–Ω–æ–≤–ª—è–µ—Ç –ø—Ä–∏–≤—è–∑–∫—É Telegram –∫ –∫–ª–∏–µ–Ω—Ç—É (`telegram_accounts`);
   * —Å–æ–∑–¥–∞—ë—Ç –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π `conversation` –¥–ª—è –¥–∞–Ω–Ω–æ–≥–æ –∫–ª–∏–µ–Ω—Ç–∞;
   * —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –≤—Ö–æ–¥—è—â–µ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –∫–∞–∫ `inbound`.
6. –î–∏–∞–ª–æ–≥ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –º–µ–Ω–µ–¥–∂–µ—Ä–∞–º —Å –§–ò–û –∫–ª–∏–µ–Ω—Ç–∞ –∏ –¥—Ä—É–≥–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –∏–∑ CRM.

---

### 2.2. –ö–ª–∏–µ–Ω—Ç —Å–∫–∞–Ω–∏—Ä—É–µ—Ç –æ–±—â–∏–π QR (–∫–ª–∏–µ–Ω—Ç –Ω–µ–∏–∑–≤–µ—Å—Ç–µ–Ω)

1. –û–±—â–∏–π QR –≤–µ–¥—ë—Ç –Ω–∞ –±–æ—Ç–∞ –±–µ–∑ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –∏–ª–∏ —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–º `?start=welcome`.
2. –ü–æ—Å–ª–µ —Å—Ç–∞—Ä—Ç–æ–≤–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è –±–æ—Ç –ø—Ä–µ–¥–ª–∞–≥–∞–µ—Ç –ø—Ä–æ–π—Ç–∏ –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é (—Å–º. —Ä–∞–∑–¥–µ–ª 10).
3. –ï—Å–ª–∏ –∫–ª–∏–µ–Ω—Ç –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –¥–∞–Ω–Ω—ã–µ (—Ç–µ–ª–µ—Ñ–æ–Ω), CRM –ø—ã—Ç–∞–µ—Ç—Å—è –Ω–∞–π—Ç–∏ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â—É—é –∫–∞—Ä—Ç–æ—á–∫—É –∫–ª–∏–µ–Ω—Ç–∞:

   * –µ—Å–ª–∏ –∫–ª–∏–µ–Ω—Ç –Ω–∞–π–¥–µ–Ω ‚Äî –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –ø—Ä–∏–≤—è–∑–∫–∞;
   * –µ—Å–ª–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω ‚Äî —Å–æ–∑–¥–∞—ë—Ç—Å—è ‚Äú–Ω–µ–ø—Ä–∏–≤—è–∑–∞–Ω–Ω—ã–π –¥–∏–∞–ª–æ–≥‚Äù, —Å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å—é –º–µ–Ω–µ–¥–∂–µ—Ä—É —Å–æ–∑–¥–∞—Ç—å –∫–∞—Ä—Ç–æ—á–∫—É –∫–ª–∏–µ–Ω—Ç–∞.
4. –ú–µ–Ω–µ–¥–∂–µ—Ä –º–æ–∂–µ—Ç:

   * –≤—Ä—É—á–Ω—É—é –ø—Ä–∏–≤—è–∑–∞—Ç—å –¥–∏–∞–ª–æ–≥ –∫ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–º—É –∫–ª–∏–µ–Ω—Ç—É;
   * —Å–æ–∑–¥–∞—Ç—å –Ω–æ–≤—É—é –∫–∞—Ä—Ç–æ—á–∫—É –∫–ª–∏–µ–Ω—Ç–∞ –ø—Ä—è–º–æ –∏–∑ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ –¥–∏–∞–ª–æ–≥–∞.

---

### 2.3. –û–±—â–µ–Ω–∏–µ ‚Äú–∫–ª–∏–µ–Ω—Ç ‚Üî –º–µ–Ω–µ–¥–∂–µ—Ä‚Äù

1. –ö–ª–∏–µ–Ω—Ç –ø–∏—à–µ—Ç –≤ –±–æ—Ç–∞ –ª—é–±–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ.
2. –í—Ö–æ–¥—è—â–µ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ —Ñ–∏–∫—Å–∏—Ä—É–µ—Ç—Å—è –≤ –ë–î –∫–∞–∫ `messages.direction = inbound`.
3. –í—Å–µ –º–µ–Ω–µ–¥–∂–µ—Ä—ã –≤–∏–¥—è—Ç –¥–∏–∞–ª–æ–≥ –≤ —Å–ø–∏—Å–∫–µ:

   * –ø–æ—Å–ª–µ–¥–Ω–µ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ,
   * –§–ò–û –∫–ª–∏–µ–Ω—Ç–∞ (–µ—Å–ª–∏ –ø—Ä–∏–≤—è–∑–∞–Ω), –ª–∏–±–æ —Å—Ç–∞—Ç—É—Å ‚Äú–ì–æ—Å—Ç—å (–Ω–µ –ø—Ä–∏–≤—è–∑–∞–Ω)‚Äù,
   * —Å—Ç–∞—Ç—É—Å –¥–∏–∞–ª–æ–≥–∞ (open/closed).
4. –ú–µ–Ω–µ–¥–∂–µ—Ä –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç –¥–∏–∞–ª–æ–≥ –∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –æ—Ç–≤–µ—Ç:

   * –æ—Ç–≤–µ—Ç —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –∫–∞–∫ `messages.direction = outbound`, `sender_type = manager`;
   * –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –∫–ª–∏–µ–Ω—Ç—É —á–µ—Ä–µ–∑ Telegram Bot API (`sendMessage`).
5. –î–∏–∞–ª–æ–≥ –º–æ–∂–µ—Ç –±—ã—Ç—å –∑–∞–∫—Ä—ã—Ç –∏ –ø–æ–∑–∂–µ –ø–µ—Ä–µ–æ—Ç–∫—Ä—ã—Ç.

---

### 2.4. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è CRM ‚Üí Telegram ‚Üí –∫–ª–∏–µ–Ω—Ç

–°–æ–±—ã—Ç–∏—è –ø–µ—Ä–≤–æ–π –æ—á–µ—Ä–µ–¥–∏:

* –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –ø–ª–∞—Ç–µ–∂–∞;
* –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏–µ –æ –∑–∞–Ω—è—Ç–∏–∏;
* –ø–µ—Ä–µ–Ω–æ—Å / –æ—Ç–º–µ–Ω–∞ –∑–∞–Ω—è—Ç–∏—è;
* –ø–æ–∫—É–ø–∫–∞ —É—Å–ª—É–≥;
* –¥–æ–ª–≥ –ø–æ –æ–ø–ª–∞—Ç–µ.

–ü—Ä–æ—Ü–µ—Å—Å:

1. –ú–æ–¥—É–ª—å CRM –ø—Ä–∏ –Ω–∞—Å—Ç—É–ø–ª–µ–Ω–∏–∏ —Å–æ–±—ã—Ç–∏—è –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç —Å–æ–±—ã—Ç–∏–µ / –≤—ã–∑—ã–≤–∞–µ—Ç notification-—Å–µ—Ä–≤–∏—Å.
2. Notification-—Å–µ—Ä–≤–∏—Å —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç –∫–æ—Ä–æ—Ç–∫–∏–π —Ç–µ–∫—Å—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –∏ —Å–æ–∑–¥–∞—ë—Ç —Å–∏—Å—Ç–µ–º–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ (`sender_type = system`, `direction = outbound`).
3. –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è:

   * –≤ Telegram (–µ—Å–ª–∏ —É –∫–ª–∏–µ–Ω—Ç–∞ –µ—Å—Ç—å –∞–∫—Ç–∏–≤–Ω—ã–π `telegram_accounts` —Å `is_notifications_enabled = true`);
   * –Ω–∞ email –∫–ª–∏–µ–Ω—Ç–∞ (–ø–æ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º CRM).
4. –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –≤ –ª–µ–Ω—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏–π –∫–∞–∫ —Å–∏—Å—Ç–µ–º–Ω–æ–µ (–æ—Ç–ª–∏—á–∞—é—â–∏–π—Å—è —Å—Ç–∏–ª—å).

---

### 2.5. –û—Ç–∫–ª—é—á–µ–Ω–∏–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π

* –ö–ª–∏–µ–Ω—Ç –º–æ–∂–µ—Ç –æ—Ç–∫–ª—é—á–∏—Ç—å/–≤–∫–ª—é—á–∏—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è —á–µ—Ä–µ–∑ –∫–æ–º–∞–Ω–¥—ã –±–æ—Ç–∞ (—Å–º. —Ä–∞–∑–¥–µ–ª 6).
* –ú–µ–Ω–µ–¥–∂–µ—Ä –º–æ–∂–µ—Ç –æ—Ç–∫–ª—é—á–∏—Ç—å/–≤–∫–ª—é—á–∏—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –≤ –∫–∞—Ä—Ç–æ—á–∫–µ –∫–ª–∏–µ–Ω—Ç–∞ (—É–ø—Ä–∞–≤–ª—è—è —Ñ–ª–∞–≥–æ–º `is_notifications_enabled`).

---

## 3. –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–µ

### 3.1. –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —Å–∏—Å—Ç–µ–º—ã

1. **Telegram Bot**

   * –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω —á–µ—Ä–µ–∑ @BotFather.
   * –†–∞–±–æ—Ç–∞–µ—Ç –≤ —Ä–µ–∂–∏–º–µ `webhook`.

2. **Webhook-—Å–µ—Ä–≤–∏—Å CRM**

   * HTTP endpoint: `POST /api/telegram/webhook`.
   * –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç:

     * –≤—Ö–æ–¥—è—â–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è (text / contact / –¥–æ–∫—É–º–µ–Ω—Ç—ã / —Ñ–æ—Ç–æ);
     * –∫–æ–º–∞–Ω–¥—É `/start` —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏ (`client_<id>`, `welcome` –∏ —Ç.–ø.);
     * –ª–æ–≥–∏–∫—É –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ (—Å–º. —Ä–∞–∑–¥–µ–ª 10).

3. **–ú–æ–¥—É–ª—å —Å–æ–æ–±—â–µ–Ω–∏–π (Message Service)**

   * –†–∞–±–æ—Ç–∞ —Å —Ç–∞–±–ª–∏—Ü–∞–º–∏ `conversations`, `messages`, `telegram_accounts`;
   * API –¥–ª—è —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞ CRM:

     * –ø–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –¥–∏–∞–ª–æ–≥–æ–≤;
     * –∑–∞–≥—Ä—É–∑–∫–∞ –∏—Å—Ç–æ—Ä–∏–∏ —Å–æ–æ–±—â–µ–Ω–∏–π;
     * –æ—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏—è –∫–ª–∏–µ–Ω—Ç—É;
     * –ø–æ–º–µ—Ç–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π –∫–∞–∫ –ø—Ä–æ—á–∏—Ç–∞–Ω–Ω—ã—Ö;
     * –ø—Ä–∏–≤—è–∑–∫–∞/–æ—Ç–≤—è–∑–∫–∞ –¥–∏–∞–ª–æ–≥–∞ –∫ –∫–ª–∏–µ–Ω—Ç—É;
     * —Å–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–π –∫–∞—Ä—Ç–æ—á–∫–∏ –∫–ª–∏–µ–Ω—Ç–∞ –ø–æ –¥–∏–∞–ª–æ–≥—É.

4. **Notification-—Å–µ—Ä–≤–∏—Å**

   * –ü—Ä–∏–Ω–∏–º–∞–µ—Ç —Å–æ–±—ã—Ç–∏—è –æ—Ç –¥—Ä—É–≥–∏—Ö –º–æ–¥—É–ª–µ–π CRM (–æ–ø–ª–∞—Ç—ã, –∑–∞–Ω—è—Ç–∏—è, —É—Å–ª—É–≥–∏);
   * –ò—Å–ø–æ–ª—å–∑—É–µ—Ç `notification_templates` –¥–ª—è —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏—è —Ç–µ–∫—Å—Ç–∞;
   * –°–æ–∑–¥–∞—ë—Ç —Å–∏—Å—Ç–µ–º–Ω—ã–µ `messages` –∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏—è –≤ Telegram –∏ email.

5. **–ú–æ–¥—É–ª—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è –¥–µ–π—Å—Ç–≤–∏–π –º–µ–Ω–µ–¥–∂–µ—Ä–æ–≤**

   * –§–∏–∫—Å–∏—Ä—É–µ—Ç –∫–ª—é—á–µ–≤—ã–µ –¥–µ–π—Å—Ç–≤–∏—è (–ø—Ä–∏–≤—è–∑–∫–∞, –∑–∞–∫—Ä—ã—Ç–∏–µ, —Å–æ–∑–¥–∞–Ω–∏–µ –∫–ª–∏–µ–Ω—Ç–∞, –æ—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏—è).

6. **–§—Ä–æ–Ω—Ç–µ–Ω–¥ CRM (–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –º–µ–Ω–µ–¥–∂–µ—Ä–∞)**

   * –û—Ç–æ–±—Ä–∞–∂–∞–µ—Ç —Å–ø–∏—Å–æ–∫ –¥–∏–∞–ª–æ–≥–æ–≤;
   * –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∏—Å—Ç–æ—Ä–∏—é —Å–æ–æ–±—â–µ–Ω–∏–π;
   * –ü–æ–∑–≤–æ–ª—è–µ—Ç –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å —Å–æ–æ–±—â–µ–Ω–∏—è –∏ —Ñ–∞–π–ª—ã;
   * –ü–æ–∑–≤–æ–ª—è–µ—Ç —É–ø—Ä–∞–≤–ª—è—Ç—å —Å—Ç–∞—Ç—É—Å–∞–º–∏ –¥–∏–∞–ª–æ–≥–∞;
   * –ü–æ–∑–≤–æ–ª—è–µ—Ç –ø—Ä–∏–≤—è–∑—ã–≤–∞—Ç—å/—Å–æ–∑–¥–∞–≤–∞—Ç—å –∫–ª–∏–µ–Ω—Ç–æ–≤.

---

## 4. –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö (–ë–î)

### 4.1. –¢–∞–±–ª–∏—Ü–∞ `telegram_accounts`

–°–≤—è–∑—å Telegram ‚Üî –∫–ª–∏–µ–Ω—Ç.

| –ü–æ–ª–µ                     | –¢–∏–ø       | –û–ø–∏—Å–∞–Ω–∏–µ                                |
| ------------------------ | --------- | --------------------------------------- |
| id                       | PK        |                                         |
| client_id                | FK, NULL  | –ü—Ä–∏–≤—è–∑–∞–Ω–Ω—ã–π –∫–ª–∏–µ–Ω—Ç (–µ—Å–ª–∏ –µ—Å—Ç—å)          |
| telegram_user_id         | bigint    | –£–Ω–∏–∫–∞–ª—å–Ω—ã–π Telegram ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è     |
| chat_id                  | bigint    | ID —á–∞—Ç–∞                                 |
| username                 | string    | @username –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è                  |
| first_name               | string    |                                         |
| last_name                | string    |                                         |
| is_notifications_enabled | bool      | –°–æ–≥–ª–∞—Å–∏–µ –∫–ª–∏–µ–Ω—Ç–∞ –Ω–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è         |
| state                    | string    | –¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ FSM (—Å–º. —Ä–∞–∑–¥–µ–ª 10.9) |
| created_at               | timestamp |                                         |
| updated_at               | timestamp |                                         |

---

### 4.2. –¢–∞–±–ª–∏—Ü–∞ `conversations`

–î–∏–∞–ª–æ–≥–∏ (–ø–æ —Å—É—Ç–∏, ‚Äú–∫–∞–Ω–∞–ª—ã –æ–±—â–µ–Ω–∏—è‚Äù —Å –∫–ª–∏–µ–Ω—Ç–æ–º).

| –ü–æ–ª–µ               | –¢–∏–ø                       |
| ------------------ | ------------------------- |
| id                 | PK                        |
| client_id          | FK, NULL                  |
| channel_account_id | FK ‚Üí telegram_accounts.id |
| source             | enum(telegram)            |
| status             | enum(open, closed)        |
| last_message_at    | timestamp                 |
| created_at         | timestamp                 |
| updated_at         | timestamp                 |

---

### 4.3. –¢–∞–±–ª–∏—Ü–∞ `messages`

–í—Å–µ —Å–æ–æ–±—â–µ–Ω–∏—è –∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è.

| –ü–æ–ª–µ               | –¢–∏–ø                           | –û–ø–∏—Å–∞–Ω–∏–µ                                |
| ------------------ | ----------------------------- | --------------------------------------- |
| id                 | PK                            |                                         |
| conversation_id    | FK ‚Üí conversations.id         |                                         |
| direction          | enum(inbound, outbound)       | –ù–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ (–æ—Ç –∫–ª–∏–µ–Ω—Ç–∞ / –∫ –∫–ª–∏–µ–Ω—Ç—É)    |
| sender_type        | enum(client, manager, system) | –ö—Ç–æ –æ—Ç–ø—Ä–∞–≤–∏–ª                            |
| text               | text                          | –¢–µ–∫—Å—Ç —Å–æ–æ–±—â–µ–Ω–∏—è                         |
| payload            | jsonb                         | –î–æ–ø. –¥–∞–Ω–Ω—ã–µ (ID –æ–ø–ª–∞—Ç—ã, –∑–∞–Ω—è—Ç–∏—è –∏ —Ç.–ø.) |
| category           | enum, NULL                    | payment / schedule / reminder / chat    |
| created_at         | timestamp                     |                                         |
| is_read_by_client  | bool                          |                                         |
| is_read_by_manager | bool                          |                                         |

---

### 4.4. –¢–∞–±–ª–∏—Ü–∞ `notification_templates`

–®–∞–±–ª–æ–Ω—ã —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –ø–æ —Ç–∏–ø–∞–º —Å–æ–±—ã—Ç–∏–π.

| –ü–æ–ª–µ          | –¢–∏–ø    |
| ------------- | ------ |
| id            | PK     |
| event_type    | string |
| template_text | text   |
| is_active     | bool   |

---

### 4.5. –¢–∞–±–ª–∏—Ü–∞ `logs_manager_actions`

–õ–æ–≥–∏ –¥–µ–π—Å—Ç–≤–∏–π –º–µ–Ω–µ–¥–∂–µ—Ä–æ–≤.

| –ü–æ–ª–µ        | –¢–∏–ø       |                                                      |
| ----------- | --------- | ---------------------------------------------------- |
| id          | PK        |                                                      |
| manager_id  | FK        |                                                      |
| action_type | string    | (–ø—Ä–∏–≤—è–∑–∫–∞, –æ—Ç–≤–µ—Ç, –∑–∞–∫—Ä—ã—Ç–∏–µ, —Å–æ–∑–¥–∞–Ω–∏–µ –∫–ª–∏–µ–Ω—Ç–∞ –∏ —Ç.–ø.) |
| target_id   | int       | conversation_id –∏–ª–∏ client_id                        |
| created_at  | timestamp |                                                      |

---

## 5. –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å CRM (–¥–ª—è –º–µ–Ω–µ–¥–∂–µ—Ä–æ–≤)

### 5.1. –°–ø–∏—Å–æ–∫ –¥–∏–∞–ª–æ–≥–æ–≤

–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å:

* –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –≤—Å–µ—Ö –¥–∏–∞–ª–æ–≥–æ–≤ (—Å—Ç–∞—Ç—É—Å—ã open/closed).
* –î–ª—è –∫–∞–∂–¥–æ–≥–æ –¥–∏–∞–ª–æ–≥–∞ –≤—ã–≤–æ–¥–∏—Ç—Å—è:

  * –§–ò–û –∫–ª–∏–µ–Ω—Ç–∞ (–µ—Å–ª–∏ –ø—Ä–∏–≤—è–∑–∞–Ω) –ª–∏–±–æ ‚Äú–ì–æ—Å—Ç—å (–Ω–µ –ø—Ä–∏–≤—è–∑–∞–Ω)‚Äù;
  * –∏—Å—Ç–æ—á–Ω–∏–∫ (Telegram);
  * –≤—Ä–µ–º—è –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è;
  * —Ñ–ª–∞–≥ –Ω–∞–ª–∏—á–∏—è –Ω–æ–≤—ã—Ö –Ω–µ–ø—Ä–æ—á–∏—Ç–∞–Ω–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π.
* –§–∏–ª—å—Ç—Ä—ã:

  * –ø–æ —Å—Ç–∞—Ç—É—Å—É (open/closed);
  * –ø–æ –Ω–∞–ª–∏—á–∏—é –Ω–µ–ø—Ä–æ—á–∏—Ç–∞–Ω–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π.
* –ü–æ–∏—Å–∫ –ø–æ:

  * –§–ò–û –∫–ª–∏–µ–Ω—Ç–∞;
  * —Ç–µ–ª–µ—Ñ–æ–Ω—É;
  * —á–∞—Å—Ç–∏ —Ç–µ–∫—Å—Ç–∞ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è.

---

### 5.2. –ö–∞—Ä—Ç–æ—á–∫–∞ –¥–∏–∞–ª–æ–≥–∞

–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å:

* –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ:

  * –∏—Å—Ç–æ—Ä–∏–∏ —Å–æ–æ–±—â–µ–Ω–∏–π (–∫–ª–∏–µ–Ω—Ç / –º–µ–Ω–µ–¥–∂–µ—Ä / —Å–∏—Å—Ç–µ–º–∞, —Å—Ç–∏–ª–∏–∑–æ–≤–∞–Ω—ã –ø–æ-—Ä–∞–∑–Ω–æ–º—É);
  * –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –∫–ª–∏–µ–Ω—Ç–µ (–§–ò–û, —Ç–µ–ª–µ—Ñ–æ–Ω, e-mail, –≥—Ä—É–ø–ø—ã, —É—Å–ª—É–≥–∏) –ø—Ä–∏ –Ω–∞–ª–∏—á–∏–∏ `client_id`.
* –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å:

  * –æ—Ç–ø—Ä–∞–≤–∏—Ç—å —Ç–µ–∫—Å—Ç–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ;
  * –æ—Ç–ø—Ä–∞–≤–∏—Ç—å —Ñ–æ—Ç–æ/–¥–æ–∫—É–º–µ–Ω—Ç;
  * –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –±—ã—Å—Ç—Ä—ã–π —à–∞–±–ª–æ–Ω (–≥–æ—Ç–æ–≤—ã–µ –æ—Ç–≤–µ—Ç—ã);
  * –ø–æ–º–µ—Ç–∏—Ç—å –¥–∏–∞–ª–æ–≥ –∫–∞–∫ `closed` / `open`;
  * –ø—Ä–∏–≤—è–∑–∞—Ç—å –¥–∏–∞–ª–æ–≥ –∫ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–º—É –∫–ª–∏–µ–Ω—Ç—É;
  * —Å–æ–∑–¥–∞—Ç—å –Ω–æ–≤—É—é –∫–∞—Ä—Ç–æ—á–∫—É –∫–ª–∏–µ–Ω—Ç–∞ –∏ –ø—Ä–∏–≤—è–∑–∞—Ç—å –¥–∏–∞–ª–æ–≥;
  * –ø—Ä–æ—Å–º–æ—Ç—Ä–µ—Ç—å –≤–ª–æ–∂–µ–Ω–∏—è (—Ñ–æ—Ç–æ/—Ñ–∞–π–ª—ã).

---

## 6. –ü–æ–≤–µ–¥–µ–Ω–∏–µ Telegram-–±–æ—Ç–∞

### 6.1. –û–±—Ä–∞–±–æ—Ç–∫–∞ `/start`

* –ï—Å–ª–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä –≤–∏–¥–∞ `client_<id>`:

  * –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–∏–≤—è–∑–∫–∞ Telegram-–∞–∫–∫–∞—É–Ω—Ç–∞ –∫ —É–∫–∞–∑–∞–Ω–Ω–æ–º—É `client_id`;
  * —Å–æ–∑–¥–∞—ë—Ç—Å—è/–Ω–∞—Ö–æ–¥–∏—Ç—Å—è –¥–∏–∞–ª–æ–≥ –¥–ª—è —ç—Ç–æ–≥–æ –∫–ª–∏–µ–Ω—Ç–∞;
  * –±–æ—Ç –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ –≤–∏–¥–∞:

    > –í—ã —É—Å–ø–µ—à–Ω–æ –ø–æ–¥–∫–ª—é—á–µ–Ω—ã. –¢–µ–ø–µ—Ä—å –º—ã –º–æ–∂–µ–º –ø—Ä–∏—Å—ã–ª–∞—Ç—å –≤–∞–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –∑–∞–Ω—è—Ç–∏—è—Ö –∏ –æ–ø–ª–∞—Ç–∞—Ö.
* –ï—Å–ª–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä `welcome` –∏–ª–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç:

  * –±–æ—Ç –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∫–∞–∫ –Ω–æ–≤–æ–≥–æ/–Ω–µ–ø—Ä–∏–≤—è–∑–∞–Ω–Ω–æ–≥–æ –∏ –∑–∞–ø—É—Å–∫–∞–µ—Ç –ª–æ–≥–∏–∫—É –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ (—Å–º. —Ä–∞–∑–¥–µ–ª 10).

### 6.2. –ö–æ–º–∞–Ω–¥—ã –∫–ª–∏–µ–Ω—Ç–∞

* `/stop_notifications` ‚Äî –æ—Ç–∫–ª—é—á–µ–Ω–∏–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π.

  * –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è `is_notifications_enabled = false` –¥–ª—è –¥–∞–Ω–Ω–æ–≥–æ `telegram_accounts`.
  * –ë–æ—Ç –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞–µ—Ç:

    > –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ—Ç–∫–ª—é—á–µ–Ω—ã. –í—ã –≤—Å–µ–≥–¥–∞ –º–æ–∂–µ—Ç–µ –≤–∫–ª—é—á–∏—Ç—å –∏—Ö –∫–æ–º–∞–Ω–¥–æ–π /start_notifications.
* `/start_notifications` ‚Äî –≤–∫–ª—é—á–µ–Ω–∏–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π.

  * `is_notifications_enabled = true`.
  * –ë–æ—Ç –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞–µ—Ç:

    > –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –≤–∫–ª—é—á–µ–Ω—ã.

### 6.3. –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ —Ç–∏–ø—ã —Å–æ–æ–±—â–µ–Ω–∏–π –æ—Ç –∫–ª–∏–µ–Ω—Ç–∞

* —Ç–µ–∫—Å—Ç–æ–≤—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è;
* —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏;
* –¥–æ–∫—É–º–µ–Ω—Ç—ã (—Ñ–∞–π–ª—ã);
* –∫–æ–Ω—Ç–∞–∫—Ç (–ø—Ä–∏ –Ω–∞–∂–∞—Ç–∏–∏ –∫–Ω–æ–ø–∫–∏ ‚Äú–ü–æ–¥–µ–ª–∏—Ç—å—Å—è –Ω–æ–º–µ—Ä–æ–º —Ç–µ–ª–µ—Ñ–æ–Ω–∞‚Äù).

–§–∞–π–ª—ã –∏ —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏ –ø–µ—Ä–µ–¥–∞—é—Ç—Å—è –≤ CRM –∫–∞–∫ –≤–ª–æ–∂–µ–Ω–∏—è (—Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è file_id –∏ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ; —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –º–æ–∂–µ—Ç –≤—ã–ø–æ–ª–Ω—è—Ç—å—Å—è –ø–æ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—é).

---

## 7. –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è

### 7.1. –¢–∏–ø—ã —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π (–ø–µ—Ä–≤–∞—è –æ—á–µ—Ä–µ–¥—å)

* –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –ø–ª–∞—Ç–µ–∂–∞.
* –ù–∞–ø–æ–º–∏–Ω–∞–Ω–∏–µ –æ –∑–∞–Ω—è—Ç–∏–∏ (–∑–∞ –æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω—ã–π –ø–µ—Ä–∏–æ–¥ –¥–æ –∑–∞–Ω—è—Ç–∏—è ‚Äî –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è).
* –ü–µ—Ä–µ–Ω–æ—Å/–æ—Ç–º–µ–Ω–∞ –∑–∞–Ω—è—Ç–∏—è.
* –ü–æ–∫—É–ø–∫–∞ —É—Å–ª—É–≥ / –∞–∫—Ç–∏–≤–∞—Ü–∏—è –∞–±–æ–Ω–µ–º–µ–Ω—Ç–∞.
* –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –¥–æ–ª–≥–µ –ø–æ –æ–ø–ª–∞—Ç–µ.

### 7.2. –ö–∞–Ω–∞–ª—ã –¥–æ—Å—Ç–∞–≤–∫–∏

* Telegram-–±–æ—Ç (–ø—Ä–∏ –Ω–∞–ª–∏—á–∏–∏ `telegram_accounts` –∏ –≤–∫–ª—é—á—ë–Ω–Ω—ã—Ö —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π).
* Email (–ø–æ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º CRM).

### 7.3. –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è–º–∏

* –ö–ª–∏–µ–Ω—Ç —É–ø—Ä–∞–≤–ª—è–µ—Ç —á–µ—Ä–µ–∑ –∫–æ–º–∞–Ω–¥—ã –±–æ—Ç–∞ (`/stop_notifications`, `/start_notifications`).
* –ú–µ–Ω–µ–¥–∂–µ—Ä —É–ø—Ä–∞–≤–ª—è–µ—Ç —Ñ–ª–∞–≥–æ–º `is_notifications_enabled` –≤ –∫–∞—Ä—Ç–æ—á–∫–µ –∫–ª–∏–µ–Ω—Ç–∞.

---

## 8. –ù–µ—Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

### 8.1. –•—Ä–∞–Ω–µ–Ω–∏–µ –ø–µ—Ä–µ–ø–∏—Å–∫–∏

* –ò—Å—Ç–æ—Ä–∏—è –ø–µ—Ä–µ–ø–∏—Å–∫–∏ (—Ç–∞–±–ª–∏—Ü–∞ `messages`) —Ö—Ä–∞–Ω–∏—Ç—Å—è **–±–µ—Å—Å—Ä–æ—á–Ω–æ**.
* –î–∞–Ω–Ω—ã–µ —Ö—Ä–∞–Ω—è—Ç—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ –≤ –†–§ (–≤ —Ä–∞–º–∫–∞—Ö –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã —É—á—Ä–µ–∂–¥–µ–Ω–∏—è / –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞).

### 8.2. –õ–æ–≥–∏ –∏ –∞—É–¥–∏—Ç

* –õ–æ–≥–∏—Ä–æ–≤–∞—Ç—å:

  * —Å–æ–∑–¥–∞–Ω–∏–µ/–∏–∑–º–µ–Ω–µ–Ω–∏–µ –∑–∞–ø–∏—Å–µ–π –≤ `telegram_accounts`;
  * –ø—Ä–∏–≤—è–∑–∫—É/–æ—Ç–≤—è–∑–∫—É –∫–ª–∏–µ–Ω—Ç–æ–≤;
  * –∑–∞–∫—Ä—ã—Ç–∏–µ/–æ—Ç–∫—Ä—ã—Ç–∏–µ –¥–∏–∞–ª–æ–≥–æ–≤;
  * –æ—Ç–ø—Ä–∞–≤–∫—É —Å–æ–æ–±—â–µ–Ω–∏–π –º–µ–Ω–µ–¥–∂–µ—Ä–∞–º–∏;
  * –≥–µ–Ω–µ—Ä–∞—Ü–∏—é —Å–∏—Å—Ç–µ–º–Ω—ã—Ö —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π.

### 8.3. –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

* –í—Ä–µ–º—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –≤—Ö–æ–¥—è—â–µ–≥–æ webhook-–∑–∞–ø—Ä–æ—Å–∞ ‚Äî –Ω–µ –±–æ–ª–µ–µ 1 —Å–µ–∫—É–Ω–¥—ã (–±–µ–∑ —É—á—ë—Ç–∞ –≤–Ω–µ—à–Ω–∏—Ö –∑–∞–¥–µ—Ä–∂–µ–∫ Telegram).
* –í—Ä–µ–º—è –¥–æ—Å—Ç–∞–≤–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏—è –∫–ª–∏–µ–Ω—Ç—É (—Å –º–æ–º–µ–Ω—Ç–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ –º–µ–Ω–µ–¥–∂–µ—Ä–æ–º –¥–æ –ø–æ–ª—É—á–µ–Ω–∏—è –≤ Telegram) ‚Äî –æ—Ä–∏–µ–Ω—Ç–∏—Ä–æ–≤–æ—á–Ω–æ –¥–æ 2‚Äì3 —Å–µ–∫—É–Ω–¥ –ø—Ä–∏ –Ω–æ—Ä–º–∞–ª—å–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–µ.

### 8.4. –î–æ—Å—Ç—É–ø

* –í—Å–µ —Ä–æ–ª–∏ CRM (–∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä, –º–µ—Ç–æ–¥–∏—Å—Ç, –±—É—Ö–≥–∞–ª—Ç–µ—Ä, –ø—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª—å –∏ —Ç.–¥.) –∏–º–µ—é—Ç –¥–æ—Å—Ç—É–ø –∫ –º–æ–¥—É–ª—é —Å–æ–æ–±—â–µ–Ω–∏–π –∏ –≤–∏–¥—è—Ç –≤—Å–µ –¥–∏–∞–ª–æ–≥–∏ (–Ω–∞ –¥–∞–Ω–Ω–æ–º —ç—Ç–∞–ø–µ —Ä–∞–∑–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è).

---

## 9. –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ UI (—Ñ—Ä–æ–Ω—Ç–µ–Ω–¥ CRM)

–§—Ä–æ–Ω—Ç–µ–Ω–¥ –º–æ–¥—É–ª—è ‚Äú–ö–æ–º–º—É–Ω–∏–∫–∞—Ü–∏–∏‚Äù –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω –Ω–∞ –æ—Å–Ω–æ–≤–µ **–≥–æ—Ç–æ–≤–æ–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–Ω–æ–π –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ shadcn/ui**, —É–∂–µ –∏—Å–ø–æ–ª—å–∑—É–µ–º–æ–π –≤ –ø—Ä–æ–µ–∫—Ç–µ, —á—Ç–æ–±—ã –º–∏–Ω–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Ç—Ä—É–¥–æ–∑–∞—Ç—Ä–∞—Ç—ã –∏ –æ–±–µ—Å–ø–µ—á–∏—Ç—å –µ–¥–∏–Ω—ã–π –≤–∏–∑—É–∞–ª—å–Ω—ã–π —Å—Ç–∏–ª—å.

### 9.1. –û–±—â–∏–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

1. –î–ª—è –≤—Å–µ—Ö —ç–∫—Ä–∞–Ω–æ–≤ –∏ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ —á–∞—Ç–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã **shadcn/ui** (React + Tailwind).
2. –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞ ‚Äú—Å –Ω—É–ª—è‚Äù —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã—Ö UI-–±–∏–±–ª–∏–æ—Ç–µ–∫ –Ω–µ –¥–æ–ø—É—Å–∫–∞–µ—Ç—Å—è.
3. –î–æ–ø—É—Å–∫–∞–µ—Ç—Å—è —Å–æ–∑–¥–∞–Ω–∏–µ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–Ω—ã—Ö –æ–±—ë—Ä—Ç–æ–∫ –Ω–∞–¥ shadcn/ui (–Ω–∞–ø—Ä–∏–º–µ—Ä, `ChatMessage`, `ChatList`).
4. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Å—Ç–æ—Ä–æ–Ω–Ω–∏—Ö –±–∏–±–ª–∏–æ—Ç–µ–∫ UI (Material UI, Ant Design, Bootstrap –∏ —Ç.–ø.) –∑–∞–ø—Ä–µ—â–µ–Ω–æ.
5. –ï—Å–ª–∏ –Ω—É–∂–Ω–æ–≥–æ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞ –Ω–µ—Ç –≤ shadcn/ui, —Å–ª–µ–¥—É–µ—Ç:

   * —Å–æ–±—Ä–∞—Ç—å –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–π UI –∏–∑ –∫–æ–º–±–∏–Ω–∞—Ü–∏–∏ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ shadcn/ui;
   * –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –¥–æ–±–∞–≤–∏—Ç—å Tailwind-—Å—Ç–∏–ª–∏ –ø–æ –ø—Ä–∏–Ω—è—Ç—ã–º –≤ –ø—Ä–æ–µ–∫—Ç–µ –ø—Ä–∞–≤–∏–ª–∞–º.
6. –¶–≤–µ—Ç–∞, —à—Ä–∏—Ñ—Ç—ã, –æ—Ç—Å—Ç—É–ø—ã –∏ –¥—Ä—É–≥–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –≤–Ω–µ—à–Ω–µ–≥–æ –≤–∏–¥–∞ –¥–æ–ª–∂–Ω—ã —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–æ–≤–∞—Ç—å –æ–±—â–µ–π –¥–∏–∑–∞–π–Ω-—Å–∏—Å—Ç–µ–º–µ –ø—Ä–æ–µ–∫—Ç–∞ (Tailwind tokens).

### 9.2. –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã shadcn/ui –¥–ª—è –∫–ª—é—á–µ–≤—ã—Ö —ç–∫—Ä–∞–Ω–æ–≤

**–°–ø–∏—Å–æ–∫ –¥–∏–∞–ª–æ–≥–æ–≤:**

* `Card` ‚Äî –¥–ª—è –∫–∞—Ä—Ç–æ—á–µ–∫ –¥–∏–∞–ª–æ–≥–æ–≤;
* `ScrollArea` ‚Äî –¥–ª—è –ø—Ä–æ–∫—Ä—É—Ç–∫–∏ —Å–ø–∏—Å–∫–∞;
* `Avatar` ‚Äî –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –∞–≤–∞—Ç–∞—Ä–∞/–∏–Ω–∏—Ü–∏–∞–ª–æ–≤ –∫–ª–∏–µ–Ω—Ç–∞;
* `Badge` ‚Äî –¥–ª—è –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤ —Å—Ç–∞—Ç—É—Å–∞/–Ω–æ–≤—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π;
* `Input` ‚Äî –¥–ª—è –ø–æ–∏—Å–∫–∞;
* `Button` ‚Äî –¥–ª—è –¥–µ–π—Å—Ç–≤–∏–π.

**–û–∫–Ω–æ –¥–∏–∞–ª–æ–≥–∞:**

* `ScrollArea` ‚Äî –æ–±–ª–∞—Å—Ç—å —Å –∏—Å—Ç–æ—Ä–∏–µ–π —Å–æ–æ–±—â–µ–Ω–∏–π;
* `Card` / —Å—Ç–∏–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –±–ª–æ–∫–∏ ‚Äî –ø—É–∑—ã—Ä—å–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏–π;
* `Badge` ‚Äî –¥–ª—è —Å–∏—Å—Ç–µ–º–Ω—ã—Ö —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π;
* `Input` ‚Äî –ø–æ–ª–µ –≤–≤–æ–¥–∞ —Ç–µ–∫—Å—Ç–∞;
* `Button` ‚Äî –æ—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏—è, –ø—Ä–∏–∫—Ä–µ–ø–ª–µ–Ω–∏–µ —Ñ–∞–π–ª–æ–≤.

**–ü—Ä–∏–≤—è–∑–∫–∞ –∫ –∫–ª–∏–µ–Ω—Ç—É:**

* `Dialog` ‚Äî –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ;
* `Input`, `Command`, `Combobox` ‚Äî –ø–æ–∏—Å–∫ –∫–ª–∏–µ–Ω—Ç–∞;
* `Button` ‚Äî –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ/–æ—Ç–º–µ–Ω–∞.

**–°–æ–∑–¥–∞–Ω–∏–µ –∫–ª–∏–µ–Ω—Ç–∞:**

* `Dialog`, `Form`, `Input`, `Select`, `Button`.

**–í–ª–æ–∂–µ–Ω–∏—è:**

* `Card` + –∏–∫–æ–Ω–∫–∏, –≤–æ–∑–º–æ–∂–Ω–æ `ScrollArea` –¥–ª—è —Å–ø–∏—Å–∫–∞ —Ñ–∞–π–ª–æ–≤.

### 9.3. –û—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è –∫–æ–¥–∞

* –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —á–∞—Ç–∞ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –≤—ã–Ω–µ—Å–µ–Ω—ã –≤ –æ—Ç–¥–µ–ª—å–Ω—ã–π –º–æ–¥—É–ª—å, –Ω–∞–ø—Ä–∏–º–µ—Ä:
  `/components/ui/chat/`
* –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:

  * `ChatList`
  * `ChatMessage`
  * `ChatInput`
  * `ChatHeader`
  * `ChatAttachment`

### 9.4. UX-—Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

* –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å —á–∞—Ç–∞ –¥–æ–ª–∂–µ–Ω –Ω–∞–ø–æ–º–∏–Ω–∞—Ç—å —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ –º–µ—Å—Å–µ–Ω–¥–∂–µ—Ä—ã, –Ω–æ –æ—Å—Ç–∞–≤–∞—Ç—å—Å—è –≤ —Ä–∞–º–∫–∞—Ö –æ–±—â–µ–≥–æ —Å—Ç–∏–ª—è CRM.
* –î–æ–ª–∂–Ω–∞ –±—ã—Ç—å –æ–±–µ—Å–ø–µ—á–µ–Ω–∞ –∞–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å (–∫–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è —Ä–∞–±–æ—Ç–∞ –Ω–∞ –Ω–æ—É—Ç–±—É–∫–∞—Ö –∏ –ø–ª–∞–Ω—à–µ—Ç–∞—Ö/—Ç–µ–ª–µ—Ñ–æ–Ω–∞—Ö).
* –ú–∏–Ω–∏–º–∞–ª–∏—Å—Ç–∏—á–Ω—ã–π, –ø–æ–Ω—è—Ç–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –±–µ–∑ –∏–∑–ª–∏—à–Ω–µ–π –∞–Ω–∏–º–∞—Ü–∏–∏.

---

## 10. –ò–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –∫–ª–∏–µ–Ω—Ç–∞ –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –æ–±—Ä–∞—â–µ–Ω–∏–∏

### 10.1. –û–±—â–∞—è –ª–æ–≥–∏–∫–∞

–ï—Å–ª–∏ Telegram-–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–∏—à–µ—Ç –±–æ—Ç—É –≤–ø–µ—Ä–≤—ã–µ –∏ –∑–∞–ø–∏—Å—å –≤ `telegram_accounts` –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç, –ª–∏–±–æ –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É–µ—Ç, –Ω–æ `client_id = NULL`, —Ç–∞–∫–æ–π –æ—Ç–ø—Ä–∞–≤–∏—Ç–µ–ª—å —Å—á–∏—Ç–∞–µ—Ç—Å—è **–Ω–µ–∏–¥–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–º**.

–í —ç—Ç–æ–º —Å–ª—É—á–∞–µ:

1. –ë–æ—Ç –ø—Ä–µ–¥–ª–∞–≥–∞–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –ø—Ä–æ–π—Ç–∏ –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é.
2. –ö–ª–∏–µ–Ω—Ç –º–æ–∂–µ—Ç **–ø—Ä–æ–ø—É—Å—Ç–∏—Ç—å** –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é –∏ –ø—Ä–æ–¥–æ–ª–∂–∏—Ç—å –æ–±—â–µ–Ω–∏–µ.
3. –ú–µ–Ω–µ–¥–∂–µ—Ä –≤–∏–¥–∏—Ç —Ç–∞–∫–æ–π –¥–∏–∞–ª–æ–≥ –∫–∞–∫ ‚Äú–ì–æ—Å—Ç—å (–Ω–µ –ø—Ä–∏–≤—è–∑–∞–Ω)‚Äù –∏ –º–æ–∂–µ—Ç:

   * –ø—Ä–∏–≤—è–∑–∞—Ç—å –∫ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–º—É –∫–ª–∏–µ–Ω—Ç—É;
   * —Å–æ–∑–¥–∞—Ç—å –Ω–æ–≤—É—é –∫–∞—Ä—Ç–æ—á–∫—É –∫–ª–∏–µ–Ω—Ç–∞.

–ò–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –Ω–µ —è–≤–ª—è–µ—Ç—Å—è –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–º —É—Å–ª–æ–≤–∏–µ–º –¥–ª—è –Ω–∞—á–∞–ª–∞ –¥–∏–∞–ª–æ–≥–∞.

---

### 10.2. –°–æ–æ–±—â–µ–Ω–∏–µ –±–æ—Ç–∞ –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –æ–±—Ä–∞—â–µ–Ω–∏–∏

–ü—Ä–∏ –ø–µ—Ä–≤–æ–º –≤—Ö–æ–¥—è—â–µ–º —Å–æ–æ–±—â–µ–Ω–∏–∏ –æ—Ç –Ω–µ–∏–¥–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –±–æ—Ç –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Ç–µ–∫—Å—Ç:

> –ó–¥—Ä–∞–≤—Å—Ç–≤—É–π—Ç–µ!
> –ß—Ç–æ–±—ã –º—ã –º–æ–≥–ª–∏ —Å–≤—è–∑–∞—Ç—å –ø–µ—Ä–µ–ø–∏—Å–∫—É —Å –≤–∞—à–∏–º –ø—Ä–æ—Ñ–∏–ª–µ–º –∏ –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å –≤–∞–º —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ, –æ–ø–ª–∞—Ç—ã –∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è, –≤—ã –º–æ–∂–µ—Ç–µ –æ—Ç–ø—Ä–∞–≤–∏—Ç—å —Å–≤–æ–π –Ω–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞.
>
> –≠—Ç–æ –Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ ‚Äî –≤—ã –º–æ–∂–µ—Ç–µ –ø—Ä–æ–¥–æ–ª–∂–∏—Ç—å –æ–±—â–µ–Ω–∏–µ –∏ –±–µ–∑ —ç—Ç–æ–≥–æ.

–ò –≤–º–µ—Å—Ç–µ —Å —Ç–µ–∫—Å—Ç–æ–º –±–æ—Ç –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∫–ª–∞–≤–∏–∞—Ç—É—Ä—É —Å –∫–Ω–æ–ø–∫–∞–º–∏ (—Å–º. 10.3).

---

### 10.3. –ö–Ω–æ–ø–∫–∞ ‚Äú–ü–æ–¥–µ–ª–∏—Ç—å—Å—è –Ω–æ–º–µ—Ä–æ–º —Ç–µ–ª–µ—Ñ–æ–Ω–∞‚Äù

–ë–æ—Ç –¥–æ–ª–∂–µ–Ω –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å reply-–∫–ª–∞–≤–∏–∞—Ç—É—Ä—É Telegram —Å–ª–µ–¥—É—é—â–µ–≥–æ –≤–∏–¥–∞:

```json
{
  "keyboard": [
    [
      {
        "text": "–ü–æ–¥–µ–ª–∏—Ç—å—Å—è –Ω–æ–º–µ—Ä–æ–º —Ç–µ–ª–µ—Ñ–æ–Ω–∞",
        "request_contact": true
      }
    ],
    [
      {
        "text": "–ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å –±–µ–∑ –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏"
      }
    ]
  ],
  "resize_keyboard": true,
  "one_time_keyboard": true
}
```

–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å:

* –ü—Ä–∏ –Ω–∞–∂–∞—Ç–∏–∏ **‚Äú–ü–æ–¥–µ–ª–∏—Ç—å—Å—è –Ω–æ–º–µ—Ä–æ–º —Ç–µ–ª–µ—Ñ–æ–Ω–∞‚Äù** Telegram –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –æ–±—ä–µ–∫—Ç `contact` —Å –ø–æ–ª—è–º–∏:

  * `phone_number`;
  * `user_id`;
  * `first_name`, `last_name`.
* –≠—Ç–æ –≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π –Ω–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞, –Ω–µ –≤–≤–µ–¥—ë–Ω–Ω—ã–π –≤—Ä—É—á–Ω—É—é.

---

### 10.4. –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ–±—ä–µ–∫—Ç–∞ `contact`

–ü–æ—Å–ª–µ –ø–æ–ª—É—á–µ–Ω–∏—è —Å–æ–æ–±—â–µ–Ω–∏—è —Å `contact`:

1. –ü—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è, —á—Ç–æ `contact.user_id === message.from.id` (–∑–∞—â–∏—Ç–∞ –æ—Ç –æ—Ç–ø—Ä–∞–≤–∫–∏ —á—É–∂–æ–≥–æ –∫–æ–Ω—Ç–∞–∫—Ç–∞).
2. CRM –∏—â–µ—Ç –∫–ª–∏–µ–Ω—Ç–∞ –ø–æ –Ω–æ–º–µ—Ä—É —Ç–µ–ª–µ—Ñ–æ–Ω–∞ –≤ –ë–î.
3. –í–∞—Ä–∏–∞–Ω—Ç—ã:

   * **–ö–ª–∏–µ–Ω—Ç –Ω–∞–π–¥–µ–Ω**:

     * –ø–æ–ª–µ `client_id` –≤ `telegram_accounts` –∑–∞–ø–æ–ª–Ω—è–µ—Ç—Å—è –Ω–∞–π–¥–µ–Ω–Ω—ã–º –∑–Ω–∞—á–µ–Ω–∏–µ–º;
     * –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ —Å–æ–∑–¥–∞—ë—Ç—Å—è/–æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è `conversation`;
     * –±–æ—Ç –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ:

       > –û—Ç–ª–∏—á–Ω–æ! –ú—ã –Ω–∞—à–ª–∏ –≤–∞—à –ø—Ä–æ—Ñ–∏–ª—å. –¢–µ–ø–µ—Ä—å –º—ã –º–æ–∂–µ–º –ø—Ä–∏—Å—ã–ª–∞—Ç—å –≤–∞–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –∑–∞–Ω—è—Ç–∏—è—Ö –∏ –æ–ø–ª–∞—Ç–∞—Ö.
   * **–ö–ª–∏–µ–Ω—Ç –Ω–µ –Ω–∞–π–¥–µ–Ω**:

     * –±–æ—Ç —Å–æ–æ–±—â–∞–µ—Ç:

       > –ú—ã –Ω–µ –Ω–∞—à–ª–∏ –≤–∞—à –ø—Ä–æ—Ñ–∏–ª—å. –•–æ—Ç–∏—Ç–µ, —á—Ç–æ–±—ã –º—ã —Å–æ–∑–¥–∞–ª–∏ –¥–ª—è –≤–∞—Å –∫–∞—Ä—Ç–æ—á–∫—É –∫–ª–∏–µ–Ω—Ç–∞?
     * –ï—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ—Ç–≤–µ—á–∞–µ—Ç —Å–æ–≥–ª–∞—Å–∏–µ–º:

       * —Å–æ–∑–¥–∞—ë—Ç—Å—è –Ω–æ–≤–∞—è –∑–∞–ø–∏—Å—å –≤ —Ç–∞–±–ª–∏—Ü–µ –∫–ª–∏–µ–Ω—Ç–æ–≤ (–º–∏–Ω–∏–º—É–º: —Ç–µ–ª–µ—Ñ–æ–Ω, –§–ò–û –∏–∑ Telegram);
       * –ø–æ–ª–µ `client_id` –≤ `telegram_accounts` –∑–∞–ø–æ–ª–Ω—è–µ—Ç—Å—è –Ω–æ–≤—ã–º ID;
       * –±–æ—Ç –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –∫–ª–∏–µ–Ω—Ç–∞:

         > –ö–∞—Ä—Ç–æ—á–∫–∞ –∫–ª–∏–µ–Ω—Ç–∞ —Å–æ–∑–¥–∞–Ω–∞, –≤—ã –º–æ–∂–µ—Ç–µ –ø–∏—Å–∞—Ç—å –≤–∞—à–∏ –≤–æ–ø—Ä–æ—Å—ã.
     * –ï—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ—Ç–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è:

       * –¥–∏–∞–ª–æ–≥ –æ—Å—Ç–∞—ë—Ç—Å—è –≤ —Å—Ç–∞—Ç—É—Å–µ ‚Äú–ì–æ—Å—Ç—å (–Ω–µ –ø—Ä–∏–≤—è–∑–∞–Ω)‚Äù.

---

### 10.5. –ü—Ä–æ–ø—É—Å–∫ –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏

–ï—Å–ª–∏ –∫–ª–∏–µ–Ω—Ç:

* –Ω–∞–∂–∏–º–∞–µ—Ç –∫–Ω–æ–ø–∫—É ‚Äú–ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å –±–µ–∑ –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏‚Äù, –∏–ª–∏
* –∏–≥–Ω–æ—Ä–∏—Ä—É–µ—Ç –∑–∞–ø—Ä–æ—Å –∏ –ø–∏—à–µ—Ç –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω—ã–π —Ç–µ–∫—Å—Ç,

—Ç–æ:

* –±–æ—Ç –Ω–µ –Ω–∞–≤—è–∑—ã–≤–∞–µ—Ç –ø–æ–≤—Ç–æ—Ä–Ω—ã–π –∑–∞–ø—Ä–æ—Å —Å—Ä–∞–∑—É;
* —Å–æ–∑–¥–∞—ë—Ç—Å—è –¥–∏–∞–ª–æ–≥ –±–µ–∑ `client_id`;
* –º–µ–Ω–µ–¥–∂–µ—Ä –≤–∏–¥–∏—Ç —Å—Ç–∞—Ç—É—Å ‚Äú–ì–æ—Å—Ç—å (–Ω–µ –ø—Ä–∏–≤—è–∑–∞–Ω)‚Äù –∏ –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ —É—Ç–æ—á–Ω—è–µ—Ç –¥–∞–Ω–Ω—ã–µ —É –∫–ª–∏–µ–Ω—Ç–∞ –≤—Ä—É—á–Ω—É—é (—Ç–µ–ª–µ—Ñ–æ–Ω / –§–ò–û) –∏ –≤—ã–ø–æ–ª–Ω—è–µ—Ç –ø—Ä–∏–≤—è–∑–∫—É.

---

### 10.6. –ü—Ä–∏–≤—è–∑–∫–∞ –≤—Ä—É—á–Ω—É—é –º–µ–Ω–µ–¥–∂–µ—Ä–æ–º

–í –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ CRM:

* –¥–ª—è –¥–∏–∞–ª–æ–≥–æ–≤ –±–µ–∑ `client_id` –¥–æ—Å—Ç—É–ø–Ω–∞ –æ–ø–µ—Ä–∞—Ü–∏—è ‚Äú–ü—Ä–∏–≤—è–∑–∞—Ç—å –∫ –∫–ª–∏–µ–Ω—Ç—É‚Äù;
* –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è —Ñ–æ—Ä–º–∞ –ø–æ–∏—Å–∫–∞:

  * –ø–æ —Ç–µ–ª–µ—Ñ–æ–Ω—É;
  * –ø–æ e-mail;
  * –ø–æ –§–ò–û;
  * –ø–æ –Ω–æ–º–µ—Ä—É –¥–æ–≥–æ–≤–æ—Ä–∞/–∞–±–æ–Ω–µ–º–µ–Ω—Ç–∞ (–ø—Ä–∏ –Ω–∞–ª–∏—á–∏–∏);
* –ø–æ—Å–ª–µ –≤—ã–±–æ—Ä–∞ –∫–ª–∏–µ–Ω—Ç–∞:

  * –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è –ø–æ–ª—è `conversation.client_id` –∏ `telegram_accounts.client_id`;
  * –≤—Å–µ –ø–æ—Å–ª–µ–¥—É—é—â–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –±—É–¥—É—Ç –æ—Ç–Ω–æ—Å–∏—Ç—å—Å—è –∫ —ç—Ç–æ–º—É –∫–ª–∏–µ–Ω—Ç—É.

–ú–µ–Ω–µ–¥–∂–µ—Ä —Ç–∞–∫–∂–µ –º–æ–∂–µ—Ç —Å–æ–∑–¥–∞—Ç—å –Ω–æ–≤–æ–≥–æ –∫–ª–∏–µ–Ω—Ç–∞ (‚Äú–°–æ–∑–¥–∞—Ç—å –∫–ª–∏–µ–Ω—Ç–∞ –∏–∑ –¥–∏–∞–ª–æ–≥–∞‚Äù) –∏ —Å—Ä–∞–∑—É –ø—Ä–∏–≤—è–∑–∞—Ç—å –¥–∏–∞–ª–æ–≥.

---

### 10.7. –ê–≤—Ç–æ–ø—Ä–∏–≤—è–∑–∫–∞ —á–µ—Ä–µ–∑ –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–π QR

–ï—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∑–∞–ø—É—Å–∫–∞–µ—Ç –±–æ—Ç–∞ —á–µ—Ä–µ–∑ —Å—Å—ã–ª–∫—É –≤–∏–¥–∞:

`https://t.me/<bot_username>?start=client_<id>`,

—Ç–æ:

* –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–∏–≤—è–∑–∫–∞ –∫ `client_id`;
* –ø—Ä–æ—Ü–µ–¥—É—Ä–∞ –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ (–∑–∞–ø—Ä–æ—Å —Ç–µ–ª–µ—Ñ–æ–Ω–∞) **–Ω–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è**;
* –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –º–æ–∂–Ω–æ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ –∑–∞–ø—Ä–æ—Å–∏—Ç—å —É –∫–ª–∏–µ–Ω—Ç–∞ —Ç–µ–ª–µ—Ñ–æ–Ω –¥–ª—è —Å–≤–µ—Ä–∫–∏, –Ω–æ —ç—Ç–æ –Ω–µ —è–≤–ª—è–µ—Ç—Å—è —á–∞—Å—Ç—å—é –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–π –ª–æ–≥–∏–∫–∏.

---

### 10.8. –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ UX –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏

* –ó–∞–ø—Ä–æ—Å —Ç–µ–ª–µ—Ñ–æ–Ω–∞ –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∞–Ω –º—è–≥–∫–æ –∏ –Ω–µ –≤—ã–∑—ã–≤–∞—Ç—å –æ—â—É—â–µ–Ω–∏—è ‚Äú–∂—ë—Å—Ç–∫–æ–π –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏‚Äù.
* –ö–ª–∏–µ–Ω—Ç—É —è–≤–Ω–æ —Å–æ–æ–±—â–∞–µ—Ç—Å—è, —á—Ç–æ –æ–Ω –º–æ–∂–µ—Ç –ø—Ä–æ–¥–æ–ª–∂–∏—Ç—å –æ–±—â–µ–Ω–∏–µ –±–µ–∑ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω–∏—è —Ç–µ–ª–µ—Ñ–æ–Ω–∞.
* –ö–ª–∞–≤–∏–∞—Ç—É—Ä–∞ —Å –∫–Ω–æ–ø–∫–∞–º–∏ (‚Äú–ü–æ–¥–µ–ª–∏—Ç—å—Å—è –Ω–æ–º–µ—Ä–æ–º —Ç–µ–ª–µ—Ñ–æ–Ω–∞‚Äù / ‚Äú–ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å –±–µ–∑ –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏‚Äù) –¥–æ–ª–∂–Ω–∞ —Å–∫—Ä—ã–≤–∞—Ç—å—Å—è –ø–æ—Å–ª–µ –≤—ã–±–æ—Ä–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º –æ–¥–Ω–æ–π –∏–∑ –æ–ø—Ü–∏–π.
* –ü—Ä–∏ –ø–æ—Å–ª–µ–¥—É—é—â–∏—Ö —Å–æ–æ–±—â–µ–Ω–∏—è—Ö –±–æ—Ç –Ω–µ –¥–æ–ª–∂–µ–Ω –∑–∞—Ü–∏–∫–ª–∏–≤–∞—Ç—å—Å—è –Ω–∞ –∑–∞–ø—Ä–æ—Å–µ —Ç–µ–ª–µ—Ñ–æ–Ω–∞; –ø–æ–≤—Ç–æ—Ä–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã –º–æ–≥—É—Ç –¥–µ–ª–∞—Ç—å—Å—è —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –∏ –≤ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–æ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ.

---

### 10.9. –°–æ—Å—Ç–æ—è–Ω–∏—è FSM (Finite State Machine)

–î–ª—è —É–¥–æ–±—Å—Ç–≤–∞ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –ª–æ–≥–∏–∫–∏ –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è —Ö—Ä–∞–Ω–∏—Ç—å —Å–æ—Å—Ç–æ—è–Ω–∏–µ –≤ `telegram_accounts.state`. –í–æ–∑–º–æ–∂–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è:

* `NEW_USER` ‚Äî –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–ø–µ—Ä–≤—ã–µ –Ω–∞–ø–∏—Å–∞–ª, –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –µ—â—ë –Ω–µ –ø—Ä–µ–¥–ª–∞–≥–∞–ª–∞—Å—å.
* `WAITING_FOR_PHONE` ‚Äî –±–æ—Ç –∑–∞–ø—Ä–æ—Å–∏–ª —Ç–µ–ª–µ—Ñ–æ–Ω, –æ–∂–∏–¥–∞–µ—Ç—Å—è –∫–æ–Ω—Ç–∞–∫—Ç –∏–ª–∏ –æ—Ç–≤–µ—Ç.
* `IDENTIFIED` ‚Äî –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø—Ä–∏–≤—è–∑–∞–Ω –∫ –∫–ª–∏–µ–Ω—Ç—É (`client_id` –∑–∞–ø–æ–ª–Ω–µ–Ω).
* `GUEST` ‚Äî –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ—Ç–∫–∞–∑–∞–ª—Å—è –æ—Ç –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏, –æ–±—â–µ–Ω–∏–µ –≤–æ–∑–º–æ–∂–Ω–æ, –Ω–æ –±–µ–∑ —Å–≤—è–∑–∫–∏ —Å –∫–ª–∏–µ–Ω—Ç—Å–∫–æ–π –∫–∞—Ä—Ç–æ—á–∫–æ–π.
* `BOUND_MANUALLY` ‚Äî –ø—Ä–∏–≤—è–∑–∫–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∞ –º–µ–Ω–µ–¥–∂–µ—Ä–æ–º —á–µ—Ä–µ–∑ CRM.

–ü–µ—Ä–µ—Ö–æ–¥—ã –º–µ–∂–¥—É —Å–æ—Å—Ç–æ—è–Ω–∏—è–º–∏ –æ–ø–∏—Å—ã–≤–∞—é—Ç—Å—è –≤ –ª–æ–≥–∏–∫–µ webhook-—Å–µ—Ä–≤–∏—Å–∞.

---

## 11. –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –∏ —Ä–∞—Å—à–∏—Ä—è–µ–º–æ—Å—Ç—å

* –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –¥–æ–ª–∂–Ω–∞ –ø–æ–∑–≤–æ–ª—è—Ç—å –≤ –±—É–¥—É—â–µ–º –ø–æ–¥–∫–ª—é—á–∏—Ç—å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –∫–∞–Ω–∞–ª—ã (WhatsApp, web-—á–∞—Ç –∏ —Ç.–ø.) –Ω–∞ —Ç–æ–π –∂–µ –º–æ–¥–µ–ª–∏ `conversations/messages`.
* –í —Ä–∞–º–∫–∞—Ö –¥–∞–Ω–Ω–æ–≥–æ –¢–ó —Ä–µ–∞–ª–∏–∑—É–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –∫–∞–Ω–∞–ª Telegram.
* UI –∏ backend –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å —Å–ø—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω—ã —Ç–∞–∫, —á—Ç–æ–±—ã –ø–æ—è–≤–ª–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤ (channel = `web`, `whatsapp`) –Ω–µ –ª–æ–º–∞–ª–æ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π –∫–æ–¥.

---

## 12. –≠—Ç–∞–ø—ã —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏

### –≠—Ç–∞–ø 1 ‚Äî –ë–∞–∑–æ–≤–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è

* –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è/–Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –±–æ—Ç–∞, —Å–±—Ä–æ—Å —Ç–æ–∫–µ–Ω–∞ –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏.
* –ù–∞—Å—Ç—Ä–æ–π–∫–∞ webhook –Ω–∞ CRM.
* –†–µ–∞–ª–∏–∑–∞—Ü–∏—è —Ç–∞–±–ª–∏—Ü `telegram_accounts`, `conversations`, `messages`, `logs_manager_actions`.
* –ü—Ä–∏—ë–º –∏ –æ—Ç–ø—Ä–∞–≤–∫–∞ —Ç–µ–∫—Å—Ç–æ–≤—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π.
* –ê–≤—Ç–æ–ø—Ä–∏–≤—è–∑–∫–∞ –ø–æ `/start client_<id>`.
* –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å –º–µ–Ω–µ–¥–∂–µ—Ä–∞ (—Å–ø–∏—Å–æ–∫ –¥–∏–∞–ª–æ–≥–æ–≤ + –æ–∫–Ω–æ –¥–∏–∞–ª–æ–≥–∞, –º–∏–Ω–∏–º—É–º).
* –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏—Å—Ç–æ—Ä–∏–∏ —Å–æ–æ–±—â–µ–Ω–∏–π.

### –≠—Ç–∞–ø 2 ‚Äî –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è

* –†–µ–∞–ª–∏–∑–∞—Ü–∏—è `notification_templates` –∏ notification-—Å–µ—Ä–≤–∏—Å–∞.
* –û—Ç–ø—Ä–∞–≤–∫–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –≤ Telegram –∏ email –ø–æ —Å–æ–±—ã—Ç–∏—è–º (–æ–ø–ª–∞—Ç–∞, –∑–∞–Ω—è—Ç–∏—è, —É—Å–ª—É–≥–∏, –¥–æ–ª–≥–∏).
* –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤–∫–ª—é—á–µ–Ω–∏–µ–º/–æ—Ç–∫–ª—é—á–µ–Ω–∏–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π —Å–æ —Å—Ç–æ—Ä–æ–Ω—ã –∫–ª–∏–µ–Ω—Ç–∞ –∏ –º–µ–Ω–µ–¥–∂–µ—Ä–∞.

### –≠—Ç–∞–ø 3 ‚Äî –†–∞—Å—à–∏—Ä–µ–Ω–∏—è

* –õ–æ–≥–∏–∫–∞ –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –ø–æ —Ç–µ–ª–µ—Ñ–æ–Ω—É —á–µ—Ä–µ–∑ –∫–Ω–æ–ø–∫—É ‚Äú–ü–æ–¥–µ–ª–∏—Ç—å—Å—è –Ω–æ–º–µ—Ä–æ–º —Ç–µ–ª–µ—Ñ–æ–Ω–∞‚Äù + —Ä—É—á–Ω–∞—è –ø—Ä–∏–≤—è–∑–∫–∞.
* –°–æ–∑–¥–∞–Ω–∏–µ –∫–∞—Ä—Ç–æ—á–∫–∏ –∫–ª–∏–µ–Ω—Ç–∞ –∏–∑ –¥–∏–∞–ª–æ–≥–∞.
* –ë—ã—Å—Ç—Ä—ã–µ —à–∞–±–ª–æ–Ω—ã –æ—Ç–≤–µ—Ç–æ–≤ –¥–ª—è –º–µ–Ω–µ–¥–∂–µ—Ä–æ–≤.
* –£–ª—É—á—à–µ–Ω–∏—è UI –∏ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö —Ñ–∏–ª—å—Ç—Ä–æ–≤ / –ø–æ–∏—Å–∫–∞ –ø–æ –¥–∏–∞–ª–æ–≥–∞–º.

---

–ï—Å–ª–∏ –∑–∞—Ö–æ—á–µ—à—å, –º–æ–≥—É —Å–ª–µ–¥—É—é—â–∏–º —à–∞–≥–æ–º –Ω–∞–∫–∏–¥–∞—Ç—å:

* –ø—Ä–∏–º–µ—Ä —Å—Ç—Ä—É–∫—Ç—É—Ä—ã —Ñ–∞–π–ª–æ–≤ backend (Flask / FastAPI) –ø–æ–¥ —ç—Ç–æ—Ç –º–æ–¥—É–ª—å,
* –∏–ª–∏ –Ω–∞–±—Ä–æ—Å–æ–∫ —Å—Ö–µ–º—ã ERD/–¥–∏–∞–≥—Ä–∞–º–º—É —Å–æ—Å—Ç–æ—è–Ω–∏–π –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤.
