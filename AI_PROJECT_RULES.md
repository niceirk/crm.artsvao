# Правила работы ассистента с проектом Artsvao

## Назначение
- Этот документ — личный регламент для ИИ-разработчика. Всегда соблюдать его при любом изменении кода.
- Главный источник стандартов: `CODING_STANDARDS.md`. Если есть расхождение, приоритет у него.

## Приоритет источников
1) `CODING_STANDARDS.md`  
2) Текущий код (ориентиры: backend `src/clients/*`, `src/shared/conflict-checker.service.ts`; frontend `app/(dashboard)/clients`)  
3) Официальная документация NestJS/Next.js/Prisma  
4) Уточнение у пользователя, если требование неоднозначно.

## Общие принципы
- SOLID, DRY, KISS; строго DI в NestJS; модульность по шаблонам из claude.md.
- TypeScript везде, явная типизация props/DTO/ответов.
- Самодокументируемый код, комментарии только для сложной логики.
- Производительность: `Promise.all` для параллельных запросов, `select/include` с ограничениями, пагинация по умолчанию.

## Backend (NestJS)
- Структура модуля: `module`, `controller`, `service`, `dto/*`. Импортировать в `app.module.ts` только через модули.
- Всегда использовать DTO с валидацией, Nest exceptions для ошибок.
- Soft delete вместо удаления, все изменения логировать через `AuditLogService`.
- Конфликты времени проверять через `ConflictCheckerService`.
- Глобальный `JwtAuthGuard`; для публичных эндпоинтов ставить `@Public`.

## Frontend (Next.js)
- Компоненты на базе shadcn/ui и Tailwind; маршруты в `app/(dashboard)/...`.
- Данные тянуть через React Query hooks; глобальное состояние — Zustand; дорогие вычисления мемоизировать, поиск дебаунсить.
- Именование: файлы `kebab-case`, компоненты `PascalCase`, хуки `use*`.

## База и Prisma
- Миграции через `npx prisma migrate dev --name <описание>`; формат имени `YYYYMMDDHHMMSS_описание`, добавлять индексы под фильтры/сортировки.
- Использовать Prisma типы для запросов; не дублировать логику БД — выносить в сервисы.

## Git и коммиты
- Стиль коммитов: Conventional Commits (пример: `feat(clients): add search`), короткие и по одной задаче.
- Перед PR: описать изменения, миграции/env, приложить скриншоты для UI, указать выполненные команды тестов.

## Чек-лист перед сдачей
- [ ] Код соответствует `CODING_STANDARDS.md` и этому регламенту
- [ ] DTO/валидация и корректный error handling на backend
- [ ] Запросы к БД оптимизированы (параллель, select/include, пагинация)
- [ ] Frontend использует React Query + shadcn/ui, нет лишнего состояния
- [ ] Нет дублирования и `console.log`
- [ ] Коммит/PR оформлен по правилам
